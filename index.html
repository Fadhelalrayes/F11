<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>صفحة الطقس — فاتحة مذهّبة</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fffdf7;         /* خلفية فاتحة دافئة */
      --paper:#ffffff;      /* بطاقات بيضاء */
      --ink:#1f2937;        /* نص داكن مريح */
      --muted:#6b7280;      /* نص ثانوي */
      --gold:#D4AF37;       /* ذهبي فاخر */
      --ring:#e5e7eb;       /* حدود فاتحة */
      --glow:0 10px 35px rgba(212,175,55,.18)
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:linear-gradient(180deg,#fffdf7,#fbf4e6 35%,#fffdf7);color:var(--ink);font-family:'Cairo',system-ui,Arial,sans-serif}
    a{color:inherit;text-decoration:none}/* رأس بسيط */
.nav{position:sticky;top:0;z-index:20;background:rgba(255,255,255,.75);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid #ececec}
.nav-wrap{max-width:980px;margin:auto;display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
.brand{display:flex;align-items:center;gap:10px}
.logo{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,var(--gold),#a88407);box-shadow:var(--glow)}
.brand h1{margin:0;font-size:18px}
.brand small{display:block;color:var(--muted);font-weight:400;font-size:12px;margin-top:-2px}

/* بطل */
.hero{max-width:980px;margin:28px auto 0;padding:0 18px}
.hero h2{margin:0 0 8px;font-size:28px}
.hero p{margin:0 0 12px;color:var(--muted)}

/* لوحة الطقس */
.panel{max-width:980px;margin:14px auto 28px;padding:16px;border:1px solid var(--ring);background:var(--paper);border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.04)}
.controls{display:flex;gap:10px;flex-wrap:wrap}
.input{flex:1;min-width:220px;padding:12px;border:1px solid var(--ring);border-radius:12px;background:#fff;color:var(--ink)}
.btn{padding:12px 16px;border-radius:12px;border:1px solid var(--ring);background:#fff;cursor:pointer}
.btn-primary{background:linear-gradient(135deg,var(--gold),#caa326);color:#0b0b0f;border:none;box-shadow:var(--glow)}

/* الحالي */
.current{display:flex;gap:16px;align-items:center;justify-content:space-between;flex-wrap:wrap;margin-top:14px}
.stat{background:#fff;border:1px solid var(--ring);border-radius:14px;padding:12px 14px;min-width:150px;text-align:center}
.stat .k{font-size:13px;color:var(--muted)}
.stat .v{font-size:22px;font-weight:800}

/* توقع 7 أيام */
.forecast{display:grid;grid-template-columns:repeat(7,1fr);gap:10px;margin-top:16px}
.day{background:#fff;border:1px solid var(--ring);border-radius:14px;padding:10px;text-align:center}
.day strong{display:block;margin-bottom:6px}
.muted{color:var(--muted)}

/* توست */
.toast{position:fixed;inset-inline-start:18px;bottom:18px;display:none;min-width:260px;background:#fff;border:1px solid var(--ring);padding:12px 14px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
.toast.show{display:block;animation:slide .25s ease}
@keyframes slide{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}

@media (max-width:720px){.forecast{grid-template-columns:repeat(3,1fr)}}
@media (max-width:420px){.forecast{grid-template-columns:repeat(2,1fr)}}

  </style>
</head>
<body>
  <div class="nav">
    <div class="nav-wrap">
      <a class="brand" href="#">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>صفحة الطقس</h1>
          <small>فاتحة مذهّبة — مجانية بالكامل</small>
        </div>
      </a>
    </div>
  </div>  <header class="hero">
    <h2>اعرض حالة الطقس بسرعة وبساطة</h2>
    <p>اكتب اسم المدينة أو استخدم موقعك الحالي. لا اشتراكات ولا باقات — فقط الطقس.</p>
  </header>  <section class="panel">
    <div class="controls">
      <input id="city" class="input" placeholder="اكتب اسم المدينة (مثال: المنامة)" />
      <button id="searchBtn" class="btn btn-primary">بحث</button>
      <button id="locBtn" class="btn">الموقع الحالي</button>
    </div>
    <div id="status" class="muted" style="margin-top:8px">جاهز للبحث…</div><div id="current" class="current" style="display:none">
  <div class="stat">
    <div class="k">الموقع</div>
    <div class="v" id="place">—</div>
    <div class="muted" id="coords" style="font-size:12px">—</div>
  </div>
  <div class="stat">
    <div class="k">الآن</div>
    <div class="v" id="temp">—°</div>
    <div class="muted" id="winds" style="font-size:12px">—</div>
  </div>
  <div class="stat">
    <div class="k">الهطول اليوم</div>
    <div class="v" id="precip">—%</div>
    <div class="muted" style="font-size:12px">فرصة الأمطار</div>
  </div>
</div>

<div id="forecast" class="forecast"></div>

  </section>  <div class="toast" id="toast">تم التحديث بنجاح.</div>  <script>
    const toast = document.getElementById('toast');
    function notify(msg){ toast.textContent = msg; toast.classList.add('show'); clearTimeout(window.__t); window.__t=setTimeout(()=>toast.classList.remove('show'),3000) }

    const statusEl = document.getElementById('status');
    const forecastEl = document.getElementById('forecast');
    const currentEl  = document.getElementById('current');
    const placeEl    = document.getElementById('place');
    const coordsEl   = document.getElementById('coords');
    const tempEl     = document.getElementById('temp');
    const windsEl    = document.getElementById('winds');
    const precipEl   = document.getElementById('precip');

    function fmt(n,fd=0){return new Intl.NumberFormat('ar-EG',{maximumFractionDigits:fd}).format(n)}
    function dayName(d){return new Intl.DateTimeFormat('ar',{weekday:'short',month:'short',day:'numeric'}).format(new Date(d))}

    async function fetchJSON(url, tries=3){
      for(let i=0;i<tries;i++){
        try{ const r = await fetch(url,{headers:{'Accept':'application/json'}}); if(!r.ok) throw new Error('HTTP '+r.status); return await r.json(); }
        catch(e){ if(i===tries-1) throw e; await new Promise(res=>setTimeout(res, 700*(i+1))); }
      }
    }

    async function geocodeCity(name){
      statusEl.textContent='جارٍ البحث عن المدينة…';
      const u = `https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(name)}&count=1&language=ar&format=json`;
      const j = await fetchJSON(u);
      if(!j || !j.results || !j.results.length) throw new Error('لم يتم العثور على نتائج');
      const r = j.results[0];
      return {lat:r.latitude, lon:r.longitude, label:`${r.name}${r.admin1?'، '+r.admin1:''} — ${r.country}`};
    }

    async function loadWeather(lat,lon,label){
      statusEl.textContent='يتم جلب حالة الطقس الآن…';
      forecastEl.innerHTML='';
      // الحالي + 7 أيام
      const u = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max,wind_speed_10m_max&timezone=auto`;
      const j = await fetchJSON(u);

      // الحالي
      currentEl.style.display='flex';
      placeEl.textContent = label || 'موقع مخصّص';
      coordsEl.textContent = `الإحداثيات: ${fmt(lat,2)}, ${fmt(lon,2)}`;
      if(j.current_weather){
        tempEl.textContent = fmt(j.current_weather.temperature)+'°';
        windsEl.textContent = `الرياح: ${fmt(j.current_weather.windspeed)} كم/س`;
      }
      if(j.daily && j.daily.precipitation_probability_max){
        precipEl.textContent = (j.daily.precipitation_probability_max[0] ?? '—') + '%';
      }

      // الأيام
      const d = j.daily; 
      for(let i=0;i<d.time.length;i++){
        const el = document.createElement('div'); el.className='day';
        el.innerHTML = `<strong>${dayName(d.time[i])}</strong>
          <div style="font-weight:800;font-size:18px">${fmt(d.temperature_2m_max[i])}° / ${fmt(d.temperature_2m_min[i])}°</div>
          <div class="muted">أمطار: ${d.precipitation_probability_max[i]??'—'}% • رياح: ${fmt(d.wind_speed_10m_max[i]||0)} كم/س</div>`;
        forecastEl.appendChild(el);
      }
      statusEl.textContent='تم التحديث.';
      notify('تم تحديث بيانات التنبؤ');
    }

    document.getElementById('searchBtn').addEventListener('click', async ()=>{
      const name = document.getElementById('city').value.trim();
      if(!name){ statusEl.textContent='اكتب اسم المدينة أولًا.'; return }
      try{ const {lat,lon,label} = await geocodeCity(name); await loadWeather(lat,lon,label); }
      catch(e){ statusEl.textContent='تعذّر العثور على المدينة أو جلب الطقس.'; }
    });

    document.getElementById('locBtn').addEventListener('click', ()=>{
      if(!navigator.geolocation){ statusEl.textContent='المتصفح لا يدعم الموقع.'; return }
      statusEl.textContent='جارٍ تحديد موقعك…';
      navigator.geolocation.getCurrentPosition(async (pos)=>{
        const {latitude:lat, longitude:lon} = pos.coords;
        try{ await loadWeather(lat,lon,'موقعك الحالي'); }catch(e){ statusEl.textContent='فشل الجلب من الخدمة.' }
      },()=>{ statusEl.textContent='رُفض الوصول للموقع. استخدم البحث بالمدينة.' },{enableHighAccuracy:true,timeout:10000,maximumAge:0});
    });

    // محاولة تلقائية خفيفة عند الفتح
    setTimeout(()=>{
      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(async (pos)=>{
          try{ await loadWeather(pos.coords.latitude,pos.coords.longitude,'موقعك الحالي'); }catch(e){}
        },()=>{});
      }
    },800);
  </script></body>
</html>
