<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>خط التماس الأخباري</title>

<!-- خط واحد للموقع كله (Cairo) -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700;800&display=swap" rel="stylesheet" />

<style>
  :root{
    --bg:#f6f8fb; --card:#ffffff; --ink:#0a1020; --muted:#5a6b7d;
    --ring:#e5eef6; --shadow:0 10px 25px rgba(19,52,89,.08);
    --green1:#11c295; --green2:#0aa27a; --green3:#0a865f;
    --barH:4px; /* سماكة الخط العلوي والسفلي (موحّدة) */
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font:16px/1.75 "Cairo",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  }

  /* هيدر أخضر تدرّجي + خط سفلي تدرّجي */
  header{
    position:sticky; top:0; z-index:20; color:#fff;
    background:linear-gradient(180deg, var(--green1), var(--green2) 70%, var(--green3) 100%);
    border-bottom:0;
  }
  header::after{
    content:""; display:block; height:var(--barH);
    background:linear-gradient(90deg, var(--green1), #86f0d3, var(--green1));
  }

  .container{max-width:1200px; margin:auto; padding:16px 18px}
  /* رأس منظم: الشعار في الوسط */
  .header-center{
    display:flex; flex-direction:column; align-items:center; gap:6px; text-align:center;
  }
  .logo{
    width:56px; height:56px; border-radius:16px; display:grid; place-items:center; color:#fff;
    background:radial-gradient(circle at 30% 30%, #9ff5df, #37d7ae 55%, #0ca878 100%);
    box-shadow:0 10px 24px rgba(0,0,0,.15), inset 0 0 24px rgba(255,255,255,.12);
  }
  .logo svg{width:30px; height:30px}
  h1{
    margin:0; font-size:2.1rem; font-weight:800; letter-spacing:.3px;
    white-space:nowrap; /* سطر واحد */
  }
  .tagline{opacity:.95; font-size:1rem; margin:0}

  /* شبكة البطاقات */
  .grid{display:grid; gap:16px; margin-top:16px; grid-template-columns:repeat(auto-fill,minmax(280px,1fr))}
  article.card{
    background:var(--card); border:1px solid var(--ring); border-radius:18px; padding:16px;
    box-shadow:var(--shadow); display:flex; flex-direction:column; gap:10px; position:relative; overflow:hidden
  }
  .badge{display:inline-flex; gap:8px; align-items:center; font-size:.8rem; color:var(--green2);
    background:#e8fbf5; border:1px solid #b9f0df; padding:6px 10px; border-radius:999px; width:max-content}
  .title{font-size:1.12rem; font-weight:800; margin:4px 0 0}
  .excerpt{color:#2c3e50; font-size:.98rem}
  .meta{display:flex; gap:10px; color:#5f7286; font-size:.85rem}
  .card-top{display:flex; align-items:flex-start; gap:8px}
  .more{
    margin-inline-start:auto; width:38px; height:38px; border-radius:12px;
    border:1px solid var(--ring); background:#fff; display:grid; place-items:center; cursor:pointer; transition:.2s
  }
  .more:hover{transform:translateY(-1px); box-shadow:0 6px 16px rgba(12,57,95,.12)}
  .more svg{width:18px; height:18px; color:#0b2e3f}
  details{border-top:1px dashed var(--ring); padding-top:10px}
  details[open] summary{opacity:.6}
  summary{list-style:none; cursor:pointer; display:flex; align-items:center; gap:8px}
  summary::-webkit-details-marker{display:none}
  .empty,.error{text-align:center; color:#5b6b7c; padding:50px 20px; border:1px dashed var(--ring); border-radius:18px; background:#fff}

  /* شريط مشاركة جديد بأسفل الصفحة */
  .sharebar-wrap{border-top:1px solid var(--ring); margin-top:26px; padding:16px 0}
  .sharebar{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:center}
  .sharebtn{
    width:40px; height:40px; border-radius:12px;
    background:#fff; border:1px solid var(--ring); display:grid; place-items:center; cursor:pointer; transition:.2s
  }
  .sharebtn:hover{transform:translateY(-1px); box-shadow:0 6px 16px rgba(12,57,95,.12)}
  .sharebtn svg{width:20px; height:20px}

  footer.site-footer{max-width:1200px; margin:12px auto 24px; padding:0 18px; text-align:center}
  a.credit{
    display:inline-flex; align-items:center; gap:8px; text-decoration:none;
    border:1px solid var(--ring); background:#fff; color:#0a1020;
    padding:10px 14px; border-radius:14px; font-weight:800; box-shadow:0 6px 16px rgba(12,57,95,.12); transition:.2s
  }
  a.credit:hover{transform:translateY(-1px)}

  /* خط أخضر تدرّجي أسفل الموقع (بنفس سماكة العلوي) */
  .site-bottom-bar{height:var(--barH); background:linear-gradient(90deg, var(--green1), #86f0d3, var(--green1));}
  .copy-toast{
    position:fixed; bottom:18px; inset-inline:0; margin:auto; width:max-content;
    background:linear-gradient(90deg,var(--green1),var(--green2)); color:white; padding:10px 14px;
    border-radius:12px; box-shadow:0 8px 30px rgba(10,162,122,.25); font-weight:800; display:none
  }
</style>
</head>
<body>
  <header>
    <div class="container">
      <div class="header-center">
        <div class="logo" aria-hidden="true" title="شعار خط التماس">
          <!-- لوجو مبسّط: كرة مع نبضة -->
          <svg viewBox="0 0 24 24" fill="none" role="img" aria-label="شعار">
            <circle cx="12" cy="12" r="9" stroke="white" stroke-opacity=".9" />
            <path d="M4 12h3l2-3 2 6 2-4 2 3h3" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h1>خط التماس الأخباري</h1>
        <p class="tagline">أخبار رياضية عربية</p>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="news" class="grid" aria-live="polite" aria-busy="true"></section>
    <div id="status" class="empty" hidden>يتم جلب الأخبار…</div>

    <!-- شريط مشاركة (أيقونات جديدة بسيطة) -->
    <div class="sharebar-wrap">
      <div class="sharebar" aria-label="مشاركة الصفحة">
        <!-- واتساب (فقاعة حديث) -->
        <button class="sharebtn" data-share="whatsapp" title="واتساب" aria-label="مشاركة واتساب">
          <svg viewBox="0 0 24 24" fill="none"><path d="M4 20 5.6 16.2A8 8 0 1 1 12 20a8.3 8.3 0 0 1-4.2-1L4 20Z" stroke="#2BC85B" stroke-width="1.5"/><path d="M8.8 9.8c.2 2.6 2.7 5.1 5.3 5.3.4 0 .7-.1.9-.3l.6-.6a.8.8 0 0 0 0-1.1l-1.1-1.1a.8.8 0 0 0-1.1 0l-.3.3c-.2.2-.5.2-.8.1-1-.4-1.9-1.2-2.3-2.3-.1-.3-.1-.6.1-.8l.3-.3c.3-.3.3-.8 0-1.1L10 6.9a.8.8 0 0 0-1.1 0l-.6.6c-.3.2-.5.5-.5.9Z" fill="#2BC85B"/></svg>
        </button>
        <!-- تيليجرام (ورقة طائرة مبسطة) -->
        <button class="sharebtn" data-share="telegram" title="تيليجرام" aria-label="مشاركة تيليجرام">
          <svg viewBox="0 0 24 24" fill="none"><path d="M20.6 4.3 9 10.1l3 2.1 6.8-6M12 12.2l1.2 7.1 2.2-3.7" stroke="#229ED9" stroke-width="1.5" stroke-linejoin="round"/></svg>
        </button>
        <!-- فيسبوك (حرف f داخل مربع ناعم) -->
        <button class="sharebtn" data-share="facebook" title="فيسبوك" aria-label="مشاركة فيسبوك">
          <svg viewBox="0 0 24 24" fill="none"><rect x="3.5" y="3.5" width="17" height="17" rx="3.2" stroke="#1877F2" stroke-width="1.5"/><path d="M13 10h2v-2h-2c-1.1 0-2 .9-2 2v2H9v2h2v4h2v-4h2l.5-2H13v-2Z" fill="#1877F2"/></svg>
        </button>
        <!-- X (متقاطع نظيف) -->
        <button class="sharebtn" data-share="x" title="X" aria-label="مشاركة X">
          <svg viewBox="0 0 24 24" fill="none"><path d="M5 5l14 14M19 5 5 19" stroke="#111" stroke-width="1.8" stroke-linecap="round"/></svg>
        </button>
        <!-- لينكدإن (IN داخل مربع) -->
        <button class="sharebtn" data-share="linkedin" title="لينكدإن" aria-label="مشاركة لينكدإن">
          <svg viewBox="0 0 24 24" fill="none"><rect x="3.5" y="3.5" width="17" height="17" rx="3.2" stroke="#0A66C2" stroke-width="1.5"/><circle cx="8" cy="9" r="1" fill="#0A66C2"/><path d="M7.5 17.5v-5.5M12 17.5v-2.8c0-1.2 1-2.2 2.2-2.2s2.3 1 2.3 2.2v2.8" stroke="#0A66C2" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
        <!-- نسخ -->
        <button class="sharebtn" data-share="copy" title="نسخ الرابط" aria-label="نسخ الرابط">
          <svg viewBox="0 0 24 24" fill="none"><rect x="9" y="9" width="9" height="11" rx="2" stroke="#333"/><rect x="6" y="4" width="9" height="11" rx="2" stroke="#333"/></svg>
        </button>
      </div>
    </div>
  </main>

  <!-- «برمجة وتطوير: فاضل الريس» (يفتح واتساب) -->
  <footer class="site-footer">
    <a class="credit" href="https://api.whatsapp.com/send/?phone=97333375858&text&type=phone_number&app_absent=0&wame_ctl=1&fbclid=PAVERDUAMmpVFleHRuA2FlbQIxMAABpyJPbGGA99AFnmjozjUr8s9ejerL-tlDxOqcQ4PlUxZoQi3rSh4orLwyOCk1_aem_Qwij4KmGwbbQgFaNdtN4ZA"
       target="_blank" rel="noopener" aria-label="التواصل عبر واتساب">
      برمجة وتطوير: <strong>فاضل الريس</strong>
    </a>
  </footer>

  <!-- خط أخضر تدرّجي أسفل الموقع (بنفس سماكة العلوي) -->
  <div class="site-bottom-bar" aria-hidden="true"></div>

  <div class="copy-toast" id="copyToast">تم نسخ الرابط 👌</div>

<script>
(() => {
  // تحديث خلفي هادئ
  const REFRESH_MS = 30_000;
  const FEED_TIMEOUT_MS = 6000;
  const LIMIT = 48;
  const FEEDS = [
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.alarabiya.net/.mrss/ar/sports.xml'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://aawsat.com/rss/section/sport'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://arabic.rt.com/rss/sport/'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.skynewsarabia.com/rss/sports'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.aljazeera.net/aljazeera/rss'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.almasryalyoum.com/rss'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.youm7.com/rss/rss'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.bbc.com/arabic/index.xml'),
    'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://www.france24.com/ar/rss')
  ];

  const $grid = document.getElementById('news');
  const $status = document.getElementById('status');

  function strip(html){
    const tmp = document.createElement('div');
    tmp.innerHTML = (html || '').replace(/<script[^>]*>[\s\S]*?<\/script>/gi,'');
    return (tmp.textContent || tmp.innerText || '').replace(/\s+/g,' ').trim();
  }
  function includesSportArabic(text){
    const t = (text||'').toLowerCase();
    return /رياضة|كرة|قدم|دوري|مباراة|هداف|منتخب|كأس|بطولة|نادي|مدرب|لاعب|تصفيات|الملعب|الشوط|فريق|جولة|موسم|كلاسيكو|ركلة/.test(t);
  }
  function escapeHTML(s){return (s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');}
  function card({title, excerpt, date}){
    const id = btoa(unescape(encodeURIComponent(title))).slice(0,24);
    return `
      <article class="card" data-id="${id}">
        <div class="card-top">
          <span class="badge" aria-label="تصنيف الخبر">⚽ رياضة</span>
          <button class="more" title="مزيد" aria-label="مزيد (فتح المقتطف)">
            <svg viewBox="0 0 24 24" role="img" aria-label="مزيد">
              <path d="M12 2a10 10 0 1 0 .001 20.001A10 10 0 0 0 12 2Zm-4 9a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm4 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"/>
            </svg>
          </button>
        </div>
        <h2 class="title">${escapeHTML(title)}</h2>
        <div class="meta">🕒 <span>${new Date(date).toLocaleTimeString('ar',{hour:'2-digit',minute:'2-digit'})}</span></div>
        <details><summary>عرض المقتطف</summary><p class="excerpt">${escapeHTML(excerpt || '—')}</p></details>
      </article>
    `;
  }

  async function fetchWithTimeout(url, timeoutMs){
    const ctrl = new AbortController();
    const t = setTimeout(()=>ctrl.abort('timeout'), timeoutMs);
    try{
      const r = await fetch(url, {cache:'no-store', signal:ctrl.signal});
      if(!r.ok) throw new Error('HTTP '+r.status);
      return await r.text();
    } finally{ clearTimeout(t); }
  }

  function parseFeed(xmlText){
    const out = [];
    try{
      const xml = new DOMParser().parseFromString(xmlText, 'text/xml');
      const items = Array.from(xml.querySelectorAll('item, entry'));
      for(const n of items){
        const title = (n.querySelector('title')?.textContent || '').trim();
        if(!title) continue;
        const desc = n.querySelector('description, summary, content')?.textContent || '';
        const cat  = (n.querySelector('category')?.textContent || '') + ' ' + (n.querySelector('section')?.textContent || '');
        const pub  = n.querySelector('pubDate, updated, published')?.textContent || new Date().toISOString();
        const date = new Date(pub);
        const text = [title, desc, cat].join(' ');
        if(!includesSportArabic(text)) continue;
        out.push({ title, excerpt: strip(desc).slice(0,260), date: isNaN(date) ? new Date() : date });
      }
    }catch{}
    return out;
  }

  async function load(){
    $grid.setAttribute('aria-busy','true');
    $status.hidden = false; $status.className='empty'; $status.textContent = 'يتم جلب الأخبار…';
    try{
      const CONCURRENCY = 4;
      let items = [];
      for(let i=0;i<FEEDS.length;i+=CONCURRENCY){
        const batch = FEEDS.slice(i,i+CONCURRENCY);
        const texts = await Promise.allSettled(batch.map(u => fetchWithTimeout(u, FEED_TIMEOUT_MS)));
        items = items.concat(texts.filter(x=>x.status==='fulfilled').flatMap(x=>parseFeed(x.value)));
      }
      // إزالة التكرار والفرز
      const seen = new Set(), unique = [];
      for(const it of items){
        const k = it.title.trim().toLowerCase();
        if(seen.has(k)) continue; seen.add(k); unique.push(it);
      }
      unique.sort((a,b)=> b.date - a.date);
      const limited = unique.slice(0, LIMIT);

      if(!limited.length){ $grid.innerHTML=''; $status.hidden=false; $status.textContent='لا توجد عناصر مناسبة الآن.'; }
      else { $status.hidden=true; $grid.innerHTML = limited.map(card).join(''); }
    }catch(e){
      console.error(e);
      $grid.innerHTML=''; $status.hidden=false; $status.className='error'; $status.textContent='تعذّر الجلب الآن. سنحاول مجددًا.';
    }finally{
      $grid.removeAttribute('aria-busy');
    }
  }

  // «مزيد»
  document.addEventListener('click', (ev) => {
    const btn = ev.target.closest('.more');
    if(!btn) return;
    const det = btn.closest('.card')?.querySelector('details');
    if(det) det.open = !det.open;
  });

  // مشاركة
  const shareText = 'تابع «خط التماس الأخباري»: أحدث الأخبار الرياضية العربية.';
  function openShare(url){ window.open(url, '_blank','noopener'); }
  document.querySelectorAll('.sharebtn').forEach(btn=>{
    btn.addEventListener('click', async ()=>{
      const kind = btn.dataset.share, pageURL = location.href;
      if(kind==='copy'){
        try{ await navigator.clipboard.writeText(`${shareText}\n${pageURL}`); document.getElementById('copyToast').style.display='block'; setTimeout(()=>document.getElementById('copyToast').style.display='none',1600);}catch{}
        return;
      }
      const msg = encodeURIComponent(shareText), url = encodeURIComponent(pageURL);
      if(kind==='whatsapp') openShare(`https://wa.me/?text=${msg}%0A${url}`);
      if(kind==='telegram') openShare(`https://t.me/share/url?url=${url}&text=${msg}`);
      if(kind==='facebook') openShare(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${msg}`);
      if(kind==='x') openShare(`https://x.com/intent/tweet?text=${msg}&url=${url}`);
      if(kind==='linkedin') openShare(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`);
    });
  });

  load();
  setInterval(load, REFRESH_MS);
  document.addEventListener('visibilitychange', ()=>{ if(!document.hidden) load(); });
})();
</script>
</body>
</html>
