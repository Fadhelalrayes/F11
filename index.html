<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>حاسبة الصلوات الفائتة | حساب وقضاء الصلوات</title>
    <meta name="description" content="أداة لحساب عدد الصلوات التي فاتتك ومساعدتك على تنظيم قضائها. أدخل تاريخ ميلادك وتاريخ ترك الصلاة لتبدأ.">
    <meta name="keywords" content="قضاء الصلاة, حساب الصلوات الفائتة, جدول قضاء الصلوات, الصلاة الفائتة">
    <meta name="author" content="Manus">
    <meta name="robots" content="index, follow">

    <!-- Google Fonts: Tajawal -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <style>
        :root { --primary-color: #0d1b2a; --secondary-color: #2a9d8f; --background-color: #f5f7fa; --text-color: #495057; --heading-color: #1b263b; --white-color: #FFFFFF; --danger-color: #e76f51; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Tajawal', sans-serif; margin: 0; line-height: 1.8; background-color: var(--background-color); color: var(--text-color); font-weight: 400; }
        .container { max-width: 800px; margin: auto; padding: 0 25px; }
        h1, h2 { font-weight: 700; color: var(--heading-color); text-align: center; }
        
        h1 { font-size: 2.8rem; font-weight: 800; margin-bottom: 10px; }
        h2 { font-size: 2rem; margin-bottom: 40px; color: var(--secondary-color); }
        section { padding: 60px 0; }
        
        .calculator-section { background: var(--white-color); padding: 40px; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: 700; margin-bottom: 8px; color: var(--heading-color); }
        .form-group input, .form-group select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; font-family: 'Tajawal', sans-serif; font-size: 1rem; box-sizing: border-box; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { border-color: var(--secondary-color); outline: none; }
        
        .full-width { grid-column: 1 / -1; }
        
        .calc-button { width: 100%; padding: 15px; background: var(--secondary-color); color: var(--white-color); border: none; border-radius: 8px; cursor: pointer; font-size: 1.2rem; font-weight: 700; transition: all 0.3s; margin-top: 20px; }
        .calc-button:hover { background-color: #248a7e; }

        .results-section { margin-top: 40px; background-color: #e9f5f3; padding: 30px; border-radius: 10px; border: 2px solid var(--secondary-color); display: none; /* Hidden by default */ }
        .results-section h3 { text-align: center; margin-top: 0; font-size: 1.8rem; }
        
        .results-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .results-table th, .results-table td { padding: 12px 15px; text-align: right; border-bottom: 1px solid #ccc; }
        .results-table th { background-color: var(--primary-color); color: var(--white-color); font-weight: 700; }
        .results-table td { font-size: 1.1rem; }
        .results-table tr:last-child td { border-bottom: none; }
        .total-row td { font-weight: 800; color: var(--danger-color); font-size: 1.2rem !important; }

        .main-footer { background-color: var(--primary-color); color: var(--white-color); text-align: center; padding: 20px 0; margin-top: 60px; }
        .main-footer p { margin: 0; opacity: 0.7; }

        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            .form-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <main>
        <section id="calculator">
            <div class="container">
                <h1>حاسبة قضاء الصلوات الفائتة</h1>
                <p style="text-align: center; max-width: 600px; margin: 0 auto 40px;">أداة لمساعدتك على معرفة عدد الصلوات التي عليك قضاؤها وتنظيم جدول لذلك.</p>

                <div class="calculator-section">
                    <form id="prayer-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="birth-date">تاريخ الميلاد</label>
                                <input type="date" id="birth-date" name="birth_date" required>
                            </div>
                            <div class="form-group">
                                <label for="gender">الجنس</label>
                                <select id="gender" name="gender" required>
                                    <option value="" disabled selected>اختر الجنس</option>
                                    <option value="male">ذكر</option>
                                    <option value="female">أنثى</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="start-miss-date">منذ متى تركت الصلاة؟ (تاريخ البداية)</label>
                                <input type="date" id="start-miss-date" name="start_miss_date" required>
                            </div>
                            <div class="form-group">
                                <label for="prayers-made-up">كم صلاة قضيت حتى الآن؟ (تقريبي)</label>
                                <input type="number" id="prayers-made-up" name="prayers_made_up" value="0" min="0" required>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <button type="submit" class="calc-button"><i class="fas fa-calculator"></i> احسب الصلوات الفائتة</button>
                        </div>
                    </form>

                    <div id="results" class="results-section">
                        <h3>جدول قضاء الصلوات الفائتة</h3>
                        <p id="results-summary" style="text-align: center;"></p>
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>الصلاة</th>
                                    <th>عدد المرات الفائتة</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>الفجر</td>
                                    <td id="fajr-missed">0</td>
                                </tr>
                                <tr>
                                    <td>الظهر</td>
                                    <td id="dhuhr-missed">0</td>
                                </tr>
                                <tr>
                                    <td>العصر</td>
                                    <td id="asr-missed">0</td>
                                </tr>
                                <tr>
                                    <td>المغرب</td>
                                    <td id="maghrib-missed">0</td>
                                </tr>
                                <tr>
                                    <td>العشاء</td>
                                    <td id="isha-missed">0</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>الإجمالي المتبقي للقضاء</strong></td>
                                    <td id="total-missed"><strong>0</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 حاسبة قضاء الصلوات. نسأل الله لنا ولكم القبول.</p>
        </div>
    </footer>

    <script>
        document.getElementById('prayer-form').addEventListener('submit', function(event) {
            event.preventDefault();

            // 1. جمع البيانات
            const birthDate = new Date(document.getElementById('birth-date').value);
            const gender = document.getElementById('gender').value;
            const startMissDate = new Date(document.getElementById('start-miss-date').value);
            const prayersMadeUp = parseInt(document.getElementById('prayers-made-up').value) || 0;

            // 2. حساب سن البلوغ التقريبي
            const ageOfTakleef = new Date(birthDate);
            // سن التكليف يختلف، لكن 15 سنة هو حد شائع ومقبول للحساب
            ageOfTakleef.setFullYear(birthDate.getFullYear() + 15);

            // تحديد تاريخ بدء الحساب الفعلي (الأبعد بين تاريخ البلوغ وتاريخ ترك الصلاة)
            const calculationStartDate = startMissDate > ageOfTakleef ? startMissDate : ageOfTakleef;
            const today = new Date();

            // 3. حساب الفرق بالأيام
            if (calculationStartDate >= today) {
                alert("تاريخ بدء ترك الصلاة يجب أن يكون في الماضي.");
                return;
            }
            
            const timeDiff = today.getTime() - calculationStartDate.getTime();
            const daysMissed = Math.ceil(timeDiff / (1000 * 3600 * 24));

            // 4. حساب إجمالي الصلوات الفائتة
            const totalPrayersPerDay = 5;
            let totalMissedPrayers = daysMissed * totalPrayersPerDay;

            // تعديل للنساء (طرح أيام الحيض التقريبية)
            if (gender === 'female') {
                // نفترض 7 أيام حيض في الشهر كمعدل تقريبي
                const monthsMissed = daysMissed / 30.44; // متوسط عدد الأيام في الشهر
                const periodDays = Math.floor(monthsMissed * 7);
                totalMissedPrayers -= periodDays * totalPrayersPerDay;
            }
            
            // تأكد من أن العدد لا يكون سالبًا
            totalMissedPrayers = Math.max(0, totalMissedPrayers);

            // 5. حساب المتبقي بعد طرح ما تم قضاؤه
            const remainingPrayers = Math.max(0, totalMissedPrayers - prayersMadeUp);
            const remainingPerPrayer = Math.ceil(remainingPrayers / 5);

            // 6. عرض النتائج
            document.getElementById('fajr-missed').textContent = remainingPerPrayer.toLocaleString();
            document.getElementById('dhuhr-missed').textContent = remainingPerPrayer.toLocaleString();
            document.getElementById('asr-missed').textContent = remainingPerPrayer.toLocaleString();
            document.getElementById('maghrib-missed').textContent = remainingPerPrayer.toLocaleString();
            document.getElementById('isha-missed').textContent = remainingPerPrayer.toLocaleString();
            document.getElementById('total-missed').textContent = remainingPrayers.toLocaleString();
            
            document.getElementById('results-summary').textContent = `بناءً على المدة من ${calculationStartDate.toLocaleDateString('ar-EG')} إلى اليوم، وبعد خصم ما تم قضاؤه.`;

            document.getElementById('results').style.display = 'block';
            
            // التمرير إلى قسم النتائج
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        });
    </script>

</body>
</html>
