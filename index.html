<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>الصلاة وفق المذهب الجعفري | تعلم الصلاة ومواقيتها</title>
    <meta name="description" content="دليلك الشامل لتعلم الصلاة وأحكامها (الطهارة، الوضوء، التيمم، الشك، السهو، المبطلات، المستحبات، القضاء) مع مواقيت الصلاة اليومية الدقيقة لمنطقتك، وفقاً لفتاوى سماحة السيد السيستاني (دام ظله).">
    <meta name="keywords" content="مواقيت الصلاة, تعليم الصلاة, كيفية الصلاة, المذهب الجعفري, السيد السيستاني, أحكام الصلاة, التيمم, السهو, الطهارة, الوضوء, قضاء الصلاة, فقه, شيعة, الأذان, الإقامة, مبطلات الصلاة, مستحبات الصلاة, القنوت, الشك في الصلاة">
    <meta name="author" content="فاضل الريس">
    <link rel="canonical" href="https://your-domain.com/salah-guide.html">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="theme-color" content="#003366">
    
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; img-src 'self' https: data:; connect-src 'self' https://api.aladhan.com; frame-ancestors 'none'; form-action 'none'; base-uri 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta name="referrer-policy" content="strict-origin-when-cross-origin">
    <meta property="og:title" content="الصلاة وفق المذهب الجعفري | تعلم الصلاة ومواقيتها">
    <meta property="og:description" content="دليل مبسط لتعلم الصلاة وأحكامها مع مواقيت الصلاة اليومية الدقيقة لمنطقتك.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1584335319462-a3c6a3885165?q=80&w=2070&auto=format&fit=crop">
    <meta property="og:url" content="https://your-domain.com/salah-guide.html">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ar_AR">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "mainEntityOfPage": { "@type": "WebPage", "@id": "https://your-domain.com/salah-guide.html" },
      "headline": "الصلاة وفق المذهب الجعفري: تعلم الصلاة ومواقيتها (فتاوى السيد السيستاني)",
      "image": "https://images.unsplash.com/photo-1584335319462-a3c6a3885165?q=80&w=2070&auto=format&fit=crop",
      "author": { "@type": "Person", "name": "فاضل الريس" },
      "publisher": { "@type": "Organization", "name": "دليل الصلاة الجعفرية" }
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <style>
        :root{--primary-color:#003366;--secondary-color:#5A7D7C;--background-color:#FFFFFF;--light-bg-color:#F9F7F3;--text-color:#3E3E3E;--heading-color:#003366;--white-color:#FFFFFF;--quote-bg-color:#F1F5F9;--border-color:#EAEAEA;--success-color:#28a745}
        html{scroll-behavior:smooth}
        body{font-family:'Tajawal',sans-serif;margin:0;line-height:1.9;background-color:var(--background-color);color:var(--text-color);font-weight:400;font-size:clamp(16px,1.2vw,18px)}
        .container{max-width:1100px;margin:0 auto;padding:0 25px}
        h2{font-size:clamp(2rem,5vw,2.6rem);text-align:center;margin-bottom:50px;color:var(--heading-color)}
        h3{font-size:clamp(1.5rem,4vw,1.8rem);color:var(--heading-color)}
        h4{font-size:clamp(1.2rem,3vw,1.4rem);color:var(--secondary-color)}
        section{padding:clamp(60px,8vw,90px) 0}
        .main-header{background-color:rgba(255,255,255,.85);backdrop-filter:blur(10px);box-shadow:0 2px 15px rgba(0,0,0,.05);padding:15px 0;position:sticky;top:0;z-index:1000}
        .main-header .container{display:grid;grid-template-columns:auto 1fr;align-items:center;gap:20px}
        .logo{font-size:clamp(1.4rem,4vw,1.7rem);font-weight:800;color:var(--primary-color);text-decoration:none;white-space:nowrap}
        .main-nav{display:flex;align-items:center;gap:clamp(15px,2.5vw,25px);justify-content:flex-start}
        @media (max-width:950px){.main-header .container{grid-template-columns:1fr;justify-items:center;gap:10px}.main-nav{width:100%;justify-content:center;overflow-x:auto;-ms-overflow-style:none;scrollbar-width:none}.main-nav::-webkit-scrollbar{display:none}}
        .main-nav a{color:var(--primary-color);text-decoration:none;font-weight:500;transition:color .3s;font-size:clamp(.9rem,2vw,1rem);white-space:nowrap}
        .main-nav a:hover{color:var(--secondary-color)}
        .hero{position:relative;width:100%;padding:clamp(80px,12vh,150px) 0;display:flex;align-items:center;justify-content:center;text-align:center;overflow:hidden}
        .hero::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(to top,rgba(255,255,255,.8) 0%,rgba(255,255,255,.3) 70%),url('https://images.unsplash.com/photo-1584335319462-a3c6a3885165?q=80&w=2070&auto=format&fit=crop');background-size:cover;background-position:center 30%;z-index:-1}
        .hero-title-box{background:rgba(255,255,255,.5);border:1px solid rgba(0,51,102,.15);padding:clamp(20px,4vw,30px) clamp(30px,6vw,60px);border-radius:12px;backdrop-filter:blur(6px);box-shadow:0 5px 25px rgba(0,51,102,.1);margin-bottom:30px}
        .hero h1{font-size:clamp(2.2rem,6vw,3rem);font-weight:800;margin:0;color:var(--heading-color)}
        .prayer-times-widget{background:rgba(255,255,255,.85);border:1px solid rgba(0,51,102,.1);padding:20px 25px;border-radius:20px;backdrop-filter:blur(15px);box-shadow:0 8px 30px rgba(0,51,102,.1);max-width:450px;margin:0 auto}
        .widget-header{text-align:center;margin-bottom:15px;padding-bottom:15px;border-bottom:1px dashed var(--border-color)}
        .widget-header #date-display{font-size:1rem;font-weight:500;color:var(--text-color)}
        .widget-header #countdown-display{font-size:1.2rem;font-weight:700;color:var(--primary-color);margin-top:8px;min-height:22px}
        .prayer-times-list{list-style:none;padding:0;margin:0}
        .prayer-time-row{display:flex;justify-content:space-between;align-items:center;padding:14px 5px;border-bottom:1px dashed var(--border-color)}
        .prayer-time-row:last-child{border-bottom:none}
        .prayer-name{font-size:1.1rem;font-weight:500;color:var(--text-color)}
        .prayer-time{font-size:1.1rem;font-weight:700;color:var(--primary-color);direction:ltr}
        #widget-message{text-align:center;color:var(--primary-color);font-weight:500;padding:20px}
        .content-section .container{max-width:900px}
        .content-section.alternate-bg{background-color:var(--light-bg-color)}
        .content-section h3{margin-top:40px;margin-bottom:20px;border-bottom:2px solid var(--secondary-color);padding-bottom:10px}
        .content-section p,.content-section ul,.content-section ol{text-align:justify}
        .content-section ul,.content-section ol{list-style-type:none;padding-right:20px}
        .content-section ul li,.content-section ol li{position:relative;padding-right:30px;margin-bottom:15px}
        .content-section ul li::before{content:'\f00c';font-family:'Font Awesome 6 Free';font-weight:900;color:var(--secondary-color);position:absolute;right:0;top:5px}
        .content-section ol{counter-reset:item}
        .content-section ol li::before{content:counter(item);counter-increment:item;background:var(--secondary-color);color:#fff;border-radius:50%;width:24px;height:24px;display:inline-block;text-align:center;line-height:24px;font-size:.9rem;position:absolute;right:0;top:5px}
        .hadith-quote{position:relative;background-color:var(--quote-bg-color);border-right:5px solid var(--secondary-color);padding:30px 35px;margin:40px 0;border-radius:8px;overflow:hidden}
        .hadith-quote::before{content:'“';position:absolute;top:-10px;left:10px;font-size:100px;font-weight:800;color:rgba(0,51,102,.07);line-height:1;z-index:1}
        .hadith-quote p{margin:0;font-size:1.2rem;font-weight:500;color:#334155;position:relative;z-index:2}
        .hadith-quote .source{display:block;text-align:left;font-style:normal;font-weight:500;margin-top:15px;color:#64748B;font-size:.95rem;position:relative;z-index:2}
        .main-footer{background-color:var(--primary-color);color:#fff;text-align:center;padding:40px 20px}
        .share-section{margin-bottom:30px}
        .share-section h4{color:#fff;font-weight:500;margin-bottom:15px}
        .share-icons{display:flex;justify-content:center;align-items:center;gap:20px}
        .share-icons a,.share-icons button{background-color:rgba(255,255,255,.15);color:#fff;width:45px;height:45px;border-radius:50%;display:flex;align-items:center;justify-content:center;text-decoration:none;font-size:1.3rem;transition:background-color .3s,transform .3s;border:none;cursor:pointer}
        .share-icons a:hover,.share-icons button:hover{background-color:rgba(255,255,255,.3);transform:scale(1.1)}
        .footer-credit{margin-top:15px;font-size:1.1rem}
        .footer-credit a{color:#a9cce3;text-decoration:none;font-weight:700;transition:color .3s}
        .footer-credit a:hover{color:#fff}
        .fiqh-table-wrapper{overflow-x:auto;-webkit-overflow-scrolling:touch;border:1px solid #ddd;border-radius:8px;margin:30px 0}
        .fiqh-table{width:100%;border-collapse:collapse;font-size:1rem}
        .fiqh-table th,.fiqh-table td{border:1px solid #ddd;padding:12px 15px;text-align:center;white-space:normal}
        .fiqh-table th{background-color:var(--secondary-color);color:#fff;font-weight:700}
        .fiqh-table tr:nth-child(even){background-color:#f9f9f9}
        .fiqh-table td:first-child{font-weight:500;text-align:right}
        .back-to-top{position:fixed;bottom:25px;left:25px;background:var(--primary-color);color:#fff;width:45px;height:45px;border-radius:50%;display:flex;align-items:center;justify-content:center;text-decoration:none;opacity:0;visibility:hidden;transition:opacity .3s,visibility .3s,transform .3s;transform:translateY(20px);z-index:1000}
        .back-to-top.visible{opacity:.8;visibility:visible;transform:translateY(0)}
        .back-to-top:hover{opacity:1}
        .toast-notification{position:fixed;bottom:20px;left:50%;transform:translate(-50%,100px);background-color:#fff;color:var(--text-color);padding:20px 30px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,.15);z-index:2000;opacity:0;visibility:hidden;transition:transform .4s ease,opacity .4s ease,visibility .4s;display:flex;align-items:center;gap:15px}
        .toast-notification.show{transform:translate(-50%,0);opacity:1;visibility:visible}
        .toast-notification .icon{font-size:1.5rem;color:var(--success-color)}
        .toast-notification .message{font-size:1.1rem;font-weight:500}
    </style>
</head>
<body>

<header class="main-header">
    <div class="container">
        <a href="#" class="logo">الصلاة وفق المذهب الجعفري</a>
        <nav class="main-nav">
            <a href="#preliminaries">المقدمات</a>
            <a href="#how-to-pray">كيفية الصلاة</a>
            <a href="#prayer-rulings">الشك والسهو</a>
            <a href="#invalidators">المبطلات</a>
            <a href="#missed-prayers">القضاء</a>
        </nav>
    </div>
</header>

<main>
    <section id="hero" class="hero">
        <div class="container">
            <div class="hero-title-box">
                <h1>دليلك الشامل لتعلم الصلاة</h1>
            </div>
            <div class="prayer-times-widget">
                <div class="widget-header">
                    <div id="date-display"></div>
                    <div id="countdown-display"></div>
                </div>
                <ul id="prayer-times-list" class="prayer-times-list"></ul>
                <p id="widget-message">جاري طلب تحديد الموقع لجلب المواقيت...</p>
            </div>
        </div>
    </section>

    <!-- بقية أقسام الصفحة كما هي (بدون أي تعديل) -->
    <section id="preliminaries" class="content-section">
        <div class="container">
            <h2>مقدمات الصلاة</h2>
            <p>قبل الشروع في الصلاة، يجب على المصلي أن يحقق شروطاً أساسية لا تصح الصلاة بدونها...</p>
        </div>
    </section>
    <!-- … (المحتوى الأصلي كامل كما أرسلته) … -->
</main>

<footer class="main-footer">
    <div class="container">
        <div class="share-section">
            <h4>شارك الصفحة</h4>
            <div class="share-icons">
                <a href="#" id="share-whatsapp" target="_blank" aria-label="مشاركة عبر واتساب"><i class="fab fa-whatsapp"></i></a>
                <a href="#" id="share-telegram" target="_blank" aria-label="مشاركة عبر تليجرام"><i class="fab fa-telegram"></i></a>
                <button id="copy-link-btn" aria-label="نسخ الرابط"><i class="fas fa-link"></i></button>
            </div>
        </div>
        <p>&copy; 2025 الصلاة وفق المذهب الجعفري.</p>
        <p class="footer-credit">إعداد ومراجعة: 
            <a href="https://wa.me/97333375858" target="_blank" rel="noopener noreferrer">فاضل الريس</a>
        </p>
    </div>
</footer>

<a href="#" class="back-to-top" aria-label="العودة إلى الأعلى"><i class="fas fa-arrow-up"></i></a>

<div id="toast-notification" class="toast-notification">
    <div class="icon"><i class="fas fa-check-circle"></i></div>
    <div class="message" id="toast-message"></div>
</div>

<!-- مكتبة المواقيت (المسار الصحيح) -->
<script src="https://cdn.jsdelivr.net/npm/praytimes@0.0.5/src/praytimes.min.js"></script>

<script>
/* زر العودة للأعلى */
const backToTopButton=document.querySelector('.back-to-top');
window.addEventListener('scroll',()=>{if(window.scrollY>300){backToTopButton.classList.add('visible')}else{backToTopButton.classList.remove('visible')}});

/* توست */
const showToast=(message)=>{const t=document.getElementById('toast-notification');document.getElementById('toast-message').textContent=message;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500)};

/* مشاركة */
const pageUrl=window.location.href,pageTitle=document.title;
document.getElementById('share-whatsapp').href=`https://api.whatsapp.com/send?text=${encodeURIComponent(pageTitle+" "+pageUrl)}`;
document.getElementById('share-telegram').href=`https://t.me/share/url?url=${encodeURIComponent(pageUrl)}&text=${encodeURIComponent(pageTitle)}`;
document.getElementById('copy-link-btn').addEventListener('click',()=>{navigator.clipboard.writeText(pageUrl).then(()=>showToast('تم نسخ الرابط بنجاح!'),()=>showToast('فشل نسخ الرابط.'))});

/* ويدجت المواقيت */
document.addEventListener('DOMContentLoaded',()=>{
    const prayerList=document.getElementById('prayer-times-list');
    const widgetMessage=document.getElementById('widget-message');
    const dateDisplay=document.getElementById('date-display');
    const countdownDisplay=document.getElementById('countdown-display');
    let countdownInterval;

    const createTimeRow=(label,time)=>`<li class="prayer-time-row"><div class="prayer-name">${label}</div><div class="prayer-time">${time}</div></li>`;

    const formatToAmPm=(timeStr)=>{
        const [hour,minute]=timeStr.split(':');
        const d=new Date();
        d.setHours(parseInt(hour,10),parseInt(minute,10),0,0);
        const ampm=d.getHours()>=12?'م':'ص';
        const hh=((d.getHours()+11)%12+1);
        return `${hh.toString().padStart(2,'0')}:${minute} ${ampm}`;
    };

    const startCountdown=(arr)=>{
        if(countdownInterval) clearInterval(countdownInterval);
        countdownInterval=setInterval(()=>{
            const now=new Date();
            let next=arr.find(p=>p.time>now);
            if(!next){next={name:arr[0].name,time:new Date(arr[0].time)};next.time.setDate(next.time.getDate()+1)}
            const diff=next.time-now;
            const h=Math.floor(diff/3600000),m=Math.floor((diff%3600000)/60000),s=Math.floor((diff%60000)/1000);
            countdownDisplay.textContent=`الوقت المتبقي لآذان ${next.name}: ${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        },1000);
    };

    const getPrayerTimes=(lat,lon)=>{
        const date=new Date();
        const prayTimes=new PrayTimes('Jafari');            // الاسم الصحيح للكلاس
        prayTimes.adjust({ midnight:'Jafari', highLats:'AngleBased' });
        prayTimes.tune({ maghrib:15 });                     // المغرب = الغروب + 15 دقيقة (كما في الصورة)

        const times=prayTimes.getTimes(date,[lat,lon]);

        fetch(`https://api.aladhan.com/v1/gToH?date=${date.getDate()}-${date.getMonth()+1}-${date.getFullYear()}`)
            .then(r=>r.json())
            .then(h=>{
                const g=new Intl.DateTimeFormat('ar-EG-u-nu-latn',{weekday:'long',year:'numeric',month:'long',day:'numeric'}).format(date);
                const hijri=`${h.data.hijri.day} ${h.data.hijri.month.ar} ${h.data.hijri.year} هـ`;
                dateDisplay.innerHTML=`${g}<br>${hijri}`;
            }).catch(()=>{
                dateDisplay.textContent=new Intl.DateTimeFormat('ar-EG-u-nu-latn',{weekday:'long',year:'numeric',month:'long',day:'numeric'}).format(date);
            });

        const map=[
            {name:'الفجر', time:formatToAmPm(times.fajr)},
            {name:'الشروق', time:formatToAmPm(times.sunrise)},
            {name:'الظهر',  time:formatToAmPm(times.dhuhr)},
            {name:'الغروب', time:formatToAmPm(times.sunset)},
            {name:'المغرب', time:formatToAmPm(times.maghrib)},
            {name:'منتصف الليل', time:formatToAmPm(times.midnight)}
        ];

        prayerList.innerHTML='';
        const forCountdown=[];
        map.forEach(p=>{
            prayerList.innerHTML+=createTimeRow(p.name,p.time);
            if(p.name!=='الشروق' && p.name!=='الغروب' && p.name!=='منتصف الليل'){
                const [t,mod]=p.time.split(' ');
                let [hh,mm]=t.split(':'); hh=parseInt(hh,10);
                if(mod==='م'&&hh!==12) hh+=12; if(mod==='ص'&&hh===12) hh=0;
                const d=new Date(); d.setHours(hh,parseInt(mm,10),0,0);
                forCountdown.push({name:p.name,time:d});
            }
        });
        forCountdown.sort((a,b)=>a.time-b.time);
        startCountdown(forCountdown);
        widgetMessage.style.display='none';
    };

    if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(
            pos=>getPrayerTimes(pos.coords.latitude,pos.coords.longitude),
            ()=>{widgetMessage.textContent='يرجى السماح بالوصول إلى الموقع لعرض المواقيت.'}
        );
    }else{
        widgetMessage.textContent='المتصفح لا يدعم خدمة تحديد المواقع.';
    }
});
</script>

</body>
</html>
```0
