<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ูุงุญุต ุฃุนุฑุงุถ ุงูุณุฑุทุงู โ ุชูุนูุฉ ูุชุญูููุงุช ููุซููุฉ</title>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f5f6f8; --ink:#111827; --muted:#6b7280;
    --card:#ffffff; --line:#e5e7eb;
    --gold:#b58900; --gold-soft:#f5d574;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:"Cairo",sans-serif; background:var(--bg); color:var(--ink)}
  header{text-align:center; padding:24px 12px}
  .brand{font-family:"Amiri",serif; font-size:clamp(26px,4.5vw,42px); color:var(--gold)}
  .tag{margin-top:6px; font-size:14px; color:#6b7280}
  .shell{max-width:980px; margin:0 auto; padding:0 16px}
  .hero{background:var(--card); border:1px solid var(--line); border-radius:20px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,.05)}
  .row{display:grid; gap:16px}
  @media(min-width:920px){ .row{grid-template-columns:1.2fr .8fr} }

  .field{display:flex; flex-direction:column; gap:6px; margin-bottom:12px}
  .hint{font-size:12px; color:#6b7280}
  .center{text-align:center}

  .seg{display:flex; gap:6px; justify-content:center; flex-wrap:wrap}
  .seg button{flex:1; padding:10px 14px; border-radius:10px; border:1px solid var(--line); background:#f9fafb; cursor:pointer; max-width:200px; font-weight:700}
  .seg button.on{background:var(--gold); color:#111; border-color:var(--gold)}

  .select{ position:relative; display:inline-block; width:100% }
  .select select{
    width:100%; appearance:none; background:#fff; border:1px solid var(--gold); border-radius:10px;
    padding:12px 42px 12px 12px; font-size:1rem; cursor:pointer; color:#111; text-align:right;
  }
  .select::after{
    content:""; position:absolute; top:50%; transform:translateY(-50%); right:12px; width:18px; height:18px;
    background:linear-gradient(135deg,var(--gold),var(--gold-soft));
    -webkit-mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="black" d="M5.23 7.21a.75.75 0 011.06.02L10 11.06l3.71-3.83a.75.75 0 111.08 1.04l-4.24 4.38a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/></svg>') center/contain no-repeat;
    mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="black" d="M5.23 7.21a.75.75 0 011.06.02L10 11.06l3.71-3.83a.75.75 0 111.08 1.04l-4.24 4.38a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z"/></svg>') center/contain no-repeat;
    pointer-events:none; opacity:.95;
  }

  .btn{padding:12px 20px; border-radius:10px; border:none; cursor:pointer; background:linear-gradient(90deg,var(--gold),var(--gold-soft)); color:#111; font-weight:700; display:block; margin:0 auto}
  .badge{display:inline-block; padding:10px 14px; border-radius:10px; margin-top:12px}
  .ok{background:#ecfdf5; color:#065f46}
  .warn{background:#fffbeb; color:#92400e}
  .danger{background:#fee2e2; color:#991b1b}

  .kpi{display:grid; gap:10px; grid-template-columns:1fr 1fr; margin-top:10px}
  .k{background:#f9fafb; border:1px solid var(--line); border-radius:10px; padding:10px; text-align:center}
  .k .v{font-weight:700; font-size:18px}

  .deck{display:grid; gap:12px; grid-template-columns:1fr; margin-top:16px}
  @media(min-width:860px){ .deck{grid-template-columns:repeat(2,1fr)} }
  .card{background:#fdfdfd; border:1px solid var(--line); border-radius:12px; padding:14px; box-shadow:0 2px 6px rgba(0,0,0,.04)}
  .card h3{margin:0 0 6px; font-family:"Amiri",serif; color:var(--gold)}
  .card p, .card ul{margin:0; font-size:14px; color:#374151; line-height:1.7}
  .card ul{margin-top:8px; padding-inline-start:20px}

  .iconbtn{width:34px; height:34px; border-radius:8px; display:flex; align-items:center; justify-content:center; border:1px solid var(--line); background:#fff; cursor:pointer}

  .pdfwrap{margin-top:12px; text-align:center; display:none}
  .pdfbtn{padding:10px 16px; border-radius:10px; border:1px solid var(--gold); background:#fff; cursor:pointer; font-weight:700}
</style>
</head>
<body>
<header>
  <div class="brand">ูุงุญุต ุฃุนุฑุงุถ ุงูุณุฑุทุงู</div>
  <div class="tag">ูููุน ุชูุนูู ุจุงููุบุฉ ุงูุนุฑุจูุฉ ูุณุงุนุฏู ุนูู ููู ุงูุฃุนุฑุงุถ ุงูุชุญุฐูุฑูุฉ ุงูุดุงุฆุนุฉ ูุนูุงูู ุงูุฎุทูุฑุฉุ ูููุฏูู ุชูุตูุฉ ุฃูููุฉ ูุฎูุงุฑุงุช ุชุญููู ุฅูู ูุฑุงุฌุน ููุณุชุดููุงุช ุนุงูููุฉ ููุซููุฉ. ูุง ููุนุฏู ุชุดุฎูุตูุง ุทุจููุง ููุง ูุบูู ุนู ุงูุทุจูุจ.</div>
</header>

<main class="shell">
  <section class="hero">
    <div class="row">
      <div>
        <!-- ุงูุฏููุฉ -->
        <div class="field">
          <label><strong>ุงุฎุชุฑ ุฏููุชู</strong></label>
          <div class="select">
            <select id="countrySelect" aria-label="ุงุฎุชุฑ ุงูุฏููุฉ">
              <option value="BHR" selected>ุงูุจุญุฑูู</option>
              <option value="KSA">ุงูุณุนูุฏูุฉ</option>
              <option value="ARE">ุงูุฅูุงุฑุงุช</option>
              <option value="QAT">ูุทุฑ</option>
              <option value="KWT">ุงููููุช</option>
              <option value="OMN">ุนููุงู</option>
              <option value="EGY">ูุตุฑ</option>
              <option value="JOR">ุงูุฃุฑุฏู</option>
              <option value="LBN">ูุจูุงู</option>
              <option value="IRQ">ุงูุนุฑุงู</option>
              <option value="LBA">ููุจูุง</option>
              <option value="MAR">ุงููุบุฑุจ</option>
              <option value="DZA">ุงูุฌุฒุงุฆุฑ</option>
              <option value="TUN">ุชููุณ</option>
              <option value="SDN">ุงูุณูุฏุงู</option>
              <option value="SYR">ุณูุฑูุง</option>
              <option value="PSE">ููุณุทูู</option>
              <option value="DJI">ุฌูุจูุชู</option>
              <option value="COM">ุฌุฒุฑ ุงูููุฑ</option>
              <option value="MRT">ููุฑูุชุงููุง</option>
              <option value="SOM">ุงูุตููุงู</option>
              <option value="YEM">ุงูููู</option>
              <option value="IRN">ุฅูุฑุงู</option>
            </select>
          </div>
          <div class="hint">ุงุฎุชูุงุฑ ุงูุฏููุฉ ูุณุงุนุฏ ูู ุนุฑุถ ูุณุชุดูู ูุญูู ููุตู ุจู ููุชูุงุตู ุงูุณุฑูุน.</div>
        </div>

        <!-- ุงูููุน -->
        <div class="field center">
          <label><strong>ุงูููุน</strong></label>
          <div class="seg" id="sexSeg">
            <button type="button" class="on" data-sex="male">ุฑุฌู</button>
            <button type="button" data-sex="female">ุงูุฑุฃุฉ</button>
          </div>
          <div class="hint">ุจุนุถ ูุญูุตุงุช ุงูุชุญุฑู ุชุฎุชูู ุจูู ุงูุฑุฌุงู ูุงููุณุงุก.</div>
        </div>

        <!-- ุงูุนูุฑ -->
        <div class="field center">
          <label><strong>ุงูุนูุฑ</strong></label>
          <input id="age" type="number" inputmode="numeric" min="0" max="120" placeholder="ูุซุงู: 45" style="width:180px; padding:12px; border:1px solid var(--line); border-radius:10px; text-align:center; margin:0 auto">
          <div class="hint">ูุณุงุนุฏ ุงูุนูุฑ ุนูู ุชุญุฏูุฏ ูุญูุต ุงูุชุญุฑู ุงูููุงุณุจุฉ (ูุซู ุงูููููู/ุงูุซุฏู/ุนูู ุงูุฑุญู).</div>
        </div>

        <!-- ุนูุงูู ูุคุซุฑุฉ -->
        <div class="field center">
          <label><strong>ุนูุงูู ูุคุซุฑุฉ</strong></label>
          <div class="seg" id="smokeSeg">
            <button type="button" class="on" data-smoke="no">ุบูุฑ ูุฏุฎูู</button>
            <button type="button" data-smoke="yes">ูุฏุฎูู</button>
          </div>
          <div style="margin-top:8px" class="seg" id="familySeg">
            <button type="button" class="on" data-fh="no">ูุง ุชุงุฑูุฎ ุนุงุฆูู ููู</button>
            <button type="button" data-fh="yes">ุชุงุฑูุฎ ุนุงุฆูู ููู</button>
          </div>
          <div class="hint">ุงูุชุฏุฎูู ูุงูุชุงุฑูุฎ ุงูุนุงุฆูู ูุฏ ูุฑูุนุงู ุงุญุชูุงู ุงูุฎุทูุฑุฉ.</div>
        </div>

        <!-- ุฃุณุฆูุฉ ุงูุฃุนุฑุงุถ -->
        <div class="card">
          <h3>ุฃุณุฆูุฉ ุงูุฃุนุฑุงุถ (ุงุฎุชุฑ ูุนู/ูุง)</h3>
          <div class="hint">ุฅุฐุง ูุงู ุนุฑุถู ุฌุฏูุฏ ููุณุชูุฑ ูุฃูุซุฑ ูู 3 ุฃุณุงุจูุน ุฃู ูุฒุฏุงุฏ ุณูุกูุงุ ูุญุชุงุฌ ูุชูููู ุทุจู.</div>

          <div class="field">
            <div><strong>ุณุนุงู ูุณุชูุฑ &gt; 3 ุฃุณุงุจูุน / ุจูุญูุฉ ูุฒููุฉ / ุฎุฑูุฌ ุฏู ูุน ุงูุณุนุงู</strong></div>
            <div class="seg" data-q="cough"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ูุชูุฉ/ุชูุฑูู ุฌุฏูุฏ ุซุงุจุช ูุฃูุซุฑ ูู 3 ุฃุณุงุจูุน</strong></div>
            <div class="seg" data-q="lump"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ูุฒู ุบูุฑ ูุจุฑูุฑ (ุจุฑุงุฒ/ุจูู/ุณุนุงู/ุจูู ุงูุฏูุฑุงุช)</strong></div>
            <div class="seg" data-q="bleed"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุชุบููุฑ ูุงุถุญ ูู ุดุงูุฉ (A&nbsp;B&nbsp;C&nbsp;D&nbsp;E)</strong></div>
            <div class="seg" data-q="skin"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุชุบููุฑ ูู ุนุงุฏุงุช ุงูุฅุฎุฑุงุฌ &gt; 3 ุฃุณุงุจูุน</strong></div>
            <div class="seg" data-q="bowel"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุฃูู ุฌุฏูุฏ ูุณุชูุฑ (ุตุฏุฑ/ุนุธู/ุจุทู/ุธูุฑ)</strong></div>
            <div class="seg" data-q="pain"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุตุนูุจุฉ ุจูุน / ุญุฑูุฉ ุดุฏูุฏุฉ / ุงูุชูุงุก ูุจููุฑ</strong></div>
            <div class="seg" data-q="gi"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุญููู ุฃู ุชุนุฑูู ูููู ุบุฒูุฑ ุฃู ุฅุฑูุงู ุดุฏูุฏ ุบูุฑ ููุณูุฑ</strong></div>
            <div class="seg" data-q="bsy"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุชูุฑูู ุนูุฏ ููููุฉ ุบูุฑ ูุคููุฉ ูุง ุชุฒูู</strong></div>
            <div class="seg" data-q="nodes"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุชุบููุฑุงุช ูู ุงูุซุฏู (ุฅูุฑุงุฒ/ุงูููุงุด ุงูุญููุฉ/ุชุบุถูู)</strong></div>
            <div class="seg" data-q="breast"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ุชุบููุฑ ููุญูุธ ูู ุงูุชุจููู (ููุฑุฌุงู 50+)</strong></div>
            <div class="seg" data-q="prostate"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
          <div class="field">
            <div><strong>ูุฑุญุฉ ูู/ุฌูุฏ ูุง ุชูุชุฆู</strong></div>
            <div class="seg" data-q="ulcer"><button type="button" class="on" data-a="no">ูุง</button><button type="button" data-a="yes">ูุนู</button></div>
          </div>
        </div>

        <button class="btn" id="calc">ุงุนุฑุถ ุงููุชูุฌุฉ</button>
        <div class="pdfwrap" id="pdfwrap">
          <button class="pdfbtn" id="pdfBtn">ุชูุฒูู ุงููุชุงุฆุฌ PDF</button>
        </div>
      </div>

      <div>
        <!-- ูุชูุฌุฉ -->
        <div id="verdict" class="badge ok" style="display:none"></div>

        <div class="kpi" id="kpis" style="display:none">
          <div class="k"><div class="v" id="riskLevel">โ</div><div>ุญุงูุฉ ุงูุชุดุฎูุต</div></div>
          <div class="k"><div class="v" id="whatNext">โ</div><div>ูุงุฐุง ุชูุนู ุงูุขู</div></div>
        </div>

        <div class="deck" id="adviceDeck" style="display:none"></div>

        <!-- ูุณุชุดูู ูุญูู ุญุณุจ ุงูุฏููุฉ (ูุธูุฑ ุจุนุฏ ุงููุชูุฌุฉ) -->
        <div id="localBox" class="card" style="margin-top:12px; display:none">
          <h3>ูุณุชุดูู ููุตู ุจู ูู ุจูุฏู</h3>
          <div class="hint">ุฒุฑ ุงูุงุชุตุงู ูุนูู ูุจุงุดุฑุฉุ ูุน ุฑุงุจุท ุงููููุน ุงูุฑุณูู.</div>
          <div id="localContact" style="margin-top:6px; font-size:14px; color:#374151"></div>
        </div>

        <!-- ูุณุชุดููุงุช ุนุงูููุฉ -->
        <div class="card" style="margin-top:12px">
          <h3>ูุณุชุดููุงุช ุนุงูููุฉ ููุตู ุจูุง</h3>
          <div class="hint">ุงุฎุชุฑ ูุณุชุดูู ููุนุฑูุฉ ุฑูู ุงูุชูุงุตู ูุงูุงุชุตุงู ูุจุงุดุฑุฉ.</div>
          <div class="select">
            <select id="intlSelect" aria-label="ุงุฎุชุฑ ูุณุชุดูู ุนุงููู">
              <option value="">โ ุงุฎุชุฑ ูุณุชุดูู ุนุงููููุง โ</option>
              <option data-phone="+1-877-632-6789" value="https://www.mdanderson.org/">MD Anderson Cancer Center โ ุงูููุงูุงุช ุงููุชุญุฏุฉ</option>
              <option data-phone="+1-507-284-2511" value="https://www.mayoclinic.org/">Mayo Clinic (Oncology) โ ุงูููุงูุงุช ุงููุชุญุฏุฉ</option>
              <option data-phone="+1-212-639-2000" value="https://www.mskcc.org/">Memorial Sloan Kettering โ ุงูููุงูุงุช ุงููุชุญุฏุฉ</option>
              <option data-phone="+44-20-7352-8171" value="https://www.royalmarsden.nhs.uk/">The Royal Marsden โ ุงูููููุฉ ุงููุชุญุฏุฉ</option>
              <option data-phone="+49-30-450-50" value="https://www.charite.de/en/">Charitรฉ โ ุจุฑููู โ ุฃููุงููุง</option>
              <option data-phone="+33-1-4211-4211" value="https://www.gustaveroussy.fr/">Gustave Roussy โ ูุฑูุณุง</option>
              <option data-phone="+49-6221-56-5930" value="https://www.nct-heidelberg.de/en.html">NCT Heidelberg โ ุฃููุงููุง</option>
              <option data-phone="+65-6436-8000" value="https://www.nccs.com.sg/">NCC Singapore โ ุณูุบุงููุฑุฉ</option>
              <option data-phone="+82-2-3410-0200" value="https://www.samsunghospital.com/">Samsung Medical Center โ ููุฑูุง ุงูุฌููุจูุฉ</option>
              <option data-phone="+66-2066-8888" value="https://www.bumrungrad.com/">Bumrungrad International โ ุชุงูููุฏ</option>
              <option data-phone="+66-2022-2222" value="https://www.samitivejhospitals.com/">Samitivej (Cancer Center) โ ุชุงูููุฏ</option>
              <option data-phone="+90-262-678-5000" value="https://www.anadolumedicalcenter.com/en">Anadolu Medical Center โ ุชุฑููุง</option>
              <option data-phone="+971-2-659-0200" value="https://www.clevelandclinicabudhabi.ae/">Cleveland Clinic Abu Dhabi โ ุงูุฅูุงุฑุงุช</option>
              <option data-phone="+91-44-4040-1066" value="https://www.apollohospitals.com/clinical-excellence/apollo-cancer-institutes/">Apollo Cancer Institutes โ ุงูููุฏ</option>
            </select>
          </div>
          <div id="intlContact" style="margin-top:8px; font-size:14px; color:#374151; display:none"></div>
        </div>

        <!-- ุฏููู ุนุงููู -->
        <div class="card" style="margin-top:12px">
          <h3>ุฏููู ุนุงููู ููุซูู</h3>
          <div class="hint">ุฑูุงุจุท ุชุนููููุฉ ูุนุชูุฏุฉ ุนุงููููุง โ ุชููุชุญ ูุจุงุดุฑุฉ.</div>
          <div class="select">
            <select id="refSelect" aria-label="ุงุฎุชุฑ ูุฑุฌุนูุง ุนุงููููุง">
              <option value="">โ ุงุฎุชุฑ ูุฑุฌุนูุง โ</option>
              <option value="https://www.who.int/health-topics/cancer">ููุธูุฉ ุงูุตุญุฉ ุงูุนุงูููุฉ (WHO) โ ุงูุณุฑุทุงู</option>
              <option value="https://www.iarc.who.int/">ุงูููุงูุฉ ุงูุฏูููุฉ ูุฃุจุญุงุซ ุงูุณุฑุทุงู (IARC)</option>
              <option value="https://www.cancer.gov/">ุงููุนูุฏ ุงููููู ููุณุฑุทุงู (NCI) โ ุงูููุงูุงุช ุงููุชุญุฏุฉ</option>
              <option value="https://www.cancer.org/">ุงูุฌูุนูุฉ ุงูุฃููุฑููุฉ ููุณุฑุทุงู (ACS)</option>
              <option value="https://www.nhs.uk/conditions/cancer/">ุฎุฏูุฉ ุงูุตุญุฉ ุงููุทููุฉ ุงูุจุฑูุทุงููุฉ (NHS) โ ุงูุณุฑุทุงู</option>
              <option value="https://uicc.org/">ุงูุงุชุญุงุฏ ุงูุฏููู ูููุงูุญุฉ ุงูุณุฑุทุงู (UICC)</option>
              <option value="https://www.esmo.org/for-patients">ุงูุฌูุนูุฉ ุงูุฃูุฑูุจูุฉ ูุทุจ ุงูุฃูุฑุงู (ESMO) โ ุฃุฏูุฉ ุงููุฑุถู</option>
            </select>
          </div>
        </div>

        <!-- ุงููุตุงุฏุฑ ุงูุทุจูุฉ -->
        <div class="card" style="margin-top:12px">
          <h3>ุงููุตุงุฏุฑ ุงูุทุจูุฉ</h3>
          <div class="hint">ููุงูุงุช ุนู ุงูุฃุนุฑุงุถ ูุงูุชุญุฑูู ุชุดูู ุงูุนูุงูุงุช ุงูุชุญุฐูุฑูุฉ ูุฎุทูุงุช ุงููุชุงุจุนุฉ.</div>
          <div class="select">
            <select id="srcSelect" aria-label="ุงุฎุชุฑ ูุตุฏุฑูุง ุทุจููุง">
              <option value="">โ ุงุฎุชุฑ ูุตุฏุฑูุง โ</option>
              <option value="https://www.who.int/news-room/fact-sheets/detail/cancer">WHO โ ุญูุงุฆู ุฑุฆูุณูุฉ ุนู ุงูุณุฑุทุงู</option>
              <option value="https://www.cancer.gov/about-cancer/diagnosis-staging/symptoms">NCI โ ุงูุฃุนุฑุงุถ ูุงูุนูุงูุงุช ุงูุชุญุฐูุฑูุฉ</option>
              <option value="https://www.cancer.org/cancer/diagnosis-staging/signs-and-symptoms.html">ACS โ ุนูุงูุงุช ูุฃุนุฑุงุถ ุงูุณุฑุทุงู</option>
              <option value="https://www.nhs.uk/conditions/cancer/symptoms/">NHS โ ุฃุนุฑุงุถ ุงูุณุฑุทุงู ูู ุงูุฃูู ุฅูู ุงููุงุก</option>
              <option value="https://www.esmo.org/for-patients/patient-guides">ESMO โ ุฃุฏูุฉ ุงููุฑุถู</option>
              <option value="https://www.nccn.org/patients/guidelines/cancers.aspx">NCCN โ ุฅุฑุดุงุฏุงุช ุงููุฑุถู</option>
            </select>
          </div>
        </div>

        <!-- ูุดุงุฑูุฉ ุซู ุจุฑูุฌุฉ ูุชุทููุฑ -->
        <div class="card" style="margin-top:12px; text-align:center">
          <h3>ุดุงุฑู ุงูุตูุญุฉ</h3>
          <div class="sharebar" style="display:flex; justify-content:center; gap:8px; flex-wrap:wrap">
            <a class="iconbtn" id="shareWA" title="ูุงุชุณุงุจ" aria-label="WhatsApp">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 0a12 12 0 00-10 18.3L1 23l4.9-1A12 12 0 1012 0zm6.5 17.2c-.3.8-1.7 1.6-2.4 1.6-.6 0-1.4.1-3.8-1-3.2-1.4-5.3-4.6-5.5-4.8-.1-.2-1.3-1.7-1.3-3.2 0-1.6.8-2.4 1.1-2.7.3-.3.7-.4 1-.4h.8c.2 0 .6 0 .9.7.3.8 1.1 2.7 1.2 2.9.1.2.2.5 0 .8-.2.3-.3.5-.6.8-.3.3-.6.6-.2 1.2.4.6 1.7 2.8 4 3.8 2.9 1.2 3 .8 3.5.8.5 0 1.8-.8 2.1-1.5.2-.7 1-1.6 1.3-1.8.2-.1.3-.2.5-.1l1 .5c.3.1.5.3.5.5-.1.4-.7 2-1 2.7z"/></svg>
            </a>
            <a class="iconbtn" id="shareTG" title="ุชูููุบุฑุงู" aria-label="Telegram">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M9 18.2l-.3 4.1c.4 0 .6-.2.8-.4l2-1.8 4.1 3c.7.4 1.3.2 1.5-.7L22 6.2c.2-1.1-.4-1.5-1.1-1.2L2.3 11.1c-1.1.4-1 1.3 0 1.6l4.1 1.2 9.4-5.9c.4-.3.9-.1.5.2L9 18.2z"/></svg>
            </a>
            <a class="iconbtn" id="shareX" title="X" aria-label="X">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 2h4.7l5 6.8L18.7 2H22l-7.8 9.1L22 22h-4.8l-5.4-7.2L6 22H2.1l8.3-9.8L3 2z"/></svg>
            </a>
            <a class="iconbtn" id="shareFB" title="Facebook" aria-label="Facebook">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M22 12a10 10 0 10-11.6 9.9v-7H7.7V12h2.7V9.8c0-2.7 1.6-4.2 4-4.2 1.2 0 2.5.2 2.5.2v2.7h-1.4c-1.4 0-1.9.9-1.9 1.8V12h3.2l-.5 2.9h-2.7v7A10 10 0 0022 12z"/></svg>
            </a>
            <button class="iconbtn" id="copyLink" title="ูุณุฎ ุงูุฑุงุจุท" aria-label="Copy Link">
              <svg viewBox="0 0 24 24" width="18" height="18"><path d="M16 1H8C6.3 1 5 2.3 5 4v12c0 1.7 1.3 3 3 3h8c1.7 0 3-1.3 3-3V4c0-1.7-1.3-3-3-3zm1 15c0 .6-.4 1-1 1H8c-.6 0-1-.4-1-1V4c0-.6.4-1 1-1h8c.6 0 1 .4 1 1v12zM7 20c0 .6.4 1 1 1h8v2H8c-1.7 0-3-1.3-3-3v-2h2v2z"/></svg>
            </button>
          </div>
        </div>

        <footer style="text-align:center; margin:10px 0 0; font-size:12px; color:#6b7280">
          <a id="devLink" class="ghost-link" href="https://api.whatsapp.com/send/?phone=97333375858&text&type=phone_number&app_absent=0&wame_ctl=1" target="_blank" rel="noopener">ุจุฑูุฌุฉ ูุชุทููุฑ: ูุงุถู ุงูุฑูุณ</a>
        </footer>
      </div>
    </div>
  </section>
</main>

<!-- ุฅุดุนุงุฑ -->
<div id="notice" class="notice" style="display:none">
  <div class="dot"></div>
  <div class="text">โ</div>
  <button class="close" title="ุฅุบูุงู" aria-label="ุฅุบูุงู">ร</button>
</div>

<!-- PDF -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>

<script>
/* ุฅุดุนุงุฑ ุฃููู */
const notice=document.getElementById('notice'), noticeText=notice.querySelector('.text');
notice.querySelector('.close').onclick=()=>{ notice.classList.remove('show'); setTimeout(()=>notice.style.display='none',250); };
function notify(msg,{type='info',timeout=3500}={}){ notice.style.display='flex'; notice.classList.toggle('error', type==='error'); noticeText.innerHTML=msg; requestAnimationFrame(()=>notice.classList.add('show')); clearTimeout(window.__nt); window.__nt=setTimeout(()=>{ notice.classList.remove('show'); setTimeout(()=>notice.style.display='none',250); }, timeout); }

/* ุฃุฒุฑุงุฑ ุงูุชุจุฏูู */
function makeToggle(segId, dataKey){
  const seg=document.getElementById(segId);
  seg.addEventListener('click', e=>{
    const b=e.target.closest('button'); if(!b) return;
    seg.querySelectorAll('button').forEach(x=>x.classList.remove('on'));
    b.classList.add('on');
    seg.dataset[dataKey]=Object.values(b.dataset)[0];
  });
}
makeToggle('sexSeg','sex'); makeToggle('smokeSeg','smoke'); makeToggle('familySeg','fh');

/* ููุงุฆู ุงูุฑูุงุจุท */
document.getElementById('refSelect').addEventListener('change', e=>{ const url=e.target.value; if(url){ window.open(url,'_blank','noopener'); e.target.value=''; }});
document.getElementById('srcSelect').addEventListener('change', e=>{ const url=e.target.value; if(url){ window.open(url,'_blank','noopener'); e.target.value=''; }});

/* ูุณุชุดูู ุนุงููู โ ุนุฑุถ ุฑูู ุงุชุตุงู ูุงุจู ููููุฑ */
const intlSelect=document.getElementById('intlSelect');
const intlContact=document.getElementById('intlContact');
intlSelect.addEventListener('change', ()=>{
  const opt = intlSelect.selectedOptions[0];
  if(!opt || !opt.value){ intlContact.style.display='none'; intlContact.innerHTML=''; return; }
  const phone = (opt.dataset.phone||'').replace(/\s+/g,'');
  const tel = phone ? `tel:${phone}` : '';
  const url = opt.value;
  const name = opt.textContent.split('โ')[0].trim();
  intlContact.innerHTML = `${phone ? `๐ <a href="${tel}"><strong>${opt.dataset.phone}</strong></a>`:'๐ โ'} &nbsp;โ&nbsp; <a href="${url}" target="_blank" rel="noopener">ุฒูุงุฑุฉ ูููุน ${name}</a>`;
  intlContact.style.display='block';
});

/* ูุดุงุฑูุฉ */
document.getElementById('shareWA').onclick=(e)=>{e.preventDefault(); window.open(`https://wa.me/?text=${encodeURIComponent(location.href)}`,'_blank','noopener');};
document.getElementById('shareTG').onclick=(e)=>{e.preventDefault(); window.open(`https://t.me/share/url?url=${encodeURIComponent(location.href)}`,'_blank','noopener');};
document.getElementById('shareX').onclick=(e)=>{e.preventDefault(); window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(location.href)}`,'_blank','noopener');};
document.getElementById('shareFB').onclick=(e)=>{e.preventDefault(); window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(location.href)}`,'_blank','noopener');};
document.getElementById('copyLink').onclick=async()=>{ try{ await navigator.clipboard.writeText(location.href); notify('๐ ุชูู ูุณุฎ ุฑุงุจุท ุงูุตูุญุฉ.'); }catch(_){ notify('ูู ูุชููู ูู ูุณุฎ ุงูุฑุงุจุท.',{type:'error'});} };

/* ุฎุฑูุทุฉ ูุณุชุดูู ูุญูู ููู ุฏููุฉ (ุงุณู + ูุงุชู + ูููุน) */
const COUNTRY_HOSPITALS={
  BHR:{n:"ูุฑูุฒ ุงูุณููุงููุฉ ุงูุทุจู โ ุงูุจุญุฑูู", phone:"+973-1728-8888", url:"https://www.moh.gov.bh/"},          // ูููู ุชุนุฏููู
  KSA:{n:"ูุฏููุฉ ุงูููู ููุฏ ุงูุทุจูุฉ (ุงูุฃูุฑุงู) โ ุงูุณุนูุฏูุฉ", phone:"+966-11-288-9999", url:"https://www.kfmc.med.sa/"}, // ุจุฏูู ููุซูู: KFSH
  ARE:{n:"ูููููุงูุฏ ููููู ุฃุจูุธุจู โ ุงูุฅูุงุฑุงุช", phone:"+971-2-659-0200", url:"https://www.clevelandclinicabudhabi.ae/"},
  QAT:{n:"ุงููุฑูุฒ ุงููุทูู ูุนูุงุฌ ูุฃุจุญุงุซ ุงูุณุฑุทุงู (NCCCR) โ ูุทุฑ", phone:"+974-4439-5777", url:"https://www.hamad.qa/"},
  KWT:{n:"ูุฑูุฒ ุงููููุช ูููุงูุญุฉ ุงูุณุฑุทุงู โ ุงููููุช", phone:"+965-2484-4040", url:"https://www.moh.gov.kw/"},
  OMN:{n:"ุงููุฑูุฒ ุงููุทูู ููุฃูุฑุงู โ ุงููุณุชุดูู ุงูุณูุทุงูู โ ุนููุงู", phone:"+968-2459-9000", url:"https://www.royalhospital.om/"},
  EGY:{n:"ุงููุนูุฏ ุงููููู ููุฃูุฑุงู โ ูุตุฑ", phone:"+20-2-2364-0831", url:"https://nci.cu.edu.eg/"},
  JOR:{n:"ูุฑูุฒ ุงูุญุณูู ููุณุฑุทุงู โ ุงูุฃุฑุฏู", phone:"+962-6-530-0460", url:"https://www.khcc.jo/"},
  LBN:{n:"ูุฑูุฒ ูุงูู ุจุงุณูู ููุณุฑุทุงู (AUBMC) โ ูุจูุงู", phone:"+961-1-350000", url:"https://www.aubmc.org.lb/"},
  IRQ:{n:"ูุฑูุฒ ุงูุฃูู ููุฃูุฑุงู โ ุงูุนุฑุงู", phone:"+964-770-000-0000", url:"https://moh.gov.iq/"},  // ุถุน ุฑูู ุฃุฏู ุนูุฏ ุชููุฑู
  LBA:{n:"ุงููุฑูุฒ ุงููุทูู ูุนูุงุฌ ุงูุฃูุฑุงู โ ููุจูุง", phone:"+218-21-000-0000", url:"http://seha.ly/"}, // ุชุญุฏูุซ ูุงุญููุง
  MAR:{n:"ุงููุนูุฏ ุงููุทูู ููุฃูููููุฌูุง โ ุงูุฑุจุงุทุ ุงููุบุฑุจ", phone:"+212-537-771-700", url:"https://www.sante.gov.ma/"},
  DZA:{n:"ูุฑูุฒ ุจูุงุฑ ููุงุฑู ููุฑู ูููุงูุญุฉ ุงูุณุฑุทุงู โ ุงูุฌุฒุงุฆุฑ", phone:"+213-21-239-000", url:"http://www.chu-beni-messous.dz/"}, // ูุงุจู ููุชุญุฏูุซ
  TUN:{n:"ูุนูุฏ ุตุงูุญ ุนุฒููุฒ ููุฃูุฑุงู โ ุชููุณ", phone:"+216-71-783-022", url:"http://www.isa.rns.tn/"},
  SDN:{n:"ูุณุชุดูู ุงูุฐุฑุฉ โ ุงูุฎุฑุทููุ ุงูุณูุฏุงู", phone:"+249-183-000-000", url:"https://fmoh.gov.sd/"}, // ุชุญุฏูุซ ูุงุญููุง
  SYR:{n:"ุงููุดูู ุงูุฌุงูุนู โ ุฏูุดู (ูุณู ุงูุฃูุฑุงู) โ ุณูุฑูุง", phone:"+963-11-000-0000", url:"http://moh.gov.sy/"}, // ุชุญุฏูุซ ูุงุญููุง
  PSE:{n:"ูุฑูุฒ ุฎุงูุฏ ุงูุญุณู ููุณุฑุทุงู โ ููุณุทูู", phone:"+970-2-000-0000", url:"https://www.moh.ps/"},
  DJI:{n:"ูุณุชุดูู ุจููุชููู โ ุฌูุจูุชู (ุฃูุฑุงู)", phone:"+253-21-35-00-00", url:"https://www.sante.gouv.dj/"},
  COM:{n:"ุงููุณุชุดูู ุงููุทูู โ ููุฑูููุ ุฌุฒุฑ ุงูููุฑ", phone:"+269-321-0000", url:""},
  MRT:{n:"ุงููุณุชุดูู ุงููุทูู โ ููุงูุดูุทุ ููุฑูุชุงููุง (ุฃูุฑุงู)", phone:"+222-45-00-00-00", url:""},
  SOM:{n:"ูุณุชุดูู ูุฏูุฌู โ ููุฏูุดู (ุฃูุฑุงู)", phone:"+252-61-000-0000", url:""},
  YEM:{n:"ุงููุฑูุฒ ุงููุทูู ูุนูุงุฌ ุงูุฃูุฑุงู โ ุงูููู", phone:"+967-1-000-000", url:""},
  IRN:{n:"ูุนูุฏ ุฑููุงู/ูุฑูุฒ ุงูุณุฑุทุงู โ ุฅูุฑุงู (ูุซุงู)", phone:"+98-21-0000-0000", url:"https://www.iranmed.ir/"} // ุงุณุชุจุฏูู ุจุงููุฑูุฒ ุงูููุถู ูุฏูู
};

/* ุชูููู ุงููุฎุงุทุฑ */
const QUESTIONS_IDS = ["cough","lump","bleed","skin","bowel","pain","gi","bsy","nodes","breast","prostate","ulcer"];
function isYes(id){ return document.querySelector(`.seg[data-q="${id}"] .on`)?.dataset.a==='yes'; }
function screening(age, sex, smoker, fh){
  const list=[];
  if(sex==='female' && age>=40) list.push("ุชุตููุฑ ุงูุซุฏู (ูุงููุบุฑุงู) ูู 1โ2 ุณูุฉ.");
  if(sex==='female' && age>=21) list.push("ุนูู ุงูุฑุญู: Pap/HPV ุญุณุจ ุงูุฌุฏููุฉ (ูู 3โ5 ุณููุงุช).");
  if(age>=45) list.push("ุงูููููู ูุงููุณุชููู: FIT ุณููููุง ุฃู ุชูุธูุฑ ูู 10 ุณููุงุช.");
  if(age>=50 && smoker==='yes') list.push("ุงูุฑุฆุฉ: LDCT ุณููููุง ูููุฏุฎููู ุงููุคูููู.");
  if(sex==='male' && age>=50) list.push("ุงูุจุฑูุณุชุงุชุง: ูุงูุด PSA/ูุญุต ุงููุณุชููู.");
  if(fh==='yes') list.push("ูุชุงุฑูุฎ ุนุงุฆูู ููู: ุงุณุชุดุฑ ุงุฎุชุตุงุตู ูุฑุงุซุฉ/ุฃูุฑุงู.");
  return list;
}
function computeRisk(){
  let score=0, flags=0;
  const heavy=['bleed','lump','skin','ulcer'];
  QUESTIONS_IDS.forEach(id=>{
    const seg=document.querySelector(`.seg[data-q="${id}"]`);
    const a=seg.querySelector('button.on')?.dataset.a||'no';
    if(a==='yes'){ score+=1; if(heavy.includes(id)){ score+=1; flags+=1; } }
  });
  if((document.getElementById('smokeSeg').dataset.smoke||'no')==='yes') score+=1;
  if((document.getElementById('familySeg').dataset.fh||'no')==='yes') score+=1;
  if(score>10) score=10;

  let levelTxt='ุขููุฉ (ุฎุถุฑุงุก)', levelClass='ok', action='ุฑุงูุจ ุงูุฃุนุฑุงุถ ูุงุชูุจุน ุฌุฏูู ุงูุชุญุฑู ุงูููุงุณุจ.';
  if(score>=3){ levelTxt='ูุชูุณุทุฉ (ุตูุฑุงุก)'; levelClass='warn'; action='ุงุญุฌุฒ ููุนุฏูุง ูุฏู ุทุจูุจ ุงูุฃุณุฑุฉ ุฎูุงู 1โ2 ุฃุณุจูุน.'; }
  if(score>=6 || (isYes('bleed') && isYes('pain'))){ levelTxt='ูุฑุชูุนุฉ (ุญูุฑุงุก)'; levelClass='danger'; action='ุชูููู ุนุงุฌู ุฎูุงู 24โ72 ุณุงุนุฉ ุฃู ุฃูุฑุจ ุทูุงุฑุฆ ุฅุฐุง ุณุงุกุช ุงูุญุงูุฉ.'; }
  if(isYes('cough') && isYes('bsy')){ levelTxt='ูุฑุชูุนุฉ (ุญูุฑุงุก)'; levelClass='danger'; action='ุชูููู ุตุฏุฑู ุนุงุฌู (ูุฏ ููุฒู ุชุตููุฑ/ุชุญุงููู).'; }
  return {score, flags, levelTxt, levelClass, action};
}

/* ูุตุงุฆุญ */
function buildAdvice(age, sex, smoke, fh){
  const deck=document.getElementById('adviceDeck'); deck.innerHTML='';
  const mk=(t,html)=>{ const e=document.createElement('div'); e.className='card'; e.innerHTML=`<h3>${t}</h3>${html}`; return e; };
  const list=screening(age, sex, smoke, fh);
  deck.append(
    mk('ูุตุงุฆุญ ุณุฑูุนุฉ','<ul><li>ุฃู ุนุฑุถ ุฌุฏูุฏ ูุณุชูุฑ &gt; 3 ุฃุณุงุจูุน = ุชูููู ุทุจู.</li><li>ุงูุชูุน ุนู ุงูุชุจุบุ ุชุญุฑูู 150โ300 ุฏูููุฉ ุฃุณุจูุนููุงุ ูุญุงูุธ ุนูู ูุฒู ุตุญู.</li><li>ุงุณุชุนูู ุงููุงูู ุงูุดูุณู ูุชูููู ููุงุญ HPV/ุงูุชูุงุจ ุงููุจุฏ B ุญูุซ ูุชุงุญ.</li></ul>'),
    mk('ูุญูุต ุงูุชุญุฑู ุงูููุชุฑุญุฉ', list.length? '<ul>'+list.map(x=>`<li>${x}</li>`).join('')+'</ul>' : '<div>ูุง ุชูุฌุฏ ูุญูุต ุฑูุชูููุฉ ุฎุงุตูุฉ ุจุนูุฑู ุงูุขู โ ุงุชุจุน ูุตูุญุฉ ุทุจูุจู.</div>')
  );
  deck.style.display='grid';
}

/* ุงุญุณุจ ุงููุชูุฌุฉ */
let lastResult=null;
document.getElementById('calc').addEventListener('click', ()=>{
  const age=parseFloat(document.getElementById('age').value);
  if(!(age>=0 && age<=120)){ notify("ุฃุฏุฎู ุนูุฑูุง ุตุญูุญูุง.", {type:'error'}); return; }
  const sex = document.getElementById('sexSeg').dataset.sex || 'male';
  const smoke = document.getElementById('smokeSeg').dataset.smoke || 'no';
  const fh = document.getElementById('familySeg').dataset.fh || 'no';

  const {score, flags, levelTxt, levelClass, action}=computeRisk();

  const v=document.getElementById('verdict');
  v.style.display='inline-block';
  v.className='badge '+levelClass;
  v.textContent = (levelClass==='danger'?'โ๏ธ ':'โน๏ธ ')+ `ุญุงูุฉ ุงูุชุดุฎูุต: ${levelTxt} โ ${action}`;

  document.getElementById('kpis').style.display='grid';
  document.getElementById('riskLevel').textContent=levelTxt;
  document.getElementById('whatNext').textContent=action;

  buildAdvice(age, sex, smoke, fh);

  /* ูุณุชุดูู ูุญูู ุญุณุจ ุงูุฏููุฉ */
  const ccode=document.getElementById('countrySelect').value;
  const loc=COUNTRY_HOSPITALS[ccode];
  const localBox=document.getElementById('localBox');
  const localContact=document.getElementById('localContact');
  if(loc){
    const telHref = loc.phone ? `tel:${loc.phone.replace(/\s+/g,'')}` : '';
    localContact.innerHTML = `
      ๐ฅ <strong>${loc.n}</strong><br>
      ${loc.phone ? `๐ <a href="${telHref}"><strong>${loc.phone}</strong></a>` : '๐ โ'}
      &nbsp;โ&nbsp;
      ${loc.url ? `<a href="${loc.url}" target="_blank" rel="noopener">ุงููููุน ุงูุฑุณูู</a>` : ''}
    `;
    localBox.style.display='block';
  }else{
    localBox.style.display='none';
    localContact.innerHTML='';
  }

  /* ุฅู ูุงู ููุงู ูุณุชุดูู ุนุงููู ูุฎุชุงุฑุ ุฃุธูุฑ ุชูุงุตููู */
  const sel=document.getElementById('intlSelect');
  if(sel.value){
    const opt=sel.selectedOptions[0];
    const phone=opt.dataset.phone||'';
    const tel=phone?`tel:${phone.replace(/\s+/g,'')}`:'';
    const url=sel.value;
    const name=opt.textContent.split('โ')[0].trim();
    intlContact.innerHTML=`${phone?`๐ <a href="${tel}"><strong>${phone}</strong></a>`:'๐ โ'} &nbsp;โ&nbsp; <a href="${url}" target="_blank" rel="noopener">ุฒูุงุฑุฉ ูููุน ${name}</a>`;
    intlContact.style.display='block';
  }

  /* ุญูุธ ููู PDF */
  lastResult = {
    country: document.querySelector('#countrySelect option:checked').textContent,
    age, sex:(sex==='male'?'ุฑุฌู':'ุงูุฑุฃุฉ'),
    smoke:(smoke==='yes'?'ูุฏุฎูู':'ุบูุฑ ูุฏุฎูู'),
    fh:(fh==='yes'?'ุชุงุฑูุฎ ุนุงุฆูู ููู':'ูุง'),
    score, flags, level:levelTxt, action,
    local: loc ? {n:loc.n, phone:loc.phone||'', url:loc.url||''} : null,
    intl: sel.value ? {n: sel.selectedOptions[0].textContent, phone: sel.selectedOptions[0].dataset.phone||'', url: sel.value} : null,
    answers: QUESTIONS_IDS.map(id=>{
      const label=document.querySelector(`.seg[data-q="${id}"]`).previousElementSibling.textContent.trim();
      const a=document.querySelector(`.seg[data-q="${id}"] .on`)?.dataset.a||'no';
      return {q:label, a:(a==='yes'?'ูุนู':'ูุง')};
    })
  };

  document.getElementById('pdfwrap').style.display='block';
});

/* PDF */
document.getElementById('pdfBtn').addEventListener('click', async ()=>{
  if(!lastResult){ notify('ุฃุฌุจ ุนู ุงูุงุณุชุจูุงู ุฃูููุง.', {type:'error'}); return; }
  const box=document.createElement('div');
  box.setAttribute('dir','rtl');
  box.style.width='780px'; box.style.background='#fff'; box.style.border='1px solid #e5e7eb'; box.style.borderRadius='16px'; box.style.padding='20px'; box.style.fontFamily='"Cairo",sans-serif'; box.style.color='#111827';

  function row(k,v){ return `<tr><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6"><strong>${k}</strong></td><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6">${v}</td></tr>`; }
  const rowsAns = lastResult.answers.map(x=>`<tr><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6">${x.q}</td><td style="padding:8px 10px;border-bottom:1px solid #f3f4f6">${x.a}</td></tr>`).join('');

  const localRows = lastResult.local ? `
    ${row('ูุณุชุดูู ุจูุฏู', lastResult.local.n)}
    ${row('ูุงุชู ุงููุณุชุดูู', lastResult.local.phone || 'โ')}
    ${row('ุงููููุน', lastResult.local.url ? `<a href='${lastResult.local.url}' target='_blank' rel='noopener'>ุฑุงุจุท ุงููููุน</a>` : 'โ')}
  ` : '';

  const intlRows = lastResult.intl ? `
    ${row('ูุณุชุดูู ุนุงููู ูุฎุชุงุฑ', lastResult.intl.n)}
    ${row('ูุงุชู ุงููุณุชุดูู', lastResult.intl.phone || 'โ')}
    ${row('ุงููููุน', lastResult.intl.url ? `<a href='${lastResult.intl.url}' target='_blank' rel='noopener'>ุฑุงุจุท ุงููููุน</a>` : 'โ')}
  ` : '';

  box.innerHTML=`
    <div style="text-align:center; margin-bottom:10px">
      <div style="font-family:'Amiri',serif; font-size:26px; color:${getComputedStyle(document.documentElement).getPropertyValue('--gold')}">ุชูุฑูุฑ ุงุณุชุจูุงู ุฃุนุฑุงุถ ุงูุณุฑุทุงู</div>
      <div style="font-size:12px; color:#6b7280">${new Date().toLocaleString('ar')}</div>
    </div>

    <table style="width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid #eee; margin-bottom:10px">
      <thead><tr style="background:linear-gradient(90deg,#fff7e6,#fff)"><th style="padding:10px 12px; text-align:right">ุงูุจูุฏ</th><th style="padding:10px 12px; text-align:right">ุงููููุฉ</th></tr></thead>
      <tbody>
        ${row('ุงูุฏููุฉ', lastResult.country)}
        ${row('ุงูุนูุฑ', lastResult.age)}
        ${row('ุงูููุน', lastResult.sex)}
        ${row('ุงูุชุฏุฎูู', lastResult.smoke)}
        ${row('ุชุงุฑูุฎ ุนุงุฆูู', lastResult.fh)}
        ${row('ุนุฏุฏ ุงูุฃุนูุงู ุงูุญูุฑุงุก', lastResult.flags)}
        ${row('ุฏุฑุฌุฉ ุชูุฏูุฑูุฉ (0โ10)', lastResult.score)}
        ${row('ุญุงูุฉ ุงูุชุดุฎูุต', lastResult.level)}
        ${row('ุงูุชูุตูุฉ ุงูุขู', lastResult.action)}
        ${localRows}
        ${intlRows}
      </tbody>
    </table>

    <div style="font-weight:700; margin-bottom:6px">ุฅุฌุงุจุงุช ุงูุฃุนุฑุงุถ</div>
    <table style="width:100%; border:1px solid #eee; border-radius:12px; border-collapse:separate; border-spacing:0">
      <thead><tr style="background:#f9fafb"><th style="padding:8px 10px; text-align:right">ุงูุนูุฑูุถ</th><th style="padding:8px 10px; text-align:right">ุงูุฅุฌุงุจุฉ</th></tr></thead>
      <tbody>${rowsAns}</tbody>
    </table>

    <div style="margin-top:10px; font-size:12px; color:#6b7280">ูุฐู ูุชูุฌุฉ ุชุซููููุฉ ุนุงูุฉ. ุฃุฑูุงู ุงูุงุชุตุงู ูุฏ ุชุชุบููุฑุ ูููุถููู ุงูุชุฃููุฏ ูู ุงููููุน ุงูุฑุณูู.</div>
  `;

  document.body.appendChild(box);
  await new Promise(r=>setTimeout(r, 120));
  const canvas = await html2canvas(box, {scale:2, useCORS:true});
  document.body.removeChild(box);

  const imgData = canvas.toDataURL('image/png');
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF({orientation:'p', unit:'pt', format:'a4'});
  const pageW = pdf.internal.pageSize.getWidth();
  const pageH = pdf.internal.pageSize.getHeight();
  const margin = 28;
  const imgW = pageW - margin*2;
  const imgH = canvas.height * (imgW / canvas.width);

  if(imgH <= pageH - margin*2){
    pdf.addImage(imgData, 'PNG', margin, margin, imgW, imgH);
  }else{
    let sH = pageH - margin*2, ratio = canvas.width / imgW, slice = sH * ratio, pos = 0;
    while(pos < canvas.height){
      const sliceCanvas = document.createElement('canvas');
      sliceCanvas.width = canvas.width;
      sliceCanvas.height = Math.min(slice, canvas.height - pos);
      sliceCanvas.getContext('2d').drawImage(canvas, 0, pos, canvas.width, sliceCanvas.height, 0, 0, sliceCanvas.width, sliceCanvas.height);
      const sliceData = sliceCanvas.toDataURL('image/png');
      if(pos>0) pdf.addPage();
      pdf.addImage(sliceData,'PNG', margin, margin, imgW, (sliceCanvas.height / ratio));
      pos += slice;
    }
  }
  pdf.save('ูุชูุฌุฉ-ุงุณุชุจูุงู-ุงูุณุฑุทุงู.pdf');
});

/* ุชุจุฏูู ูุนู/ูุง ููุฃุณุฆูุฉ */
document.getElementById('symptoms').addEventListener('click', e=>{
  const btn=e.target.closest('button'); if(!btn) return;
  const seg=btn.parentElement;
  seg.querySelectorAll('button').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
});

/* ุฑุงุจุท ุงููุทููุฑ */
document.getElementById('devLink').addEventListener('click', function(){ setTimeout(()=>{ if(!document.hasFocus()) return; location.href=this.href; }, 120); });
</script>
</body>
</html>
