<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>مناسك الحج وفق رأي السيد القائد دامت بركاته</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700&display=swap" rel="stylesheet">
<style>
  body{margin:0;font-family:'Cairo',system-ui;background:#fff;color:#222;}
  header{
    background:linear-gradient(135deg,#f9f4e7,#e3c179,#c9a144);
    color:#4b2e05;text-align:center;padding:18px;font-weight:700;font-size:1.2rem;
    border-bottom:2px solid #c9a144;
  }
  .container{max-width:600px;margin:30px auto;padding:20px}
  label{display:block;font-weight:700;margin-bottom:6px}
  input,textarea{
    width:100%;padding:14px;border:1px solid #d1c6aa;border-radius:12px;
    font-size:1rem;outline:none;font-family:'Cairo';
  }
  input:focus,textarea:focus{border-color:#c9a144;box-shadow:0 0 4px #c9a14455;}
  button{
    margin-top:12px;background:linear-gradient(135deg,#e3c179,#c9a144);
    border:none;color:#fff;font-weight:700;padding:12px 20px;border-radius:12px;
    cursor:pointer;font-size:1rem;font-family:'Cairo';
  }
  button:hover{background:linear-gradient(135deg,#c9a144,#b5892c);}
  .answer-box{
    margin-top:20px;padding:14px;border:1px solid #e7dec0;border-radius:12px;
    background:#fffaf1;min-height:80px;line-height:1.8
  }
  .ref{margin-top:10px;font-size:.9rem;color:#6b5d3a}
  mark{background:#fff0c2;padding:0 .2em;border-radius:.25em}
</style>
</head>
<body>
  <header>مناسك الحج وفق رأي السيد القائد دامت بركاته</header>
  <div class="container">
    <form id="form">
      <label for="q">السؤال:</label>
      <input id="q" type="text" placeholder="اكتب سؤالك هنا…">
      <button type="submit">إرسال</button>
    </form>
    <div class="answer-box" id="ans">الجواب سيظهر هنا…</div>
  </div>

<script id="KB" type="application/json">[
  {"qid":"M001","question":"ما شروط وجوب حجة الإسلام؟","answer":"تجب مرة واحدة على العاقل البالغ المستطيع، وهي فورية بعد تحقق الاستطاعة.","ref":"مسألة 23"},
  {"qid":"M002","question":"ما حكم ترك الحج مع الاستطاعة؟","answer":"ترك الحج مع تحقق الشروط ومع العلم بالوجوب من الكبائر، والحج فوري بعد حصول الاستطاعة.","ref":"مسألة 1"},
  {"qid":"M003","question":"أعمال عمرة التمتع؟","answer":"الإحرام من الميقات → الطواف → صلاة الطواف → السعي بين الصفا والمروة → التقصير.","ref":"مسألة 13"},
  {"qid":"M004","question":"أعمال حج التمتع؟","answer":"الإحرام من مكة → الوقوف بعرفات → الوقوف بالمشعر → رمي جمرة العقبة → الهدي → الحلق/التقصير → طواف الحج وصلاته → السعي → طواف النساء وصلاته → المبيت بمنى ورمي الجمار.","ref":"مسألة 15"},
  {"qid":"M005","question":"حكم التظليل للمحرم؟","answer":"يحرم على الرجل حال السير نهارًا أن يظلّل نفسه بسقف ونحوه، وللتفصيل حالات خاصة في الليل والوقوف.","ref":"مسألة 168"},
  {"qid":"M006","question":"طواف النساء وحكمه؟","answer":"واجب، ولا تحل النساء بدونه. من رجع إلى بلده يلزمه العود أو الاستنابة عند التعذر.","ref":"مسألة 230"}
]</script>

<script>
  const KB = JSON.parse(document.getElementById('KB').textContent||'[]');

  function norm(s){return (s||'').toLowerCase()
    .replace(/[\u064B-\u065F]/g,'').replace(/[\s]+/g,' ').trim();}

  function tokens(s){return norm(s).split(/[^\u0600-\u06FFa-z0-9]+/).filter(Boolean)}

  // بناء فهرس بسيط
  const INV=new Map();
  KB.forEach((e,i)=>{
    tokens(e.question+' '+e.answer).forEach(t=>{
      if(!INV.has(t)) INV.set(t,new Set());
      INV.get(t).add(i);
    });
  });

  function search(q){
    const qs=tokens(q); const score=new Map();
    qs.forEach(t=>{(INV.get(t)||[]).forEach(i=>score.set(i,(score.get(i)||0)+1));});
    let res=[...score.entries()].sort((a,b)=>b[1]-a[1]);
    if(!res.length) return null;
    return KB[res[0][0]];
  }

  const form=document.getElementById('form');
  const ans=document.getElementById('ans');
  form.addEventListener('submit',e=>{
    e.preventDefault();
    const q=document.getElementById('q').value.trim();
    if(!q) return;
    const r=search(q);
    if(!r){
      ans.innerHTML=`لم أعثر على مسألة مطابقة.`;
    }else{
      ans.innerHTML=`<b>الجواب:</b><br>${r.answer}<div class="ref">مرجع: ${r.ref} — المصدر: كتيّب أحكام الحج (leader.ir)</div>`;
    }
  });
</script>
</body>
</html>
