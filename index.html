<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>حِساب التكليف الشرعي — واجبات المكلّف</title>
<meta name="description" content="أدخل تاريخ ميلادك الميلادي لمعرفة بلوغ سن التكليف الشرعي وعرض الواجبات المترتبة بشكل موجز وأنيق.">
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#0a0e16;         /* خلفية داكنة فخمة */
    --ink:#111827;        /* نص غامق داخلي */
    --muted:#94a3b8;      /* نص خافت */
    --card:#0f1422;       /* ألواح زجاجية داكنة */
    --glass:rgba(255,255,255,.06);
    --line:rgba(255,255,255,.12);
    --gold:#d4af37;       /* ذهبي */
    --gold-soft:#f5e6b2;
    --emerald:#10b981;    /* للحالة الإيجابية */
    --crimson:#ef4444;    /* للحالة السلبية */
    --accent:#1fb2a6;     /* لمسات */
    --radius:22px;
    --pad:18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:#e5e7eb; background:
      radial-gradient(1200px 700px at 120% -10%, rgba(212,175,55,.16), transparent 60%),
      radial-gradient(1200px 700px at -20% 110%, rgba(31,178,166,.14), transparent 60%),
      var(--bg);
    font-family:"Cairo", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  header{
    padding:36px 16px 16px; text-align:center; position:relative;
  }
  .brand{
    font-family:"Amiri", serif;
    font-size:clamp(26px,4.5vw,44px);
    color:var(--gold); letter-spacing:.5px;
    text-shadow:0 1px 0 #000, 0 8px 40px rgba(212,175,55,.25);
  }
  .tag{margin-top:6px; color:var(--gold-soft); font-size:14px}
  .shell{max-width:980px; margin:22px auto 40px; padding:0 16px}

  .hero{
    border:1px solid var(--line); border-radius:28px; padding:24px;
    background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    backdrop-filter: blur(8px);
    box-shadow:0 20px 60px rgba(0,0,0,.35);
  }
  .row{display:grid; gap:16px}
  @media(min-width:860px){ .row{grid-template-columns:1.2fr .8fr} }

  .field{
    display:flex; flex-direction:column; gap:8px;
    background:var(--card); border:1px solid var(--line);
    padding:var(--pad); border-radius:var(--radius)
  }
  label{font-size:14px; color:#cbd5e1}
  input[type="date"]{
    width:100%; background:transparent; color:#fff; border:none; outline:none;
    font-size:16px; padding:8px 6px; border-bottom:1px dashed rgba(255,255,255,.2)
  }
  .seg{
    display:flex; gap:8px; background:var(--card); border:1px solid var(--line);
    border-radius:999px; padding:6px
  }
  .seg button{
    flex:1; padding:10px 14px; border-radius:999px; border:1px solid transparent;
    background:transparent; color:#cbd5e1; cursor:pointer; font-size:14px
  }
  .seg button.on{background:var(--glass); border-color:var(--line); color:#fff}
  .cta{
    display:flex; gap:10px; align-items:center; justify-content:flex-end; margin-top:8px
  }
  .btn{
    all:unset; cursor:pointer; padding:12px 18px; border-radius:14px;
    border:1px solid var(--gold); color:#0a0e16; background:linear-gradient(90deg, #d4af37, #f5d574);
    font-weight:700; box-shadow:0 10px 30px rgba(212,175,55,.25)
  }

  .result{
    margin-top:18px; display:grid; gap:16px
  }
  .badge{
    display:inline-flex; align-items:center; gap:10px; padding:14px 16px; border-radius:14px;
    border:1px solid var(--line); background:var(--glass); backdrop-filter: blur(6px); font-size:15px
  }
  .ok{border-color:rgba(16,185,129,.3); box-shadow:0 10px 30px rgba(16,185,129,.15)}
  .no{border-color:rgba(239,68,68,.35); box-shadow:0 10px 30px rgba(239,68,68,.1)}
  .kpi{
    display:grid; gap:12px; grid-template-columns:repeat(2,1fr)
  }
  @media(min-width:860px){ .kpi{grid-template-columns:repeat(4,1fr)} }
  .k{background:var(--card); border:1px solid var(--line); border-radius:16px; padding:14px; text-align:center}
  .k .v{font-size:20px; font-weight:800; color:#fff}
  .k .t{font-size:12px; color:var(--muted)}

  .deck{
    display:grid; gap:16px; grid-template-columns:1fr
  }
  @media(min-width:860px){ .deck{grid-template-columns:repeat(3,1fr)} }
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid var(--line); border-radius:20px; padding:18px;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
    min-height:148px;
  }
  .card h3{
    margin:0 0 8px; font-family:"Amiri", serif; color:var(--gold); font-size:20px; letter-spacing:.3px
  }
  .card p{margin:0; color:#d1d5db; line-height:1.7; font-size:14px}
  .sep{height:1px; background:var(--line); margin:12px 0}
  .muted{color:var(--muted); font-size:12px}
  footer{margin:40px 0 24px; text-align:center; color:#9aa3b2; font-size:12px}
</style>
</head>
<body>
<header>
  <div class="brand">حِساب التكليف الشرعي</div>
  <div class="tag">أدخل تاريخ الميلاد الميلادي، واختر الجنس، وسيظهر الحكم والأحكام المترتبة بأناقة.</div>
</header>

<main class="shell">
  <section class="hero">
    <div class="row">
      <!-- المدخلات -->
      <div>
        <div class="field" aria-label="تاريخ الميلاد">
          <label>تاريخ الميلاد (ميلادي)</label>
          <input type="date" id="dob" />
          <span class="muted">يُحوَّل تلقائيًا إلى عُمر قمري للحساب الشرعي.</span>
        </div>

        <div class="field" style="margin-top:12px" aria-label="اختيار الجنس">
          <label>الجنس</label>
          <div class="seg" id="gender">
            <button type="button" class="on" data-g="girl">فتاة</button>
            <button type="button" data-g="boy">صبي</button>
          </div>
        </div>

        <div class="cta">
          <button class="btn" id="calc">احسب الحكم</button>
        </div>
      </div>

      <!-- النتائج -->
      <div>
        <div id="verdict" class="badge" style="display:none"></div>
        <div id="kpis" class="kpi" style="display:none">
          <div class="k"><div class="v" id="solarY">—</div><div class="t">العمر الشمسي (سنوات)</div></div>
          <div class="k"><div class="v" id="hijriY">—</div><div class="t">العمر القمري (سنوات)</div></div>
          <div class="k"><div class="v" id="threshold">—</div><div class="t">سنّ التكليف القمري</div></div>
          <div class="k"><div class="v" id="status">—</div><div class="t">الحالة اليوم</div></div>
        </div>
      </div>
    </div>

    <div id="rules" class="deck" style="display:none; margin-top:18px">
      <!-- تُملأ آليًا وفق الجنس والحالة -->
    </div>

    <div id="note" class="muted" style="display:none; margin-top:10px">
      * الحساب القمري تقريبي باليوم (354.367 يومًا للسنة القمرية). العلامات الجسدية قد تؤثّر في الحكم.
    </div>
  </section>

  <footer>© واجهة مُصمّمة بعناية — أنيقة، مبسّطة، وقابلة للتطوير.</footer>
</main>

<script>
  // ثوابت التحويل
  const SOLAR_YEAR = 365.2425;     // متوسط طول السنة الشمسية
  const LUNAR_YEAR = 354.367;      // متوسط طول السنة القمرية

  // عناصر DOM
  const dobEl = document.getElementById('dob');
  const genderSeg = document.getElementById('gender');
  const calcBtn = document.getElementById('calc');
  const verdict = document.getElementById('verdict');
  const kpis = document.getElementById('kpis');
  const rulesDeck = document.getElementById('rules');
  const note = document.getElementById('note');

  let gender = 'girl';

  // تبديل الجنس
  genderSeg.querySelectorAll('button').forEach(b=>{
    b.addEventListener('click', ()=>{
      genderSeg.querySelectorAll('button').forEach(x=>x.classList.remove('on'));
      b.classList.add('on');
      gender = b.dataset.g;
    });
  });

  // أدوات مساعدة للتواريخ (حساب فرق الأيام بدقّة UTC)
  function toUTC(date){
    return new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
  }
  function daysBetweenUTC(a, b){
    const ms = toUTC(b).getTime() - toUTC(a).getTime();
    return ms / (1000*60*60*24);
  }

  // بناء بطاقة حكم أنيقة
  function makeCard(title, body){
    const el = document.createElement('div');
    el.className = 'card';
    el.innerHTML = `<h3>${title}</h3><div class="sep"></div><p>${body}</p>`;
    return el;
  }

  // توليد مجموعة الأحكام حسب الجنس والحالة
  function buildRules(isMukallaf){
    rulesDeck.innerHTML = '';
    if(!isMukallaf){
      rulesDeck.append(
        makeCard('تنبيه',
          'لم يبلغ سنّ التكليف القمري بعد. يُستحسن التعلّم المبدئي لأحكام الطهارة والصلاة تمهيدًا للالتزام فور البلوغ.')
      );
      rulesDeck.style.display = 'grid';
      note.style.display = 'block';
      return;
    }

    // مشتركة
    const salat = makeCard('الصلاة (واجب)',
      'خمس صلوات يوميًا مع شروطها: الطهارة، الوقت، القبلة، والستر. تُراعى الأذكار والهيئة المعتبرة.');
    const siyam = makeCard('الصيام (واجب)',
      'صوم شهر رمضان من الفجر إلى المغرب مع النية واجتناب المفطرات. أحكام العذر (المرض، السفر، ونحوه) لها تفاصيلها.');
    const tahara = makeCard('الطهارة (شرط للصلاة)',
      'الوضوء أو الغسل بحسب الحال، مع التحقق من طهارة البدن والثوب ومحل السجود.');
    const taqlid = makeCard('التقليد (واجب)',
      'العمل وفق فتوى المرجع الأعلم في العبادات والمعاملات.');
    const khums = makeCard('الخمس (واجب عند تحقق سببه)',
      'يحسب في فاضل المؤونة ونحوها بنهاية السنة الخُمسية وفق التفصيل المعروف.');

    // خصوصي بالفتاة
    const hijab = makeCard('الحجاب (واجب)',
      'الالتزام بستر البدن على نحوٍ لا يصف البشرة، مع مراعاة حدود النظر والزينة وضوابط العفّة.');

    // ترتيب العرض فخم ومتوازن
    if(gender==='girl'){
      rulesDeck.append(salat, siyam, hijab, tahara, taqlid, khums);
    } else {
      rulesDeck.append(salat, siyam, tahara, taqlid, khums);
    }
    rulesDeck.style.display = 'grid';
    note.style.display = 'block';
  }

  // الإجراء الرئيسي
  calcBtn.addEventListener('click', ()=>{
    const dobStr = dobEl.value;
    if(!dobStr){ alert('فضلًا أدخل تاريخ الميلاد الميلادي.'); return; }

    const dob = new Date(dobStr + 'T00:00:00');
    const today = new Date();
    if(dob > today){ alert('تاريخ الميلاد لا يمكن أن يكون في المستقبل.'); return; }

    const days = daysBetweenUTC(dob, today);
    const solarYears = days / SOLAR_YEAR;
    const hijriYears = days / LUNAR_YEAR;

    const threshold = (gender==='girl') ? 9 : 15;
    const isMukallaf = hijriYears >= threshold;

    // شارة الحكم
    verdict.style.display = 'inline-flex';
    verdict.className = 'badge ' + (isMukallaf ? 'ok' : 'no');
    verdict.innerHTML = isMukallaf
      ? `✅ تمّ بلوغ سنّ التكليف الشرعي.`
      : `⏳ لم يبلغ سنّ التكليف الشرعي بعد.`;

    // المقاييس
    kpis.style.display = 'grid';
    document.getElementById('solarY').textContent = (Math.floor(solarYears*10)/10).toFixed(1);
    document.getElementById('hijriY').textContent = (Math.floor(hijriYears*10)/10).toFixed(1);
    document.getElementById('threshold').textContent = threshold.toString();
    document.getElementById('status').textContent = isMukallaf ? 'مكلّف' : 'غير مكلّف';

    // الأحكام
    buildRules(isMukallaf);
    // تمرير للجزء العلوي قليلًا لإبراز النتيجة على الهاتف
    setTimeout(()=>window.scrollTo({top:document.querySelector('.hero').offsetTop-12, behavior:'smooth'}), 50);
  });

  // افتراضيًا: يعرض اليوم في متصفح المستخدم
  (function preset(){
    // لا نضبط التاريخ تلقائيًا كي يضعه المستخدم بوضوح
  })();
</script>
</body>
</html>
