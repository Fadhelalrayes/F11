<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<title>الخسوف والكسوف – التواريخ المحلية والأحكام | تقاويم فلكية دقيقة</title>
<meta name="description" content="جدول خسوف القمر وكسوف الشمس بحسب منطقتك الزمنية مع العدّ التنازلي للحدث القادم، بداية وأعظم ونهاية (ساعات ودقائق)، أحكام صلاة الآيات المختصرة، وروابط لمصادر فلكية معتمدة.">
<meta name="keywords" content="خسوف, كسوف, خسوف القمر, كسوف الشمس, صلاة الآيات, أوقات الخسوف, astronomy, eclipses, Bahrain">
<link rel="canonical" href="https://example.com/eclipses"/>

<!-- Open Graph / Twitter -->
<meta property="og:title" content="الخسوف والكسوف – التواريخ المحلية والأحكام">
<meta property="og:description" content="عدّ تنازلي للحدث القادم + بداية/أعظم/نهاية بالساعات والدقائق، مع أحكام صلاة الآيات، ومصادر فلكية معتمدة.">
<meta property="og:type" content="website">
<meta property="og:locale" content="ar_AR">
<meta name="twitter:card" content="summary_large_image">

<!-- Fonts (جديدة) -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700;800&family=IBM+Plex+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    /* لوحة ألوان جديدة (أخضر مختلف + ذهبي ناعم) */
    --ink:#0b2a1a;
    --muted:#64736a;
    --bg:#f8fbf7;
    --border:#e6eee6;
    --accent:#1b8b57;   /* أخضر رئيسي جديد */
    --gold:#d4af37;     /* ذهبي */
    --shadow:0 12px 28px rgba(11,42,26,.08);
    --box-grad:linear-gradient(135deg,#fbfff9 0%,#f6fff7 40%,#fffef7 100%);
    --chip-grad:linear-gradient(135deg,#f3fff7,#fffdf7);
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);padding:16px;
       font-family:"IBM Plex Sans Arabic",system-ui,-apple-system,"Segoe UI",Arial,"Cairo",sans-serif}

  .container{width:min(1100px,100%);margin:auto;display:flex;flex-direction:column;gap:16px}

  .topBar{display:flex;justify-content:space-between;align-items:center}
  .brand{font-family:"Cairo",sans-serif;font-weight:800;color:var(--gold);letter-spacing:.2px}
  .topClock{font-size:.95rem;font-weight:800;color:#0e4d2f}

  .hero{background:#fff;border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);padding:18px;text-align:center;background-image:var(--box-grad)}
  .hero h1{margin:0;font-family:"Cairo",sans-serif;font-size:1.6rem;color:#0a3b27}

  .locationBox{background:#fff;border:1px solid var(--border);border-radius:14px;box-shadow:var(--shadow);padding:12px 14px;display:flex;justify-content:space-between;align-items:center}
  .place{font-weight:800}
  .changeBtn{background:#f4fff7;border:1px solid var(--border);padding:6px 12px;border-radius:999px;font-weight:800;cursor:pointer}

  /* صندوق الحدث القادم (فاخر) */
  .nextBox{background:#fff;border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:16px;display:grid;gap:10px;position:relative;overflow:hidden}
  .nextBox:before{content:"";position:absolute;inset:-30% -30% auto auto;width:240px;height:240px;background:radial-gradient(closest-side,#e9fced,transparent 70%);transform:rotate(18deg)}
  .nextHdr{display:flex;justify-content:center;gap:8px;align-items:center}
  .chipGold{border:1px solid #eadcba;background:linear-gradient(135deg,#fff8de,#fff);color:#7a6318;padding:6px 12px;border-radius:999px;font-weight:900;font-size:.9rem}
  .nextTitle{font-weight:900;color:#0b3b2f;text-align:center}
  .nextRow{display:flex;justify-content:space-between;align-items:center;font-weight:800}
  .nextName{font-size:1.05rem}
  .nextAt{font-variant-numeric:tabular-nums}
  .countdown{display:flex;justify-content:center;gap:10px;font-weight:900;font-size:1.6rem;letter-spacing:.5px;direction:ltr}
  .cd-seg{min-width:2ch;text-align:center;padding:.25rem .65rem;border:1px solid var(--border);border-radius:12px;background:#f8fff9;box-shadow:inset 0 0 0 1px #eef6ef}
  .note{font-size:.9rem;color:var(--muted);text-align:center}

  .infoRow{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  @media(max-width:720px){.infoRow{grid-template-columns:1fr}}

  .chip{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:12px;display:flex;align-items:center;gap:12px;background-image:var(--chip-grad)}
  .ico{width:36px;height:36px;display:grid;place-items:center;border-radius:10px;background:#edfdf3;font-size:1.05rem;border:1px solid #e3f1e8}
  .stack{display:flex;flex-direction:column}
  .label{font-size:.85rem;color:var(--muted);font-weight:800}
  .value{font-weight:900;font-size:1rem;font-variant-numeric:tabular-nums}

  .card{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:12px}
  .card h2,.card h3{margin:0 0 10px;font-size:1.1rem;font-weight:900;text-align:center;color:#0a3b27;font-family:"Cairo",sans-serif}
  table{width:100%;border-collapse:collapse}
  th,td{padding:12px;border-bottom:1px solid #eef2ee;font-size:1rem}
  th{background:#fbfff8;font-weight:900}
  td.name{text-align:right;font-weight:800}
  td.time{text-align:left;font-weight:900}
  tr.next td{background:linear-gradient(90deg,#1b8b5715,transparent)}

  /* قائمة المصادر المنسدلة */
  .sources{display:flex;gap:8px;align-items:center;justify-content:center;margin-top:10px;flex-wrap:wrap}
  select.srcSel{padding:.55rem .8rem;border-radius:10px;border:1px solid var(--border);font-weight:700;background:#fff}
  .btn{border:1px solid var(--border);border-radius:10px;padding:.55rem .9rem;font-weight:900;cursor:pointer;background:#fff}
  .btn.primary{background:#edfef4}

  /* الأحكام */
  .fiqh{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:14px}
  .fiqh h2{margin:0 0 10px}
  .fiqh ul{margin:0;padding:0 1.1rem}
  .fiqh li{margin:.4rem 0}

  footer{text-align:center;margin-top:8px}
  .credit{color:#0f5035;font-weight:900}
</style>

<!-- JSON-LD للفهرسة (يُحدَّث في السكربت ببيانات الحدث القادم) -->
<script type="application/ld+json" id="event-jsonld">{}</script>
</head>
<body>
  <header class="container topBar" role="banner">
    <div class="brand">🌒 الخسوف والكسوف</div>
    <div class="topClock" id="topClock" aria-live="polite">--:-- --</div>
  </header>

  <main class="container" role="main">
    <section class="hero">
      <h1>تواريخ خسوف القمر وكسوف الشمس (محدَّثة تلقائيًا)</h1>
    </section>

    <section class="locationBox" aria-label="اختيار الموقع">
      <div class="place" id="place">المنامة، البحرين</div>
      <button class="changeBtn" id="openPicker" type="button" aria-haspopup="dialog" aria-controls="modal">تغيير</button>
    </section>

    <!-- الحدث القادم + عداد -->
    <section class="nextBox" id="nextBox" aria-labelledby="nextLabel">
      <div class="nextHdr">
        <span class="chipGold" id="nextLabel">الحدث القادم</span>
      </div>
      <div class="nextRow">
        <span class="nextName" id="nextName" aria-live="polite">--</span>
        <!-- التاريخ + الوقت (بدون ثوانٍ) -->
        <span class="nextAt" id="nextAt">--</span>
      </div>
      <div class="countdown" aria-live="polite" aria-label="عدّ تنازلي">
        <span class="cd-seg" id="cdH">00</span><span>:</span>
        <span class="cd-seg" id="cdM">00</span><span>:</span>
        <span class="cd-seg" id="cdS">00</span>
      </div>
      <div class="note" id="nextNote">العدّاد حتى بداية الحدث.</div>
    </section>

    <section class="infoRow" aria-label="معلومات عامة">
      <div class="chip">
        <div class="ico">📅</div>
        <div class="stack"><div class="label">التاريخ اليوم</div><div class="value" id="greg">--</div></div>
      </div>
      <div class="chip">
        <div class="ico">🌍</div>
        <div class="stack"><div class="label">المنطقة الزمنية</div><div class="value" id="tzLabel">Asia/Bahrain (محلي)</div></div>
      </div>
    </section>

    <!-- جدول أحداث هذا العام (تُعرض للأرشفة والاطلاع) -->
    <section class="card" aria-labelledby="yearEvents">
      <h2 id="yearEvents">أحداث هذا العام</h2>
      <table>
        <thead><tr><th>الحدث</th><th>يبدأ</th><th>الأعظم</th><th>ينتهي</th></tr></thead>
        <tbody id="eventsBody"><tr><td colspan="4">جاري التحميل…</td></tr></tbody>
      </table>

      <!-- قائمة المصادر المنسدلة -->
      <div class="sources" aria-label="مصادر فلكية">
        <label for="srcSel" class="label">المصادر:</label>
        <select id="srcSel" class="srcSel" aria-label="اختر مصدرًا">
          <option value="https://science.nasa.gov/eclipses/future-eclipses/">NASA – Future Eclipses</option>
          <option value="https://eclipse.gsfc.nasa.gov/SEdecade/SEdecade2021.html">NASA GSFC – Solar Eclipses 2021–2030</option>
          <option value="https://eclipse.gsfc.nasa.gov/LEdecade/LEdecade2021.html">NASA GSFC – Lunar Eclipses 2021–2030</option>
          <option value="https://www.timeanddate.com/eclipse/2025">Timeanddate – Eclipses 2025</option>
          <option value="https://eclipsewise.com/">EclipseWise</option>
        </select>
        <button type="button" class="btn primary" id="openSrc">فتح المصدر</button>
      </div>
    </section>

    <!-- الأحكام والكيفية (بدون ذكر اسم المرجع كما طلبت) -->
    <section class="fiqh" aria-labelledby="fiqhTitle">
      <h2 id="fiqhTitle">أحكام صلاة الآيات (مختصر)</h2>
      <ul>
        <li><strong>تجب صلاة الآيات</strong> عند الكسوفين (الشمس والقمر) من <strong>ابتداء الحدث إلى تمام الانجلاء</strong>، ولو كان جزئيًا.</li>
        <li><strong>الوقت:</strong> تبدأ من ظهور الآية وتستمر إلى الانجلاء التام، والأولى عدم التأخير إلى الشروع في الانجلاء.</li>
        <li><strong>الكيفية المختصرة:</strong> ركعتان، في كل ركعة <strong>خمسة ركوعات</strong>؛ يقرأ الفاتحة وسورة ثم يركع خمسًا، ثم سجدتان، ثم الركعة الثانية على النحو نفسه، ثم التشهد والسلام. ويجوز تجزئة سورة واحدة على الركوعات الخمسة.</li>
        <li><strong>ذوو الأعذار من النساء:</strong> لا تصح الصلاة منهن حال العذر، <strong>ولا يجب القضاء</strong> لما فُوت حال العذر.</li>
      </ul>
    </section>
  </main>

  <footer class="container"><span class="credit">برمجة وتطوير فاضل الريس</span></footer>

  <!-- نافذة الإعدادات -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="اختيار الموقع">
    <div class="box">
      <div class="rowCtrl"><label>البلد</label><select id="countrySel"></select></div>
      <div class="rowCtrl"><label>المدينة</label><select id="citySel"></select></div>
      <div class="actions">
        <button class="btn primary" id="savePlace" type="button">حفظ</button>
        <button class="btn" id="cancelPlace" type="button">إلغاء</button>
      </div>
    </div>
  </div>

<script>
/* ========================= إعدادات عامة ========================= */
const MAP=[
 {ar:"البحرين",en:"Bahrain",tz:"Asia/Bahrain",cities:[
   {ar:"المنامة",en:"Manama"},{ar:"المحرق",en:"Muharraq"},{ar:"مدينة عيسى",en:"Isa Town"},
   {ar:"مدينة حمد",en:"Hamad Town"},{ar:"سترة",en:"Sitra"},{ar:"سار",en:"Saar"},
   {ar:"الدراز",en:"Draz"},{ar:"جدحفص",en:"Jidhafs"}
 ]},
 {ar:"لبنان",en:"Lebanon",tz:"Asia/Beirut",cities:[{ar:"بيروت",en:"Beirut"},{ar:"طرابلس",en:"Tripoli"},{ar:"صيدا",en:"Sidon"}]},
 {ar:"العراق",en:"Iraq",tz:"Asia/Baghdad",cities:[{ar:"بغداد",en:"Baghdad"},{ar:"البصرة",en:"Basrah"},{ar:"أربيل",en:"Erbil"}]},
 {ar:"إيران",en:"Iran",tz:"Asia/Tehran",cities:[{ar:"طهران",en:"Tehran"},{ar:"مشهد",en:"Mashhad"},{ar:"أصفهان",en:"Isfahan"}]},
 {ar:"الكويت",en:"Kuwait",tz:"Asia/Kuwait",cities:[{ar:"مدينة الكويت",en:"Kuwait City"},{ar:"حولي",en:"Hawalli"},{ar:"الأحمدي",en:"Al Ahmadi"}]},
 {ar:"السعودية",en:"Saudi Arabia",tz:"Asia/Riyadh",cities:[{ar:"الرياض",en:"Riyadh"},{ar:"جدة",en:"Jeddah"},{ar:"الدمام",en:"Dammam"},{ar:"مكة",en:"Mecca"},{ar:"المدينة",en:"Medina"}]}
];
const DEFAULT={countryEn:"Bahrain",countryAr:"البحرين",cityEn:"Manama",cityAr:"المنامة",tz:"Asia/Bahrain"};
let current = JSON.parse(localStorage.getItem("eclipse_place")||"null") || {...DEFAULT};

/* ساعة أعلى الصفحة */
function updateClock(){
  const fmt=new Intl.DateTimeFormat('ar',{timeZone:current.tz,hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:true});
  document.getElementById('topClock').textContent=fmt.format(new Date());
}
setInterval(updateClock,1000); updateClock();

/* وقت/تاريخ جميل */
function fmtDateOnly(dt, tz){
  return new Intl.DateTimeFormat('ar',{timeZone:tz,weekday:'long',year:'numeric',month:'long',day:'numeric'}).format(dt);
}
function fmtHM(iso, tz){
  // ساعات ودقائق فقط
  const d = typeof iso==="string"? new Date(iso): iso;
  return new Intl.DateTimeFormat('ar',{timeZone:tz,hour:'2-digit',minute:'2-digit',hour12:true}).format(d);
}
function fmtDateTimeHM(iso, tz){
  const d=new Date(iso);
  const date=fmtDateOnly(d,tz);
  const hm=fmtHM(d,tz);
  return `${date} • ${hm}`;
}

/* ========================= بيانات فلكية (UTC) =========================
   (يمكنك توسيعها لسنوات لاحقة. "الحدث القادم" يبحث في جميع العناصر، وليس في سنة واحدة فقط.)
*/
const ECLIPSES_UTC = [
  {
    id:"2025-03-14-LUNAR-TOTAL",
    type:"خسوف قمري كلي",
    dateUTC:"2025-03-14",
    contactsUTC:{
      start:"2025-03-14T03:57:09.4Z",   // P1
      max:"2025-03-14T06:58:44.5Z",     // Greatest
      end:"2025-03-14T10:00:31.9Z"      // P4
    },
    details:[
      ["بداية شبه الظل (P1)","2025-03-14T03:57:09.4Z"],
      ["بداية الجزئي (U1)","2025-03-14T05:09:22.6Z"],
      ["بداية الكلي (U2)","2025-03-14T06:25:57.5Z"],
      ["الأعظم","2025-03-14T06:58:44.5Z"],
      ["نهاية الكلي (U3)","2025-03-14T07:32:01.5Z"],
      ["نهاية الجزئي (U4)","2025-03-14T08:48:18.5Z"],
      ["نهاية شبه الظل (P4)","2025-03-14T10:00:31.9Z"]
    ]
  },
  {
    id:"2025-03-29-SOLAR-PARTIAL",
    type:"كسوف شمسي جزئي",
    dateUTC:"2025-03-29",
    contactsUTC:{
      start:"2025-03-29T08:51:52.5Z",
      max:"2025-03-29T10:48:36.1Z",
      end:"2025-03-29T12:44:54.0Z"
    },
    details:[
      ["بداية الكسوف (اتصال أول)","2025-03-29T08:51:52.5Z"],
      ["الأعظم","2025-03-29T10:48:36.1Z"],
      ["نهاية الكسوف (اتصال أخير)","2025-03-29T12:44:54.0Z"]
    ]
  },
  {
    id:"2025-09-07-LUNAR-TOTAL",
    type:"خسوف قمري كلي",
    dateUTC:"2025-09-07",
    contactsUTC:{
      start:"2025-09-07T15:28:21Z",
      max:"2025-09-07T18:11:43Z",
      end:"2025-09-07T20:55:00Z"
    },
    details:[
      ["بداية شبه الظل (P1)","2025-09-07T15:28:21Z"],
      ["بداية الجزئي (U1)","2025-09-07T16:27:02Z"],
      ["بداية الكلي (U2)","2025-09-07T17:30:41Z"],
      ["الأعظم","2025-09-07T18:11:43Z"],
      ["نهاية الكلي (U3)","2025-09-07T18:52:47Z"],
      ["نهاية الجزئي (U4)","2025-09-07T19:56:26Z"],
      ["نهاية شبه الظل (P4)","2025-09-07T20:55:00Z"]
    ]
  },
  {
    id:"2025-09-21-SOLAR-PARTIAL",
    type:"كسوف شمسي جزئي",
    dateUTC:"2025-09-21",
    contactsUTC:{
      start:"2025-09-21T17:30:51.3Z",
      max:"2025-09-21T19:43:04.2Z",
      end:"2025-09-21T21:54:55.1Z"
    },
    details:[
      ["بداية الكسوف (اتصال أول)","2025-09-21T17:30:51.3Z"],
      ["الأعظم","2025-09-21T19:43:04.2Z"],
      ["نهاية الكسوف (اتصال أخير)","2025-09-21T21:54:55.1Z"]
    ]
  }
];

/* أدوات جدول السنة الجارية */
function currentYearEclipses(){
  const Y=(new Date()).getUTCFullYear();
  return ECLIPSES_UTC.filter(e=>e.dateUTC.startsWith(String(Y)));
}

/* اختيار الحدث القادم عبر جميع السنوات المتاحة */
function getNextEvent(){
  const now=new Date();
  const all=ECLIPSES_UTC.slice().sort((a,b)=>new Date(a.contactsUTC.start)-new Date(b.contactsUTC.start));
  const future = all.find(e=>new Date(e.contactsUTC.start)>now);
  return future || null;
}

/* ملء صندوق الحدث القادم + JSON-LD */
function renderNext(){
  const ev=getNextEvent();
  const nextName=document.getElementById('nextName');
  const nextAt=document.getElementById('nextAt');
  const nextNote=document.getElementById('nextNote');

  if(!ev){
    nextName.textContent="لا توجد بيانات قادمة ضمن المجموعة الحالية";
    nextAt.textContent="—";
    nextNote.textContent="أضف بيانات السنوات اللاحقة إلى المصفوفة لتستمر المتابعة تلقائيًا.";
    document.getElementById('event-jsonld').textContent="{}";
    return;
  }

  // العنوان + التاريخ
  const dateTxt = new Date(ev.dateUTC).toLocaleDateString('ar',{year:'numeric',month:'long',day:'numeric'});
  nextName.textContent = `${ev.type} – ${dateTxt}`;

  // اظهر التاريخ + ساعة:دقيقة فقط
  const startTxt = fmtDateTimeHM(ev.contactsUTC.start, current.tz);
  nextAt.textContent = startTxt;

  nextNote.textContent = "العدّاد حتى بداية الحدث (بداية شبه الظل أو الاتصال الأول).";

  // عدّ تنازلي
  setupCountdown(new Date(ev.contactsUTC.start));

  // JSON-LD لتهيئة SEO للحدث القادم
  const ld = {
    "@context":"https://schema.org",
    "@type":"Event",
    "name": ev.type,
    "eventAttendanceMode":"https://schema.org/OnlineEventAttendanceMode",
    "startDate": new Date(ev.contactsUTC.start).toISOString(),
    "endDate": new Date(ev.contactsUTC.end).toISOString(),
    "eventStatus":"https://schema.org/EventScheduled",
    "location":{
      "@type":"Place",
      "name": `${current.cityAr}، ${current.countryAr}`
    },
    "description":"خسوف/كسوف مع مواقيت البداية والأعظم والنهاية محوّلة للمنطقة الزمنية المحلية (ساعات ودقائق)، مع عدّ تنازلي وأحكام صلاة الآيات."
  };
  document.getElementById('event-jsonld').textContent = JSON.stringify(ld, null, 2);
}

/* جدول السنة */
function renderYearTable(){
  const tbody=document.getElementById('eventsBody');
  const rows=currentYearEclipses().map(e=>{
    const dateTxt = new Date(e.dateUTC).toLocaleDateString('ar',{year:'numeric',month:'long',day:'numeric'});
    const s=fmtHM(e.contactsUTC.start,current.tz);
    const m=fmtHM(e.contactsUTC.max,current.tz);
    const en=fmtHM(e.contactsUTC.end,current.tz);
    return `<tr>
      <td class="name">${e.type} – ${dateTxt}</td>
      <td class="time">${s}</td>
      <td class="time">${m}</td>
      <td class="time">${en}</td>
    </tr>`;
  }).join('');
  tbody.innerHTML = rows || `<tr><td colspan="4">لا أحداث مسجّلة لهذه السنة ضمن البيانات الحالية.</td></tr>`;
}

/* عدّاد */
let cdTimer=null;
function setupCountdown(targetUTC){
  if(cdTimer) clearInterval(cdTimer);
  const tick=()=>{
    const diff = new Date(targetUTC) - new Date();
    const ms = Math.max(0,diff|0);
    let s = Math.floor(ms/1000);
    const h = Math.floor(s/3600); s%=3600;
    const m = Math.floor(s/60); s%=60;
    document.getElementById('cdH').textContent=String(h).padStart(2,'0');
    document.getElementById('cdM').textContent=String(m).padStart(2,'0');
    document.getElementById('cdS').textContent=String(s).padStart(2,'0');
    if(ms<=0){ clearInterval(cdTimer); renderAll(); }
  };
  tick();
  cdTimer=setInterval(tick,1000);
}

/* نافذة الإعداد */
const modal=document.getElementById("modal");
const openPicker=document.getElementById("openPicker");
const cancelPlace=document.getElementById("cancelPlace");
const savePlace=document.getElementById("savePlace");
const countrySel=document.getElementById("countrySel");
const citySel=document.getElementById("citySel");

function populateCities(countryEn){
  const c=MAP.find(x=>x.en===countryEn);
  citySel.innerHTML=(c?.cities||[]).map(m=>`<option value="${m.en}">${m.ar}</option>`).join("");
}
function openModal(){
  countrySel.innerHTML=MAP.map(c=>`<option value="${c.en}">${c.ar}</option>`).join("");
  countrySel.value=current.countryEn;
  populateCities(countrySel.value);
  citySel.value=current.cityEn;
  modal.classList.add("open");
  document.body.style.overflow='hidden';
}
function closeModal(){ modal.classList.remove("open"); document.body.style.overflow=''; }
openPicker.addEventListener("click",openModal);
cancelPlace.addEventListener("click",closeModal);
modal.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });
countrySel.addEventListener("change",()=>populateCities(countrySel.value));
savePlace.addEventListener("click",()=>{
  const c=MAP.find(x=>x.en===countrySel.value);
  const m=(c?.cities||[]).find(x=>x.en===citySel.value);
  if(c&&m){
    current={countryEn:c.en,countryAr:c.ar,cityEn:m.en,cityAr:m.ar,tz:c.tz};
    localStorage.setItem("eclipse_place",JSON.stringify(current));
  }
  closeModal();
  renderAll();
});

/* مصادر منسدلة */
document.getElementById('openSrc').addEventListener('click',()=>{
  const url=document.getElementById('srcSel').value;
  window.open(url,'_blank','noopener');
});

/* تشغيل */
function renderAll(){
  document.getElementById('place').textContent=`${current.cityAr}، ${current.countryAr}`;
  document.getElementById('greg').textContent=fmtDateOnly(new Date(), current.tz);
  document.getElementById('tzLabel').textContent=current.tz+" (محلي)";
  renderYearTable();
  renderNext();
}
renderAll();
</script>
</body>
</html>
