<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ù…Ù†Ø´Ø¦ Ø³ÙŠØ±Ø© Ø°Ø§ØªÙŠØ© Ø«Ù†Ø§Ø¦ÙŠ Ø§Ù„Ù„ØºØ© â€” Ø¹Ø±Ø¨ÙŠ/English â€” PDF & Word</title>
<link href="https://fonts.googleapis.com/css2?family=Reem+Kufi:wght@600&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{--ink:#0f172a;--muted:#6b7280;--bg:#f6f8fb;--border:#e5e7eb;--accent:#0ea5a6;--shadow:0 8px 20px rgba(2,6,23,.08);--paper:#fff;--chip:#eef6ff}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:"Tajawal",sans-serif}
  .wrap{max-width:1200px;margin:auto;padding:16px;display:grid;grid-template-columns:380px 1fr;gap:16px}
  @media(max-width:1020px){.wrap{grid-template-columns:1fr}}
  .panel{background:#fff;border:1px solid var(--border);border-radius:16px;box-shadow:var(--shadow);padding:16px}
  .title{margin:0 0 10px;font-family:"Reem Kufi",sans-serif;font-size:1.4rem}
  .hint{color:var(--muted);font-size:.92rem}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
  .field{display:flex;flex-direction:column;margin:8px 0}
  .field label{font-weight:700;font-size:.9rem;color:#334155;margin-bottom:6px}
  .field input,.field textarea,.field select{border:1px solid var(--border);border-radius:10px;padding:10px 12px;font-weight:700;background:#fff}
  .field textarea{min-height:84px;resize:vertical}
  .subsec{border-top:1px dashed #e5e7eb;margin:14px 0 6px;padding-top:8px;display:flex;justify-content:space-between;align-items:center}
  .btn{border:1px solid var(--border);background:#fff;border-radius:10px;padding:.5rem .8rem;font-weight:800;cursor:pointer}
  .btn.primary{background:#eef6ff}
  .btn.danger{background:#fff0f0;border-color:#fecaca;color:#991b1b}
  .small{font-size:.85rem;color:var(--muted)}
  .uploader{display:flex;align-items:center;gap:10px}
  .uploader input[type=file]{display:none}
  .avatarPreview{width:56px;height:56px;border-radius:12px;border:1px solid var(--border);object-fit:cover;background:#f1f5f9}

  /* ===== CV Page (A4) ===== */
  .cv-wrap{display:flex;justify-content:center;align-items:flex-start}
  .cv-page{width:210mm;min-height:297mm;background:var(--paper);color:#111827;border:1px solid #e5e7eb;border-radius:12px;box-shadow:var(--shadow);overflow:hidden}
  .cv-head{display:grid;grid-template-columns:1fr 140px;gap:16px;padding:22px 22px 0}
  .cv-name{margin:0;font-family:"Reem Kufi",sans-serif;font-size:28px;line-height:1.2}
  .cv-role{margin:6px 0 10px;font-weight:800;color:#0b3b3a}
  .cv-summary{color:#334155;line-height:1.8;white-space:pre-line}
  .cv-photo{width:120px;height:120px;border-radius:14px;border:2px solid var(--accent);object-fit:cover;justify-self:end;background:#f1f5f9}
  .cv-contact{display:flex;flex-wrap:wrap;gap:8px;margin:14px 22px 0}
  .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid #e5e7eb;border-radius:999px;background:#f8fafc;font-weight:700}
  .cv-cols{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;padding:14px 22px 22px}
  .sec{margin-top:8px}
  .sec h3{margin:0 0 8px;font-size:15px;color:#0f172a;border-bottom:2px solid var(--accent);display:inline-block;padding-bottom:2px}
  .item{margin:10px 0}
  .item .top{display:flex;justify-content:space-between;font-weight:800}
  .item .meta{color:#475569;font-size:.92rem}
  .item .desc{margin-top:6px;color:#334155;white-space:pre-line}
  .tags{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .tag{padding:6px 10px;border-radius:999px;background:#eef6ff;border:1px solid #dbeafe;font-weight:800}
  .langRow{display:flex;justify-content:space-between;border:1px dashed #e5e7eb;border-radius:10px;padding:8px 10px;margin-top:8px}
  .accentDot{display:inline-block;width:8px;height:8px;border-radius:50%;background:var(--accent);margin-inline:6px}
  .muted{color:#64748b}

  /* Print */
  @media print{
    body{background:#fff}
    .wrap{display:block;padding:0}
    .panel.controlsOnly{display:none}
    .cv-page{border:none;box-shadow:none;width:auto;min-height:auto}
    @page{size:A4;margin:12mm}
  }
</style>
</head>
<body>
  <div class="wrap">
    <!-- ============ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ============ -->
    <section class="panel">
      <h1 class="title">Ù…Ù†Ø´Ø¦ Ø³ÙŠØ±Ø© Ø°Ø§ØªÙŠØ© Ø«Ù†Ø§Ø¦ÙŠ Ø§Ù„Ù„ØºØ© (Ø¹Ø±Ø¨ÙŠ / English)</h1>
      <p class="hint">Ø§ÙƒØªØ¨ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø£ÙŠ Ù„ØºØ©ØŒ ÙˆØ³Ù†ÙÙ†Ø´Ø¦ Ù†Ø³Ø®Ø© Ø¹Ø±Ø¨ÙŠØ© ÙˆÙ†Ø³Ø®Ø© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙŠÙ…ÙƒÙ† ØªÙ†Ø²ÙŠÙ„Ù‡Ù…Ø§ Ø¨ØµÙŠØºØ© PDF Ø£Ùˆ Word.</p>

      <div class="field">
        <label>Ù„ØºØ© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© / UI Language</label>
        <select id="uiLang">
          <option value="ar" selected>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
          <option value="en">English</option>
        </select>
      </div>

      <div class="field">
        <label>ØªØ±Ø¬Ù…Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…Ø­ØªÙˆÙ‰ / Auto-translate content</label>
        <select id="autoTranslate">
          <option value="on" selected>ØªØ´ØºÙŠÙ„ / On</option>
          <option value="off">Ø¥ÙŠÙ‚Ø§Ù / Off</option>
        </select>
        <div class="small">Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ØºÙŠØ± Ø¯Ù‚ÙŠÙ‚Ø©ØŒ Ø¹Ø·Ù‘Ù„Ù‡Ø§ ÙˆØ§ÙƒØªØ¨ ØµÙŠØºØ© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ© ÙŠØ¯ÙˆÙŠÙ‹Ø§.</div>
      </div>

      <div class="subsec"><b>Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª / Basics</b></div>
      <div class="field"><label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ / Full Name</label><input id="f_name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ / Your full name"></div>
      <div class="field"><label>Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ / Title</label><input id="f_role" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø·ÙˆÙ‘Ø± ÙˆØ§Ø¬Ù‡Ø§Øª / e.g., Frontend Developer"></div>
      <div class="field"><label>Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‡Ù†ÙŠ / Professional Summary</label><textarea id="f_summary" placeholder="Ù†Ø¨Ø°Ø© Ù…ÙˆØ¬Ø²Ø© / A concise professional summary"></textarea></div>

      <div class="row">
        <div class="field"><label>Ø§Ù„Ø¨Ø±ÙŠØ¯ / Email</label><input id="f_email" placeholder="you@example.com"></div>
        <div class="field"><label>Ø§Ù„Ù‡Ø§ØªÙ / Phone</label><input id="f_phone" placeholder="+973 â€¦"></div>
      </div>
      <div class="row">
        <div class="field"><label>Ø§Ù„Ù…ÙˆÙ‚Ø¹ / Location</label><input id="f_loc" placeholder="Ø§Ù„Ù…Ù†Ø§Ù…Ø©ØŒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† / Manama, Bahrain"></div>
        <div class="field"><label>LinkedIn</label><input id="f_linkedin" placeholder="linkedin.com/in/username"></div>
      </div>
      <div class="row">
        <div class="field"><label>Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ø®ØµÙŠ / Website</label><input id="f_site" placeholder="your-portfolio.com"></div>
        <div class="field"><label>Ù„ÙˆÙ† Ø§Ù„ØªÙ…ÙŠÙŠØ² / Accent</label><input id="f_accent" type="color" value="#0ea5a6"></div>
      </div>

      <div class="field">
        <label>ØµÙˆØ±Ø© Ø´Ø®ØµÙŠØ© / Photo</label>
        <div class="uploader">
          <img id="avatarPrev" class="avatarPreview" alt="">
          <label class="btn" for="f_photo">Ø§Ø®ØªØ± / Choose</label>
          <input id="f_photo" type="file" accept="image/*">
          <button type="button" class="btn" id="clearPhoto">Ø­Ø°Ù / Remove</button>
        </div>
        <div class="small">ÙŠÙØ¶Ù‘Ù„ Ù…Ø±Ø¨Ø¹Ø© 600Ã—600 px.</div>
      </div>

      <!-- Ø§Ù„Ø®Ø¨Ø±Ø§Øª -->
      <div class="subsec"><b>Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© / Experience</b> <button class="btn" type="button" id="addExp">+ Ø¥Ø¶Ø§ÙØ© / Add</button></div>
      <div id="expList"></div>

      <!-- Ø§Ù„ØªØ¹Ù„ÙŠÙ… -->
      <div class="subsec"><b>Ø§Ù„ØªØ¹Ù„ÙŠÙ… / Education</b> <button class="btn" type="button" id="addEdu">+ Ø¥Ø¶Ø§ÙØ© / Add</button></div>
      <div id="eduList"></div>

      <!-- Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ -->
      <div class="subsec"><b>Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ / Projects</b> <button class="btn" type="button" id="addProj">+ Ø¥Ø¶Ø§ÙØ© / Add</button></div>
      <div id="projList"></div>

      <!-- Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª -->
      <div class="subsec"><b>Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª / Skills</b></div>
      <div class="field"><label>Ø§ÙƒØªØ¨Ù‡Ø§ Ø¨ÙÙˆØ§ØµÙ„ / Comma-separated</label>
        <input id="f_skills" placeholder="HTML, CSS, JavaScript, Python">
      </div>

      <!-- Ø§Ù„Ù„ØºØ§Øª -->
      <div class="subsec"><b>Ø§Ù„Ù„ØºØ§Øª / Languages</b> <button class="btn" type="button" id="addLang">+ Ø¥Ø¶Ø§ÙØ© / Add</button></div>
      <div id="langList"></div>

      <!-- Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª -->
      <div class="subsec"><b>Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª / Certificates</b> <button class="btn" type="button" id="addCert">+ Ø¥Ø¶Ø§ÙØ© / Add</button></div>
      <div id="certList"></div>

      <div class="subsec"><b>Ø§Ù„ØªÙ†Ø²ÙŠÙ„ / Export</b></div>
      <div class="row">
        <div class="field">
          <label>ØªÙ†Ø²ÙŠÙ„ PDF / Download PDF</label>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn primary" id="btnPDF_AR" type="button">PDF (Ø¹Ø±Ø¨ÙŠ)</button>
            <button class="btn primary" id="btnPDF_EN" type="button">PDF (English)</button>
          </div>
        </div>
        <div class="field">
          <label>ØªÙ†Ø²ÙŠÙ„ Word / Download Word</label>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" id="btnWord_AR" type="button">Word (AR)</button>
            <button class="btn" id="btnWord_EN" type="button">Word (EN)</button>
          </div>
        </div>
      </div>

      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
        <button class="btn danger" id="btnClear" type="button">ØªÙØ±ÙŠØº / Clear</button>
      </div>

      <div class="small" style="margin-top:10px">ğŸ’¡ Ù„Ù†Ø³Ø®Ø© PDF: Ù†ÙØªØ­ ØµÙØ­Ø© Ø·Ø¨Ø§Ø¹Ø© Ù„Ù„Ù‘ØºØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©ØŒ Ø«Ù… Ø§Ø®ØªØ± "Ø­ÙØ¸ Ø¨ØªÙ†Ø³ÙŠÙ‚ PDF".</div>
    </section>

    <!-- ============ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ============ -->
    <section class="panel cv-wrap">
      <article id="cvPage" class="cv-page" aria-label="CV Preview">
        <header class="cv-head">
          <div>
            <h2 id="cvName" class="cv-name">Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§ / Your Name</h2>
            <div id="cvRole" class="cv-role">Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ / Title</div>
            <p id="cvSummary" class="cv-summary">Ø§ÙƒØªØ¨ Ù…Ù„Ø®ØµÙ‹Ø§ Ù‚ØµÙŠØ±Ù‹Ø§ / Write a short summary.</p>
          </div>
          <img id="cvPhoto" class="cv-photo" alt="" />
        </header>

        <div class="cv-contact" id="cvContact">
          <span class="chip" id="cEmail">âœ‰ï¸ <b>you@example.com</b></span>
          <span class="chip" id="cPhone">ğŸ“ <b>+973 â€¦</b></span>
          <span class="chip" id="cLoc">ğŸ“ <b>Ø§Ù„Ù…Ù†Ø§Ù…Ø©ØŒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† / Manama, Bahrain</b></span>
          <span class="chip" id="cLinkedin">ğŸ”— <b>LinkedIn</b></span>
          <span class="chip" id="cSite">ğŸŒ <b>Website</b></span>
        </div>

        <div class="cv-cols">
          <div>
            <section class="sec" id="cvExp"><h3 data-i18n="exp">Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h3><div class="item muted">Ø£Ø¶Ù Ø®Ø¨Ø±Ø§ØªÙƒâ€¦</div></section>
            <section class="sec" id="cvProj"><h3 data-i18n="projects">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h3><div class="item muted">Ø£Ø¶Ù Ù…Ø´Ø§Ø±ÙŠØ¹Ùƒâ€¦</div></section>
          </div>
          <div>
            <section class="sec" id="cvEdu"><h3 data-i18n="education">Ø§Ù„ØªØ¹Ù„ÙŠÙ…</h3><div class="item muted">Ø£Ø¶Ù ØªØ¹Ù„ÙŠÙ…Ùƒâ€¦</div></section>
            <section class="sec" id="cvSkills"><h3 data-i18n="skills">Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</h3><div class="tags" id="cvSkillTags"><span class="muted">â€¦</span></div></section>
            <section class="sec" id="cvLangs"><h3 data-i18n="languages">Ø§Ù„Ù„ØºØ§Øª</h3><div id="cvLangList"><div class="muted">â€¦</div></div></section>
            <section class="sec" id="cvCerts"><h3 data-i18n="certs">Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª / Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h3><div id="cvCertList"><div class="muted">â€¦</div></div></section>
          </div>
        </div>
      </article>
    </section>
  </div>

<script>
/* ================== Utilities & i18n ================== */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const S = {
  ar: {
    name:'Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§', role:'Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰/Ø§Ù„ØªØ®ØµØµ', summary:'Ø§ÙƒØªØ¨ Ù…Ù„Ø®ØµÙ‹Ø§ Ù‚ØµÙŠØ±Ù‹Ø§ Ø¹Ù† Ø®Ø¨Ø±ØªÙƒ.',
    exp:'Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©', projects:'Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹', education:'Ø§Ù„ØªØ¹Ù„ÙŠÙ…', skills:'Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª', languages:'Ø§Ù„Ù„ØºØ§Øª', certs:'Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª / Ø§Ù„Ø¯ÙˆØ±Ø§Øª',
    at:'ÙÙŠ', range:(f,t)=>[f,t].filter(Boolean).join(' â€” '), bullet: s=>s
  },
  en: {
    name:'Your Full Name', role:'Title / Specialization', summary:'Write a concise professional summary.',
    exp:'Experience', projects:'Projects', education:'Education', skills:'Skills', languages:'Languages', certs:'Certificates',
    at:'at', range:(f,t)=>[f,t].filter(Boolean).join(' â€” '), bullet: s=>s
  }
};

/* Lightweight dictionary for common CV phrases (fallback for user text).
   For anything not found, we return the original text. */
const DICT = {
  // ar -> en
  ar2en: new Map(Object.entries({
    'Ø§Ù„Ù…Ù†Ø§Ù…Ø©':'Manama','Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†':'Bahrain','Ø§Ù„Ø±ÙŠØ§Ø¶':'Riyadh','Ø¬Ø¯Ø©':'Jeddah',
    'Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰':'Title','Ø§Ù„ØªØ®ØµØµ':'Specialization','Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©':'Experience','Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹':'Projects',
    'Ø§Ù„ØªØ¹Ù„ÙŠÙ…':'Education','Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª':'Skills','Ø§Ù„Ù„ØºØ§Øª':'Languages','Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª':'Certificates',
    'Ù…Ù„Ø®Øµ':'Summary','Ø§Ù„Ø¢Ù†':'Present','Ø¬Ø§Ù…Ø¹Ø©':'University','Ø´Ø±ÙƒØ©':'Company','Ù…Ø·ÙˆØ±':'Developer',
    'ÙˆØ§Ø¬Ù‡Ø©':'Frontend','Ø®Ù„ÙÙŠØ©':'Backend','Ù…Ù‡Ù†Ø¯Ø³':'Engineer','Ù…Ø­Ù„Ù„':'Analyst','Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†ØªØ¬Ø§Øª':'Product Management'
  })),
  // en -> ar
  en2ar: new Map(Object.entries({
    'Manama':'Ø§Ù„Ù…Ù†Ø§Ù…Ø©','Bahrain':'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†','Riyadh':'Ø§Ù„Ø±ÙŠØ§Ø¶','Jeddah':'Ø¬Ø¯Ø©',
    'Title':'Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰','Specialization':'Ø§Ù„ØªØ®ØµØµ','Experience':'Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©','Projects':'Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹',
    'Education':'Ø§Ù„ØªØ¹Ù„ÙŠÙ…','Skills':'Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª','Languages':'Ø§Ù„Ù„ØºØ§Øª','Certificates':'Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª','Summary':'Ø§Ù„Ù…Ù„Ø®Øµ',
    'Present':'Ø§Ù„Ø¢Ù†','University':'Ø¬Ø§Ù…Ø¹Ø©','Company':'Ø´Ø±ÙƒØ©','Developer':'Ù…Ø·ÙˆØ±','Engineer':'Ù…Ù‡Ù†Ø¯Ø³','Analyst':'Ù…Ø­Ù„Ù„'
  }))
};

/* naive translator: tries dictionary word-by-word; keeps unknown words */
function translateText(txt, to='en'){
  if(!txt) return '';
  const map = (to==='en') ? DICT.ar2en : DICT.en2ar;
  // split on spaces & punctuation, translate tokens when available
  return txt.split(/(\s+|[.,;:!?\-â€“â€”()\/])/g).map(tok=>{
    const k = tok.trim();
    if(!k) return tok;
    let t = map.get(k);
    if(!t){
      // try capitalized/lowercase
      t = map.get(k.toLowerCase()) || map.get(k[0]?.toUpperCase()+k.slice(1)) || null;
    }
    return t || tok;
  }).join('');
}

/* ================== Inputs, Photo, Accent ================== */
const uiLangSel = $('#uiLang');
const autoTranslateSel = $('#autoTranslate');
const f = {
  name: $('#f_name'), role: $('#f_role'), summary: $('#f_summary'),
  email: $('#f_email'), phone: $('#f_phone'), loc: $('#f_loc'),
  linkedin: $('#f_linkedin'), site: $('#f_site'), accent: $('#f_accent')
};

const photoInput = $('#f_photo'), photoPrev = $('#avatarPrev'), cvPhoto = $('#cvPhoto');
$('#clearPhoto').onclick = () => { photoInput.value=""; photoPrev.src=""; cvPhoto.src=""; cvPhoto.style.display="none"; renderPreview(); };
photoInput.addEventListener('change', e=>{
  const f = e.target.files[0]; if(!f) return;
  const reader = new FileReader();
  reader.onload = ev => { photoPrev.src = ev.target.result; cvPhoto.src = ev.target.result; cvPhoto.style.display='block'; renderPreview(); };
  reader.readAsDataURL(f);
});
Object.values(f).forEach(el=>el.addEventListener('input', renderPreview));
uiLangSel.addEventListener('change', ()=>{
  document.documentElement.lang = uiLangSel.value;
  document.documentElement.dir = uiLangSel.value==='ar' ? 'rtl' : 'ltr';
  renderPreview();
});
autoTranslateSel.addEventListener('change', renderPreview);

/* ================== Dynamic Lists ================== */
const expList = $('#expList'), eduList = $('#eduList'), projList = $('#projList'), langList = $('#langList'), certList = $('#certList');

function mkField(label, ph){ return `<div class="field"><label>${label}</label><input placeholder="${ph}"></div>`; }
function mkArea(label, ph){ return `<div class="field"><label>${label}</label><textarea placeholder="${ph}"></textarea></div>`; }
function mkDates(){ return `<div class="row-3">
  ${mkField('Ù…Ù†/From','09/2022')}
  ${mkField('Ø¥Ù„Ù‰/To','Present')}
  ${mkField('Ø§Ù„Ù…ÙˆÙ‚Ø¹/Location','Manama, Bahrain')}
</div>`; }
function blockShell(title, inner){
  return `<div class="panel" style="padding:12px;margin-bottom:10px">
    <div class="subsec" style="margin-top:0"><b>${title}</b>
      <span>
        <button class="btn" type="button" data-up>â¬†ï¸</button>
        <button class="btn" type="button" data-down>â¬‡ï¸</button>
        <button class="btn" type="button" data-del>ğŸ—‘</button>
      </span>
    </div>${inner}
  </div>`;
}

function addExp(prefill={}){
  const html = blockShell('Ø®Ø¨Ø±Ø©/Experience', `
    ${mkField('Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰/Title','Frontend Developer')}
    ${mkField('Ø§Ù„Ø´Ø±ÙƒØ©/Company','Tech Co.')}
    ${mkDates()}
    ${mkArea('Ø§Ù„Ù…Ù‡Ø§Ù…/Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª | Responsibilities/Achievements','Built â€¦\nImproved â€¦')}
  `);
  expList.insertAdjacentHTML('beforeend', html); fillLatest(expList, prefill);
}
function addEdu(prefill={}){ 
  const html = blockShell('ØªØ¹Ù„ÙŠÙ…/Education', `
    ${mkField('Ø§Ù„Ø¬Ù‡Ø©/Institution','University of â€¦')}
    ${mkField('Ø§Ù„Ø¯Ø±Ø¬Ø©/Ø§Ù„ØªØ®ØµØµ | Degree/Major','B.Sc. Computer Science')}
    <div class="row-3">
      ${mkField('Ø§Ù„Ø¨Ø¯Ø¡/Start','2019')}
      ${mkField('Ø§Ù„ØªØ®Ø±Ø¬/End','2023')}
      ${mkField('Ø§Ù„Ù…Ø¹Ø¯Ù„/GPA','3.6 / 4')}
    </div>
    ${mkArea('ØªÙØ§ØµÙŠÙ„/Details (Ø§Ø®ØªÙŠØ§Ø±ÙŠ/Optional)','Courses: â€¦')}
  `);
  eduList.insertAdjacentHTML('beforeend', html); fillLatest(eduList, prefill);
}
function addProj(prefill={}){ 
  const html = blockShell('Ù…Ø´Ø±ÙˆØ¹/Project', `
    ${mkField('Ø§Ø³Ù…/Name','Task Manager App')}
    ${mkField('ØªÙ‚Ù†ÙŠØ§Øª/Tech','React, Node')}
    ${mkField('Ø±Ø§Ø¨Ø·/Link','https://â€¦')}
    ${mkArea('Ø§Ù„ÙˆØµÙ/Description','Implemented auth â€¦')}
  `);
  projList.insertAdjacentHTML('beforeend', html); fillLatest(projList, prefill);
}
function addLang(prefill={}){ 
  const html = blockShell('Ù„ØºØ©/Language', `
    <div class="row">
      ${mkField('Ø§Ù„Ù„ØºØ©/Language','Arabic')}
      <div class="field"><label>Ø§Ù„Ù…Ø³ØªÙˆÙ‰/Level</label>
        <select>
          <option>Basic</option><option>Intermediate</option><option selected>Advanced</option><option>Fluent</option>
        </select>
      </div>
    </div>
  `);
  langList.insertAdjacentHTML('beforeend', html); fillLatest(langList, prefill);
}
function addCert(prefill={}){ 
  const html = blockShell('Ø´Ù‡Ø§Ø¯Ø©/Certificate', `
    ${mkField('Ø§Ù„Ø§Ø³Ù…/Name','Google Data Analytics')}
    <div class="row">
      ${mkField('Ø§Ù„Ø¬Ù‡Ø©/Issuer','Google')}
      ${mkField('Ø§Ù„Ø³Ù†Ø©/Year','2024')}
    </div>
  `);
  certList.insertAdjacentHTML('beforeend', html); fillLatest(certList, prefill);
}

$('#addExp').onclick=()=>addExp();
$('#addEdu').onclick=()=>addEdu();
$('#addProj').onclick=()=>addProj();
$('#addLang').onclick=()=>addLang();
$('#addCert').onclick=()=>addCert();

document.addEventListener('click', e=>{
  const card = e.target.closest('.panel'); if(!card) return;
  if(e.target.matches('[data-del]')){ card.remove(); renderPreview(); }
  if(e.target.matches('[data-up]') && card.previousElementSibling){ card.parentElement.insertBefore(card, card.previousElementSibling); renderPreview(); }
  if(e.target.matches('[data-down]') && card.nextElementSibling){ card.parentElement.insertBefore(card.nextElementSibling, card); renderPreview(); }
});
document.addEventListener('input', e=>{
  if(e.target.closest('#expList,#eduList,#projList,#langList,#certList')) renderPreview();
});

function fillLatest(container, data){
  const card = container.lastElementChild;
  if(!card) return;
  const inputs = card.querySelectorAll('input, textarea, select');
  Object.entries(data).forEach(([i,v],idx)=>{ if(inputs[idx]) inputs[idx].value=v; });
  renderPreview();
}
function readBlocks(container){
  return Array.from(container.children).map(panel=>{
    const fields = panel.querySelectorAll('input,textarea,select');
    return Array.from(fields).map(el=>el.value.trim());
  });
}

/* ================== Rendering ================== */
function bullets(text){ return (text||'').split(/\r?\n/).filter(l=>l.trim()).map(l=>'â€¢ '+l.trim()).join('\n'); }
function setChip(id, icon, text, label){
  const el=$(id);
  if(text){ el.style.display='inline-flex'; el.innerHTML=`${icon} <b>${label||text}</b>`; } else { el.style.display='none'; }
}
function renderPreview(){
  // accent
  document.documentElement.style.setProperty('--accent', f.accent.value||'#0ea5a6');
  // header
  $('#cvName').textContent = f.name.value || 'Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§ / Your Name';
  $('#cvRole').textContent = f.role.value || 'Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ / Title';
  $('#cvSummary').textContent = f.summary.value || 'Ø§ÙƒØªØ¨ Ù…Ù„Ø®ØµÙ‹Ø§ Ù‚ØµÙŠØ±Ù‹Ø§ / Write a short summary.';

  if($('#cvPhoto').src){ $('#cvPhoto').style.display='block'; }

  setChip('#cEmail','âœ‰ï¸', f.email.value);
  setChip('#cPhone','ğŸ“', f.phone.value);
  setChip('#cLoc','ğŸ“', f.loc.value || 'Manama, Bahrain');
  setChip('#cLinkedin','ğŸ”—', f.linkedin.value, 'LinkedIn');
  setChip('#cSite','ğŸŒ', f.site.value, 'Website');

  // section headings per UI language
  const lang = uiLangSel.value;
  $$('[data-i18n="exp"]').forEach(h=>h.textContent=S[lang].exp);
  $$('[data-i18n="projects"]').forEach(h=>h.textContent=S[lang].projects);
  $$('[data-i18n="education"]').forEach(h=>h.textContent=S[lang].education);
  $$('[data-i18n="skills"]').forEach(h=>h.textContent=S[lang].skills);
  $$('[data-i18n="languages"]').forEach(h=>h.textContent=S[lang].languages);
  $$('[data-i18n="certs"]').forEach(h=>h.textContent=S[lang].certs);

  // lists
  renderListsTo($('#cvExp'), readBlocks(expList), 'exp');
  renderListsTo($('#cvProj'), readBlocks(projList), 'proj');
  renderListsTo($('#cvEdu'), readBlocks(eduList), 'edu');
  renderSkills();
  renderLangs(readBlocks(langList));
  renderCerts(readBlocks(certList));
}

function renderListsTo(container, arrs, type){
  const lang = uiLangSel.value;
  container.innerHTML = `<h3 data-i18n="${type==='exp'?'exp':type==='proj'?'projects':'education'}">${S[lang][type==='exp'?'exp':type==='proj'?'projects':'education']}</h3>`;
  if(arrs.length===0){ container.insertAdjacentHTML('beforeend', `<div class="item muted">â€”</div>`); return; }
  arrs.forEach(a=>{
    if(type==='exp'){
      const [title, company, from, to, place, desc] = [a[0],a[1],a[2],a[3],a[4],a[5]||''];
      container.insertAdjacentHTML('beforeend', `
        <div class="item">
          <div class="top"><div>${title||'Title'} <span class="accentDot"></span> ${company||''}</div><div class="meta">${S[lang].range(from,to)}</div></div>
          <div class="meta">${place||''}</div>
          <div class="desc">${bullets(desc)}</div>
        </div>
      `);
    }else if(type==='proj'){
      const [name, techs, link, desc] = [a[0],a[1],a[2],a[3]||''];
      const linkHtml = link? ` â€” <a href="${link}" target="_blank" rel="noopener" style="color:var(--accent);font-weight:800">${link}</a>`:'';
      container.insertAdjacentHTML('beforeend', `
        <div class="item">
          <div class="top"><div>${name||'Project'}</div><div class="meta">${techs||''}</div></div>
          <div class="desc">${bullets(desc)}${linkHtml}</div>
        </div>
      `);
    }else{
      const [org, degree, start, end, gpa, details] = [a[0],a[1],a[2],a[3],a[4],a[5]||''];
      container.insertAdjacentHTML('beforeend', `
        <div class="item">
          <div class="top"><div>${org||'Institution'}</div><div class="meta">${S[lang].range(start,end)}</div></div>
          <div class="meta">${degree||''}${gpa?` â€” GPA: ${gpa}`:''}</div>
          ${details?`<div class="desc">${bullets(details)}</div>`:''}
        </div>
      `);
    }
  });
}

function renderSkills(){
  const tags = (f.skills.value||'').split(',').map(s=>s.trim()).filter(Boolean);
  const cvSkillTags = $('#cvSkillTags'); cvSkillTags.innerHTML='';
  if(tags.length===0){ cvSkillTags.innerHTML='<span class="muted">â€¦</span>'; }
  else tags.forEach(t=>cvSkillTags.insertAdjacentHTML('beforeend', `<span class="tag">${t}</span>`));
}
function renderLangs(arrs){
  const cvLangList = $('#cvLangList'); cvLangList.innerHTML='';
  if(arrs.length===0){ cvLangList.innerHTML='<div class="muted">â€¦</div>'; return; }
  arrs.forEach(a=>{
    const [name, level] = [a[0],a[1]||''];
    cvLangList.insertAdjacentHTML('beforeend', `<div class="langRow"><b>${name||'Language'}</b><span class="muted">${level}</span></div>`);
  });
}
function renderCerts(arrs){
  const cvCertList = $('#cvCertList'); cvCertList.innerHTML='';
  if(arrs.length===0){ cvCertList.innerHTML='<div class="muted">â€¦</div>'; return; }
  arrs.forEach(a=>{
    const [name, issuer, year] = [a[0],a[1],a[2]];
    cvCertList.insertAdjacentHTML('beforeend', `
      <div class="item"><div class="top"><div>${name||'Certificate'}</div><div class="meta">${year||''}</div></div>
      <div class="meta">${issuer||''}</div></div>
    `);
  });
}

/* ================== Build CV Node per language ================== */
function makeCVNode(lang='ar'){
  const src = $('#cvPage').cloneNode(true);
  // headings
  src.querySelectorAll('[data-i18n]').forEach(el=>{
    const key = el.getAttribute('data-i18n');
    el.textContent = S[lang][key];
  });
  // header
  const name = f.name.value || (lang==='ar'? S.ar.name : S.en.name);
  const role = f.role.value || (lang==='ar'? S.ar.role : S.en.role);
  const sum  = f.summary.value || (lang==='ar'? S.ar.summary : S.en.summary);

  const auto = autoTranslateSel.value==='on';
  const tr = (t)=> auto ? (lang==='en'? translateText(t,'en') : translateText(t,'ar')) : t;

  src.querySelector('#cvName').textContent   = lang==='en' ? tr(name) : tr(name);
  src.querySelector('#cvRole').textContent   = lang==='en' ? tr(role) : tr(role);
  src.querySelector('#cvSummary').textContent= lang==='en' ? tr(sum)  : tr(sum);

  // contact chips (translate location mainly)
  const chips = {
    cEmail: f.email.value, cPhone: f.phone.value, cLoc: f.loc.value,
    cLinkedin: f.linkedin.value?'LinkedIn':'', cSite: f.site.value?'Website':''
  };
  Object.entries(chips).forEach(([id,val])=>{
    const el = src.querySelector('#'+id);
    if(!el) return;
    if(!val){ el.style.display='none'; return; }
    if(id==='cLoc' && val){ el.innerHTML = `ğŸ“ <b>${lang==='en'? translateText(val,'en'): translateText(val,'ar')}</b>`; }
    else if(id==='cEmail'){ el.innerHTML = `âœ‰ï¸ <b>${val}</b>`; }
    else if(id==='cPhone'){ el.innerHTML = `ğŸ“ <b>${val}</b>`; }
    else if(id==='cLinkedin'){ el.innerHTML = `ğŸ”— <b>${lang==='en'?'LinkedIn':'Ù„ÙŠÙ†ÙƒØ¯Ø¥Ù†'}</b>`; }
    else if(id==='cSite'){ el.innerHTML = `ğŸŒ <b>${lang==='en'?'Website':'Ù…ÙˆÙ‚Ø¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ'}</b>`; }
    el.style.display='inline-flex';
  });

  // direction + fonts
  src.setAttribute('dir', lang==='ar'?'rtl':'ltr');
  src.setAttribute('lang', lang);

  // translate body lists
  function trBullets(txt){ return auto ? translateText(bullets(txt), lang==='en'?'en':'ar') : bullets(txt); }

  // Experience
  const cvExp = src.querySelector('#cvExp'); cvExp.innerHTML = `<h3>${S[lang].exp}</h3>`;
  readBlocks(expList).forEach(a=>{
    const [title, company, from, to, place, desc] = [a[0],a[1],a[2],a[3],a[4],a[5]||''];
    const titleT = auto? translateText(title, lang): title;
    const companyT = auto? translateText(company, lang): company;
    const placeT = auto? translateText(place, lang): place;
    cvExp.insertAdjacentHTML('beforeend', `
      <div class="item">
        <div class="top"><div>${(titleT||'')}${companyT?` <span class="accentDot"></span> ${companyT}`:''}</div><div class="meta">${S[lang].range(from,to)}</div></div>
        <div class="meta">${placeT||''}</div>
        <div class="desc">${trBullets(desc)}</div>
      </div>
    `);
  });
  if(!expList.children.length) cvExp.insertAdjacentHTML('beforeend', `<div class="item muted">â€”</div>`);

  // Projects
  const cvProj = src.querySelector('#cvProj'); cvProj.innerHTML = `<h3>${S[lang].projects}</h3>`;
  readBlocks(projList).forEach(a=>{
    const [name, techs, link, desc] = [a[0],a[1],a[2],a[3]||''];
    const nameT = auto? translateText(name, lang): name;
    const techsT= auto? translateText(techs, lang): techs;
    cvProj.insertAdjacentHTML('beforeend', `
      <div class="item">
        <div class="top"><div>${nameT||''}</div><div class="meta">${techsT||''}</div></div>
        <div class="desc">${trBullets(desc)}${link?` â€” <a href="${link}" target="_blank" rel="noopener" style="color:var(--accent);font-weight:800">${link}</a>`:''}</div>
      </div>
    `);
  });
  if(!projList.children.length) cvProj.insertAdjacentHTML('beforeend', `<div class="item muted">â€”</div>`);

  // Education
  const cvEdu = src.querySelector('#cvEdu'); cvEdu.innerHTML = `<h3>${S[lang].education}</h3>`;
  readBlocks(eduList).forEach(a=>{
    const [org, degree, start, end, gpa, details] = [a[0],a[1],a[2],a[3],a[4],a[5]||''];
    const orgT = auto? translateText(org, lang): org;
    const degreeT = auto? translateText(degree, lang): degree;
    cvEdu.insertAdjacentHTML('beforeend', `
      <div class="item">
        <div class="top"><div>${orgT||''}</div><div class="meta">${S[lang].range(start,end)}</div></div>
        <div class="meta">${degreeT||''}${gpa?` â€” ${lang==='en'?'GPA':'Ø§Ù„Ù…Ø¹Ø¯Ù„'}: ${gpa}`:''}</div>
        ${details?`<div class="desc">${trBullets(details)}</div>`:''}
      </div>
    `);
  });
  if(!eduList.children.length) cvEdu.insertAdjacentHTML('beforeend', `<div class="item muted">â€”</div>`);

  // Skills
  const skills = (f.skills.value||'').split(',').map(s=>s.trim()).filter(Boolean);
  const cvSkillTags = src.querySelector('#cvSkillTags'); cvSkillTags.innerHTML='';
  if(skills.length===0){ cvSkillTags.innerHTML='<span class="muted">â€¦</span>'; }
  else skills.forEach(t=>{
    const t2 = auto? translateText(t, lang): t;
    cvSkillTags.insertAdjacentHTML('beforeend', `<span class="tag">${t2}</span>`);
  });

  // Languages
  const cvLangList = src.querySelector('#cvLangList'); cvLangList.innerHTML='';
  const langs = readBlocks(langList);
  if(langs.length===0){ cvLangList.innerHTML='<div class="muted">â€¦</div>'; }
  else langs.forEach(a=>{
    const [name, level] = [a[0],a[1]||''];
    const nameT = auto? translateText(name, lang): name;
    const levelT = auto? translateText(level, lang): level;
    cvLangList.insertAdjacentHTML('beforeend', `<div class="langRow"><b>${nameT||''}</b><span class="muted">${levelT}</span></div>`);
  });

  // Certs
  const cvCertList = src.querySelector('#cvCertList'); cvCertList.innerHTML='';
  const certs = readBlocks(certList);
  if(certs.length===0){ cvCertList.innerHTML='<div class="muted">â€¦</div>'; }
  else certs.forEach(a=>{
    const [name, issuer, year] = [a[0],a[1],a[2]];
    const nameT = auto? translateText(name, lang): name;
    const issuerT = auto? translateText(issuer, lang): issuer;
    cvCertList.insertAdjacentHTML('beforeend', `
      <div class="item"><div class="top"><div>${nameT||''}</div><div class="meta">${year||''}</div></div>
      <div class="meta">${issuerT||''}</div></div>
    `);
  });

  // ensure photo present in clone
  const srcPhoto = $('#cvPhoto'); const dstPhoto = src.querySelector('#cvPhoto');
  if(srcPhoto && srcPhoto.src){ dstPhoto.src = srcPhoto.src; dstPhoto.style.display='block'; } else { dstPhoto.style.display='none'; }

  return src;
}

/* ================== Export ================== */
function exportWord(lang='ar'){
  const cv = makeCVNode(lang);
  cv.style.border='none'; cv.style.boxShadow='none'; cv.style.width='100%'; cv.style.minHeight='auto';
  const html = `<!DOCTYPE html>
<html lang="${lang}" dir="${lang==='ar'?'rtl':'ltr'}">
<head><meta charset="utf-8"><title>CV</title>
<style>
  body{font-family:"Tajawal",sans-serif;color:#111827;direction:${lang==='ar'?'rtl':'ltr'};line-height:1.6}
  h2{font-family:"Reem Kufi",sans-serif}
  a{color:#0ea5a6}
  .cv-page{width:100%}
</style>
</head>
<body>${cv.outerHTML}</body></html>`;
  const blob = new Blob([html], {type:'application/msword'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const fname = (f.name.value|| (lang==='ar'?'Ø³ÙŠØ±Ø©_Ø°Ø§ØªÙŠØ©':'CV')).replace(/\s+/g,'_');
  a.href = url; a.download = `${fname}-${lang.toUpperCase()}.doc`; document.body.appendChild(a); a.click(); a.remove();
  URL.revokeObjectURL(url);
}

function exportPDF(lang='ar'){
  const cv = makeCVNode(lang);
  const w = window.open('', '_blank');
  const html = `<!DOCTYPE html>
<html lang="${lang}" dir="${lang==='ar'?'rtl':'ltr'}">
<head><meta charset="utf-8"><title>CV ${lang.toUpperCase()}</title>
<link href="https://fonts.googleapis.com/css2?family=Reem+Kufi:wght@600&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root{--accent:${f.accent.value||'#0ea5a6'}}
  body{margin:0;font-family:"Tajawal",sans-serif;background:#fff;color:#111827}
  .cv-page{width:210mm;min-height:297mm;margin:auto}
  .cv-head{display:grid;grid-template-columns:1fr 140px;gap:16px;padding:22px 22px 0}
  .cv-name{margin:0;font-family:"Reem Kufi",sans-serif;font-size:28px}
  .cv-role{margin:6px 0 10px;font-weight:800;color:#0b3b3a}
  .cv-summary{color:#334155;line-height:1.8;white-space:pre-line}
  .cv-photo{width:120px;height:120px;border-radius:14px;border:2px solid var(--accent);object-fit:cover;justify-self:end;background:#f1f5f9}
  .cv-contact{display:flex;flex-wrap:wrap;gap:8px;margin:14px 22px 0}
  .chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:1px solid #e5e7eb;border-radius:999px;background:#f8fafc;font-weight:700}
  .cv-cols{display:grid;grid-template-columns:1.1fr .9fr;gap:16px;padding:14px 22px 22px}
  .sec{margin-top:8px}
  .sec h3{margin:0 0 8px;font-size:15px;color:#0f172a;border-bottom:2px solid var(--accent);display:inline-block;padding-bottom:2px}
  .item{margin:10px 0}
  .item .top{display:flex;justify-content:space-between;font-weight:800}
  .item .meta{color:#475569;font-size:.92rem}
  .item .desc{margin-top:6px;color:#334155;white-space:pre-line}
  .tags{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .tag{padding:6px 10px;border-radius:999px;background:#eef6ff;border:1px solid #dbeafe;font-weight:800}
  .langRow{display:flex;justify-content:space-between;border:1px dashed #e5e7eb;border-radius:10px;padding:8px 10px;margin-top:8px}
  @page{size:A4;margin:12mm}
</style>
</head>
<body>${cv.outerHTML}
<script>window.onload=()=>setTimeout(()=>window.print(),200);<\/script>
</body></html>`;
  w.document.open(); w.document.write(html); w.document.close();
}

/* Buttons */
$('#btnWord_AR').onclick = ()=>exportWord('ar');
$('#btnWord_EN').onclick = ()=>exportWord('en');
$('#btnPDF_AR').onclick  = ()=>exportPDF('ar');
$('#btnPDF_EN').onclick  = ()=>exportPDF('en');

/* Clear */
$('#btnClear').onclick = ()=>{
  if(!confirm('ØªÙØ±ÙŠØº Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ØŸ / Clear all fields?')) return;
  $$('input, textarea').forEach(el=>{
    if(el.type==='color') return;
    if(el.type==='file'){ el.value=''; return; }
    el.value='';
  });
  expList.innerHTML=''; eduList.innerHTML=''; projList.innerHTML='';
  langList.innerHTML=''; certList.innerHTML='';
  $('#cvPhoto').src=''; $('#cvPhoto').style.display='none'; photoPrev.src='';
  renderPreview();
};

/* ====== Demo data & initial render ====== */
addExp({0:'Frontend Developer',1:'Modern Tech Co.',2:'09/2022',3:'Present',4:'Manama, Bahrain',5:'Built interactive dashboards.\nImproved performance by 35%.\nLed RTL accessibility.'});
addEdu({0:'University of Bahrain',1:'B.Sc. Computer Science',2:'2018',3:'2022',4:'3.6 / 4',5:'Capstone: Task tracking system using React.'});
addProj({0:'CV Builder',1:'HTML, CSS, JS',2:'',3:'Bilingual CV generator (RTL/LTR) with PDF/Word export.'});
addLang({0:'Arabic',1:'Fluent'});
addLang({0:'English',1:'Advanced'});
addCert({0:'Google Data Analytics',1:'Google',2:'2024'});

f.name.value='Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù‡Ù†Ø§ / Your Full Name';
f.role.value='Ù…Ø·ÙˆÙ‘Ø± ÙˆØ§Ø¬Ù‡Ø§Øª / Frontend Developer';
f.loc.value='Ø§Ù„Ù…Ù†Ø§Ù…Ø©ØŒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† / Manama, Bahrain';
f.email.value='you@example.com';
f.phone.value='+973 â€¦';
f.summary.value='Ù…Ø®ØªØµ Ø¨ØªØ·ÙˆÙŠØ± Ø§Ù„ÙˆÙŠØ¨ (RTL) ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡.\nWeb developer focused on performance & UX.';
f.accent.value='#0ea5a6';
f.skills.value='HTML, CSS, JavaScript, React, Git, Figma';

renderPreview();
</script>
</body>
</html>
