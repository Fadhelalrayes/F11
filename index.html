<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>حاسبة الصلوات الفائتة | حساب وقضاء الصلوات</title>
    <meta name="description" content="أداة لحساب عدد الصلوات التي فاتتك، وتحديد سن التكليف، ومساعدتك على تنظيم قضائها. يمكنك طباعة النتائج لمتابعة تقدمك.">
    <meta name="keywords" content="قضاء الصلاة, حساب الصلوات الفائتة, جدول قضاء الصلوات, الصلاة الفائتة, سن التكليف الشرعي, طباعة جدول الصلاة">
    <meta name="author" content="Manus">
    <meta name="robots" content="index, follow">

    <!-- Google Fonts: Tajawal -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <style>
        :root { --primary-color: #0d1b2a; --secondary-color: #2a9d8f; --background-color: #f5f7fa; --text-color: #495057; --heading-color: #1b263b; --white-color: #FFFFFF; --danger-color: #e76f51; --info-color: #2196F3; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Tajawal', sans-serif; margin: 0; line-height: 1.8; background-color: var(--background-color); color: var(--text-color); font-weight: 400; }
        .container { max-width: 800px; margin: auto; padding: 0 25px; }
        h1, h2 { font-weight: 700; color: var(--heading-color); text-align: center; }
        
        h1 { font-size: 2.8rem; font-weight: 800; margin-bottom: 10px; }
        h2 { font-size: 2rem; margin-bottom: 40px; color: var(--secondary-color); }
        section { padding: 60px 0; }
        
        .calculator-section { background: var(--white-color); padding: 40px; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: 700; margin-bottom: 8px; color: var(--heading-color); }
        .form-group input, .form-group select { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #ddd; font-family: 'Tajawal', sans-serif; font-size: 1rem; box-sizing: border-box; transition: border-color 0.3s; }
        .form-group input:focus, .form-group select:focus { border-color: var(--secondary-color); outline: none; }
        
        .full-width { grid-column: 1 / -1; }
        
        .calc-button { width: 100%; padding: 15px; background: var(--secondary-color); color: var(--white-color); border: none; border-radius: 8px; cursor: pointer; font-size: 1.2rem; font-weight: 700; transition: all 0.3s; margin-top: 20px; }
        .calc-button:hover { background-color: #248a7e; }

        .results-section { margin-top: 40px; background-color: #e9f5f3; padding: 30px; border-radius: 10px; border: 2px solid var(--secondary-color); display: none; /* Hidden by default */ }
        .results-section h3 { text-align: center; margin-top: 0; font-size: 1.8rem; }
        
        .results-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .results-table th, .results-table td { padding: 12px 15px; text-align: right; border-bottom: 1px solid #ccc; }
        .results-table th { background-color: var(--primary-color); color: var(--white-color); font-weight: 700; }
        .results-table td { font-size: 1.1rem; }
        .results-table tr:last-child td { border-bottom: none; }
        .total-row td { font-weight: 800; color: var(--danger-color); font-size: 1.2rem !important; }
        .info-row td { font-weight: 700; color: var(--info-color); }

        .print-button { display: block; width: 250px; margin: 25px auto 0; padding: 12px; background: var(--primary-color); color: var(--white-color); border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: 700; transition: all 0.3s; }
        .print-button:hover { background-color: #1b263b; }
        .print-button i { margin-left: 8px; }

        .main-footer { background-color: var(--primary-color); color: var(--white-color); text-align: center; padding: 20px 0; margin-top: 60px; }
        .main-footer p { margin: 0; opacity: 0.7; }

        @media (max-width: 768px) {
            h1 { font-size: 2.2rem; }
            .form-grid { grid-template-columns: 1fr; }
        }
        
        /* Print Styles */
        @media print {
            body { background-color: var(--white-color); color: #000; }
            .calculator-section, .main-footer, .print-button, #prayer-form { display: none; }
            section { padding: 0; }
            .results-section { display: block !important; box-shadow: none; border: none; margin-top: 0; padding: 0; background-color: transparent; }
            .container { max-width: 100%; padding: 0; }
            h1 { font-size: 2rem; color: #000; }
            p { color: #333; }
            .results-table th { background-color: #eee !important; color: #000 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .results-table, .results-table th, .results-table td { border: 1px solid #ccc; }
            .total-row td, .info-row td { color: #000 !important; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <h1>حاسبة قضاء الصلوات الفائتة</h1>
            <p style="text-align: center; max-width: 600px; margin: 0 auto 40px;">أداة لمساعدتك على معرفة عدد الصلوات التي عليك قضاؤها وتنظيم جدول لذلك.</p>
        </div>
    </header>

    <main>
        <section id="calculator">
            <div class="container">
                <div class="calculator-section">
                    <form id="prayer-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="birth-date">تاريخ الميلاد</label>
                                <input type="date" id="birth-date" name="birth_date" required>
                            </div>
                            <div class="form-group">
                                <label for="gender">الجنس</label>
                                <select id="gender" name="gender" required>
                                    <option value="" disabled selected>اختر الجنس</option>
                                    <option value="male">ذكر</option>
                                    <option value="female">أنثى</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="start-miss-date">منذ متى تركت الصلاة؟ (تاريخ البداية)</label>
                                <input type="date" id="start-miss-date" name="start_miss_date" required>
                            </div>
                            <div class="form-group">
                                <label for="prayers-made-up">كم صلاة قضيت حتى الآن؟ (تقريبي)</label>
                                <input type="number" id="prayers-made-up" name="prayers_made_up" value="0" min="0" required>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <button type="submit" class="calc-button"><i class="fas fa-calculator"></i> احسب الصلوات الفائتة</button>
                        </div>
                    </form>

                    <div id="results" class="results-section">
                        <h3>ملخص حساب الصلوات</h3>
                        <table class="results-table">
                            <tbody>
                                <tr class="info-row">
                                    <td>سن التكليف الشرعي (البلوغ)</td>
                                    <td id="takleef-age">0</td>
                                </tr>
                                <tr class="info-row">
                                    <td>تاريخ بدء التكليف الشرعي</td>
                                    <td id="takleef-date">0</td>
                                </tr>
                                <tr class="info-row">
                                    <td>إجمالي الصلوات المفروضة عليك</td>
                                    <td id="total-obligatory-prayers">0</td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="text-align: center; padding-top: 20px; font-weight: bold; background-color: #ddd;">الصلوات الفائتة المتبقية</td>
                                </tr>
                                <tr>
                                    <td>الفجر</td>
                                    <td id="fajr-missed">0</td>
                                </tr>
                                <tr>
                                    <td>الظهر</td>
                                    <td id="dhuhr-missed">0</td>
                                </tr>
                                <tr>
                                    <td>العصر</td>
                                    <td id="asr-missed">0</td>
                                </tr>
                                <tr>
                                    <td>المغرب</td>
                                    <td id="maghrib-missed">0</td>
                                </tr>
                                <tr>
                                    <td>العشاء</td>
                                    <td id="isha-missed">0</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>الإجمالي المتبقي للقضاء</strong></td>
                                    <td id="total-missed"><strong>0</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        <p id="female-notice" style="text-align: center; font-size: 0.9rem; margin-top: 15px; display: none;">ملاحظة: تم خصم ما يقارب 10 أيام شهرياً كفترة عذر شرعي للمرأة.</p>
                        <button id="print-button" class="print-button"><i class="fas fa-print"></i> طباعة / حفظ كـ PDF</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="container">
            <p>&copy; 2025 حاسبة قضاء الصلوات. نسأل الله لنا ولكم القبول.</p>
        </div>
    </footer>

    <script>
        document.getElementById('prayer-form').addEventListener('submit', function(event) {
            event.preventDefault();

            // جمع البيانات
            const birthDate = new Date(document.getElementById('birth-date').value);
            const gender = document.getElementById('gender').value;
            const startMissDate = new Date(document.getElementById('start-miss-date').value);
            const prayersMadeUp = parseInt(document.getElementById('prayers-made-up').value) || 0;
            const today = new Date();
            const locale = 'ar-EG';

            // حساب سن وتاريخ التكليف
            const ageOfTakleefDate = new Date(birthDate);
            ageOfTakleefDate.setFullYear(birthDate.getFullYear() + 15);
            
            // حساب إجمالي الصلوات المفروضة
            let totalObligatoryPrayers = 0;
            if (ageOfTakleefDate < today) {
                const daysSinceTakleef = Math.floor((today.getTime() - ageOfTakleefDate.getTime()) / (1000 * 3600 * 24));
                totalObligatoryPrayers = daysSinceTakleef * 5;
                if (gender === 'female') {
                    const monthsSinceTakleef = daysSinceTakleef / 30.44;
                    const periodDays = Math.floor(monthsSinceTakleef * 10);
                    totalObligatoryPrayers -= periodDays * 5;
                }
            }
            totalObligatoryPrayers = Math.max(0, Math.floor(totalObligatoryPrayers));

            // حساب الصلوات الفائتة
            const calculationStartDate = startMissDate > ageOfTakleefDate ? startMissDate : ageOfTakleefDate;
            let totalMissedPrayers = 0;
            if (calculationStartDate < today) {
                const daysMissed = Math.floor((today.getTime() - calculationStartDate.getTime()) / (1000 * 3600 * 24));
                totalMissedPrayers = daysMissed * 5;
                
                if (gender === 'female') {
                    const monthsMissed = daysMissed / 30.44;
                    const periodDays = Math.floor(monthsMissed * 10);
                    totalMissedPrayers -= periodDays * 5;
                    document.getElementById('female-notice').style.display = 'block';
                } else {
                    document.getElementById('female-notice').style.display = 'none';
                }
            }
            totalMissedPrayers = Math.max(0, Math.floor(totalMissedPrayers));

            // حساب المتبقي
            const remainingPrayers = Math.max(0, totalMissedPrayers - prayersMadeUp);
            const remainingPerPrayer = Math.ceil(remainingPrayers / 5);

            // عرض النتائج
            document.getElementById('takleef-age').textContent = "15 سنة (تقريبًا)";
            document.getElementById('takleef-date').textContent = ageOfTakleefDate.toLocaleDateString(locale, { year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('total-obligatory-prayers').textContent = totalObligatoryPrayers.toLocaleString(locale);
            
            document.getElementById('fajr-missed').textContent = remainingPerPrayer.toLocaleString(locale);
            document.getElementById('dhuhr-missed').textContent = remainingPerPrayer.toLocaleString(locale);
            document.getElementById('asr-missed').textContent = remainingPerPrayer.toLocaleString(locale);
            document.getElementById('maghrib-missed').textContent = remainingPerPrayer.toLocaleString(locale);
            document.getElementById('isha-missed').textContent = remainingPerPrayer.toLocaleString(locale);
            document.getElementById('total-missed').textContent = remainingPrayers.toLocaleString(locale);
            
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
        });

        // تفعيل زر الطباعة
        document.getElementById('print-button').addEventListener('click', function() {
            window.print();
        });
    </script>

</body>
</html>
