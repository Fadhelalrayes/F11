<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±</title>

<!-- Ø®Ø·ÙˆØ· Ø§Ø­ØªØ±Ø§ÙÙŠØ© -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#0e0f12; --fg:#f7f7f7; --muted:#bdbdbd;
    --brand:#ffd54a; --card:#16181f; --stroke:#2a2e38;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--fg);
    font-family:"Tajawal","Cairo",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  }
  header{
    position:sticky; top:0; z-index:10; background:rgba(14,15,18,.9);
    backdrop-filter:saturate(140%) blur(6px);
    border-bottom:1px solid var(--stroke); padding:14px 16px;
    display:flex; align-items:center; justify-content:space-between
  }
  .brand{display:flex; align-items:center; gap:14px}
  .logo{width:44px;height:44px;border-radius:50%;border:2px solid var(--brand);display:grid;place-items:center}
  .logo span{width:12px;height:12px;border-radius:50%;border:2px solid var(--brand)}
  .title{
    font-weight:800; letter-spacing:.3px; line-height:1;
    font-size: clamp(30px, 5vw, 46px); color:var(--brand)
  }
  .container{max-width:900px;margin:0 auto;padding:18px 16px}
  .card{
    background:var(--card); border:1px solid var(--stroke); border-radius:18px; padding:18px; margin:14px 0;
    box-shadow:0 10px 30px rgba(0,0,0,.2)
  }
  h1,h2{color:var(--brand); margin:10px 0 8px}
  .muted{color:var(--muted)}
  label{display:block; margin:10px 0 6px; color:#eaeaea; font-size:14px}
  input,select,button{
    width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--stroke);
    background:#0f1117; color:var(--fg); font-size:16px; outline:none
  }
  input:focus, select:focus{border-color:var(--brand); box-shadow:0 0 0 3px rgba(255,213,74,.15)}
  .grid{display:grid; grid-template-columns:1fr 1fr; gap:12px}
  @media (max-width:640px){ .grid{grid-template-columns:1fr} }
  .btn{
    border:0; background:linear-gradient(135deg, var(--brand), #ffb300);
    color:#221; font-weight:800; cursor:pointer; transition:transform .08s ease, filter .2s ease; letter-spacing:.2px
  }
  .btn:active{transform:scale(.99)}
  .ghost{background:transparent; border:1px solid var(--brand); color:var(--brand)}
  .danger{background:#1b0f0f;border:1px solid #6a2e2e;color:#ffb9b9}
  .center{display:grid; place-items:center}
  .hidden{display:none !important}
  .topic-grid{display:grid; grid-template-columns:repeat(2,1fr); gap:14px}
  .topic{padding:18px; border:1px dashed var(--brand); border-radius:14px; background:#0f1117; cursor:pointer}
  .topic:hover{background:#121520}
  .topic span{display:block; color:var(--muted); font-size:14px; margin-top:4px}
  .result{line-height:1.95}
  .tag{display:inline-block; padding:4px 10px; border-radius:999px; border:1px solid var(--stroke); color:var(--muted); font-size:13px}
  footer{padding:26px 16px; text-align:center; color:var(--muted); border-top:1px solid var(--stroke)}
  /* Loading ring */
  .ring-wrap{height:240px; display:grid; place-items:center}
  .ring{
    width:130px; height:130px; border-radius:50%;
    border:6px solid rgba(255,255,255,.08); border-top-color:var(--brand);
    animation:spin 1.2s linear infinite; position:relative
  }
  .ring:after{
    content:""; position:absolute; inset:16px; border-radius:50%;
    border:4px dashed rgba(255,255,255,.12)
  }
  @keyframes spin{to{transform:rotate(360deg)}}
  ul{margin:8px 0 0 0; padding:0 18px}
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo" aria-hidden="true"><span></span></div>
    <div class="title">Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±</div>
  </div>
  <button class="danger" id="clearBtn" title="Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©">Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§ØªÙŠ</button>
</header>

<main class="container">

  <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
  <section id="step1" class="card">
    <h1>Ø§Ø¨Ø¯Ø£ Ù‚Ø±Ø§Ø¡ØªÙƒ</h1>
    <p class="muted">Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ØªÙØ­ÙÙØ¸ Ù…Ø­Ù„ÙŠÙ‘Ù‹Ø§ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ ÙÙ‚Ø·.</p>
    <div class="grid">
      <div>
        <label>Ø§Ù„Ø¹Ù…Ø±</label>
        <input id="age" type="number" min="5" max="120" placeholder="Ù…Ø«Ø§Ù„: 43">
      </div>
      <div>
        <label>Ø§Ù„Ø¬Ù†Ø³</label>
        <select id="gender">
          <option value="">Ø§Ø®ØªØ±</option>
          <option>Ø°ÙƒØ±</option>
          <option>Ø£Ù†Ø«Ù‰</option>
        </select>
      </div>
      <div>
        <label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</label>
        <select id="status">
          <option value="">Ø§Ø®ØªØ±</option>
          <option>Ø£Ø¹Ø²Ø¨/Ø¹Ø²Ø¨Ø§Ø¡</option>
          <option>Ù…ØªØ²ÙˆØ¬/Ù…ØªØ²ÙˆØ¬Ø©</option>
          <option>Ù…Ù†ÙØµÙ„/Ù…Ù†ÙØµÙ„Ø©</option>
          <option>Ù…Ø®Ø·ÙˆØ¨/Ù…Ø®Ø·ÙˆØ¨Ø©</option>
        </select>
      </div>
      <div>
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
        <input id="birthdate" type="date">
      </div>
    </div>
    <div style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap">
      <button class="btn" id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</button>
      <button class="ghost" id="shuffleDemo">Ù‚Ø±Ø§Ø¡Ø© ÙÙˆØ±ÙŠØ© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
    </div>
  </section>

  <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø´Ø§Ø´Ø© Ø§Ù†ØªØ¸Ø§Ø± -->
  <section id="stepLoading" class="card hidden center">
    <div>
      <div class="ring-wrap"><div class="ring" aria-hidden="true"></div></div>
      <h2>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±â€¦</h2>
      <p class="muted">Ù„Ø­Ø¸Ø§Øª Ù‚Ù„ÙŠÙ„Ø© Ù‚Ø¨Ù„ Ø¸Ù‡ÙˆØ± Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª.</p>
    </div>
  </section>

  <!-- Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ -->
  <section id="stepTopics" class="card hidden">
    <h2>Ø§Ø®ØªØ± Ù…ÙˆØ¶ÙˆØ¹ Ù‚Ø±Ø§Ø¡ØªÙƒ</h2>
    <div class="topic-grid">
      <button class="topic" data-topic="love">Ø§Ù„Ø­Ø¨ â¤ï¸<span>Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§ØªØŒ Ø§Ù„Ø§Ù†Ø¬Ø°Ø§Ø¨ØŒ Ø§Ù„Ù…ØµØ§Ù„Ø­Ø§Øª</span></button>
      <button class="topic" data-topic="health">Ø§Ù„ØµØ­Ø© ğŸ’Š<span>Ø§Ù„Ø·Ø§Ù‚Ø©ØŒ Ø§Ù„Ø¹Ø§Ø¯Ø§ØªØŒ Ø§Ù„ØªÙˆØ§Ø²Ù†</span></button>
      <button class="topic" data-topic="career">Ø§Ù„Ù…Ù‡Ù†Ø©/Ø§Ù„Ø«Ø±ÙˆØ© ğŸ’¼<span>Ø§Ù„ÙØ±ØµØŒ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§ØªØŒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª</span></button>
      <button class="topic" data-topic="general">Ø¹Ø§Ù… âœ¨<span>Ø±Ø¤ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ù‚Ø¨Ù„Ø©</span></button>
    </div>
  </section>

  <!-- Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
  <section id="stepResult" class="card hidden">
    <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap">
      <h2 style="margin:0">Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©</h2>
      <div class="tag" id="userEcho"></div>
    </div>

    <div id="resultText" class="result" style="margin-top:10px"></div>
    <div id="omen" class="muted" style="margin-top:12px; font-size:15px"></div>

    <div style="display:flex; gap:10px; margin-top:16px; flex-wrap:wrap">
      <button class="btn" id="againBtn">Ø¥Ø´Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ù†ÙØ³ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹)</button>
      <button class="ghost" id="topicsBtn">Ø§Ø®ØªÙŠØ§Ø± Ù…ÙˆØ¶ÙˆØ¹ Ø¢Ø®Ø±</button>
      <button class="ghost" id="restartBtn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¨Ø¯Ø¡</button>
    </div>
  </section>

</main>

<footer>
  Â© <span id="year"></span> Ø§Ù„Ø§Ø³ØªØ¨ØµØ§Ø±
</footer>

<script>
  // ========= Ù‚ÙˆØ§Ø¦Ù… Ø¨Ø£Ø³Ù„ÙˆØ¨ ØªÙ†Ø¨Ø¤ÙŠ ÙˆØªØ­Ø°ÙŠØ±ÙŠ (Ù…Ø®Ø§Ø·Ø¨Ø© Ù…Ø¨Ø§Ø´Ø±Ø©) =========
  // Ù…Ù„Ø§Ø­Ø¸Ø©: ØªÙ…Øª ØµÙŠØ§ØºØªÙ‡Ø§ Ø¨Ø±ÙˆØ­ ØªÙˆÙ‚Ø¹Ø§Øª Ù‚ÙˆÙŠØ© ÙˆØªØ­Ø°ÙŠØ±Ø§Øª Ù…ÙˆØ¬Ø²Ø©.
  const LOVE_P = [
    "ØªÙ„ÙˆØ­ Ø¹Ù†Ø¯Ùƒ Ù…ØµØ§Ø¯ÙØ© ØªØºÙŠÙ‘Ø± Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ù„Ø¨. ÙˆØ¬Ù‡ÙŒ Ù…Ø£Ù„ÙˆÙ ÙŠØ¹ÙˆØ¯ ÙØ¬Ø£Ø©ØŒ ÙˆÙƒÙ„Ù…Ø© ÙˆØ§Ø­Ø¯Ø© ØªØ¹ÙŠØ¯ Ø­Ø±Ø§Ø±Ø© Ù‚Ø¯ÙŠÙ…Ø©.",
    "Ø£Ù†Øª Ø¹Ù„Ù‰ Ù…ÙˆØ¹Ø¯ Ù…Ø¹ Ø§Ù†Ø¬Ø°Ø§Ø¨ ØºÙŠØ± Ù…Ø®Ø·Ø·ØŒ ÙŠÙ‚ØªØ±Ø¨ Ù…Ù†Ùƒ Ø´Ø®Øµ ÙŠÙ‚Ø±Ø£ ØµÙ…ØªÙƒ Ø£ÙƒØ«Ø± Ù…Ù† ÙƒÙ„Ø§Ù…Ùƒ.",
    "Ø¨ÙˆØ§Ø¨Ø© Ù…ØµØ§Ù„Ø­Ø© ØªÙÙØªØ­ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµØºÙŠØ±Ø©: Ø§Ø¨ØªØ³Ø§Ù…Ø©ØŒ Ø§Ø¹ØªØ°Ø§Ø±ØŒ Ø£Ùˆ Ù„Ù‚Ø§Ø¡ Ù‚ØµÙŠØ± ÙŠØ¨Ø¯Ø¯ Ø¶Ø¨Ø§Ø¨Ù‹Ø§ Ø·ÙˆÙŠÙ„Ø§Ù‹.",
    "Ø¹Ù„Ø§Ù…Ø© ØªÙˆØ§ÙÙ‚ Ù‚ÙˆÙŠØ© ØªØ¸Ù‡Ø± Ø­ÙŠÙ† ØªØªØ®Ù„Ù‰ Ø¹Ù† Ø§Ù„ØªØ±Ø¯Ø¯Ø› Ø§Ù„Ù‚Ù„Ø¨ ÙŠÙ…ÙŠÙ„ Ù„Ù…Ù† ÙŠÙ…Ù†Ø­Ùƒ Ø±Ø§Ø­Ø© Ù„Ø§ Ø¶Ø¬ÙŠØ¬Ù‹Ø§."
  ];
  const LOVE_W = [
    "Ø§Ø­Ø°Ø± Ù…Ù† ÙˆØ¹Ø¯Ù Ø³Ø±ÙŠØ¹ Ù„Ø§ ÙŠØ­Ù…Ù„ Ø¬Ø°ÙˆØ±Ù‹Ø§Ø› Ø¶ÙˆØ¡ÙŒ Ù„Ø§Ù…Ø¹ Ù‚Ø¯ ÙŠØ®Ø¨Ùˆ Ø¨Ø¹Ø¯ Ø£ÙŠØ§Ù….",
    "Ø±Ø³Ø§Ù„Ø© ØºØ§Ù…Ø¶Ø© Ù‚Ø¯ ØªÙØ´Ø¹Ù„ Ø¸Ù†Ù‘Ù‹Ø§Ø› Ù„Ø§ ØªØªØ¨Ø¹ Ø¥Ø´Ø§Ø¹Ø§ØªØŒ ÙØ¨Ø±ÙŠÙ‚Ù‡Ø§ Ù‚ØµÙŠØ±.",
    "Ù…Ø§Ø¶Ù ÙŠØ­Ø§ÙˆÙ„ Ø£Ù† ÙŠØ³ØªØ¹ÙŠØ¯ Ù…ÙƒØ§Ù†Ù‡ ÙÙŠ Ù„Ø­Ø¸Ø© Ø¶Ø¹ÙØ› Ù„Ø§ ØªØªØ±Ùƒ Ø§Ù„Ø­Ù†ÙŠÙ† ÙŠÙ‚ÙˆØ¯Ùƒ Ø¥Ù„Ù‰ Ø¯ÙˆØ±Ø© Ù…ÙÙ†Ù‡ÙÙƒØ©.",
    "ØºÙŠØ±Ø© Ø¹Ø§Ø¨Ø±Ø© Ø­ÙˆÙ„Ùƒ ØªØªØ­ÙˆÙ‘Ù„ Ø¥Ù„Ù‰ Ø§Ø®ØªØ¨Ø§Ø± ÙˆÙ„Ø§Ø¡Ø› Ù„Ø§ ØªØ³Ù…Ø­ Ù„Ù„Ø¢Ø®Ø±ÙŠÙ† Ø¨ÙƒØªØ§Ø¨Ø© Ù‚ØµØªÙƒ."
  ];

  const HEALTH_P = [
    "Ø·Ø§Ù‚Ø© Ù‡Ø§Ø¯Ø¦Ø© ØªØªØ³Ù„Ù„ Ø¥Ù„Ù‰ Ø¬Ø³Ø¯Ùƒ Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹Ø› Ø§Ù„Ù†ÙˆÙ… Ø§Ù„Ø¹Ù…ÙŠÙ‚ ÙŠØ¹ÙŠØ¯ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¯Ø§Ø®Ù„.",
    "ÙŠÙ‚Ø¸Ø© Ø¬Ø³Ø¯ÙŠØ© Ù…ÙØ§Ø¬Ø¦Ø©: ØªØ³ØªØ¹ÙŠØ¯ Ø®ÙØ© Ø§Ù„Ø­Ø±ÙƒØ©ØŒ ÙˆÙƒØ£Ù† Ø«ÙÙ‚ÙÙ„Ù‹Ø§ Ø·ÙˆÙŠÙ„Ø§Ù‹ ØªÙ„Ø§Ø´Ù‰.",
    "Ø±ÙŠØ§Ø­ Ø®ÙÙŠÙØ© Ù…Ù† Ø§Ù„ØªÙˆØ§Ø²Ù† ØªØ³Ø±ÙŠ ÙÙŠÙƒØ› ØªØªØµØ§Ù„Ø­ Ù…Ø¹ Ø¬Ø³Ø¯Ùƒ ÙˆØªØ³Ù…Ø¹ Ù‡Ù…Ø³Ù‡ Ø¬ÙŠØ¯Ù‹Ø§.",
    "ØªØ¨Ø¯Ù‘Ù„ÙŒ ÙÙŠ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ø¹ ÙŠÙ…Ù†Ø­Ùƒ ØµÙØ§Ø¡Ù‹ Ø°Ù‡Ù†ÙŠÙ‹Ø§ Ù†Ø§Ø¯Ø±Ù‹Ø§ØŒ ÙØªØ®Ù ÙˆØ·Ø£Ø© Ø§Ù„ØªÙˆØªØ±."
  ];
  const HEALTH_W = [
    "ØªØ­Ø°ÙŠØ± Ù‚ØµÙŠØ± Ø§Ù„Ù…Ø¯Ù‰: Ø¥Ø¬Ù‡Ø§Ø¯ ØºÙŠØ± Ù…Ø±Ø¦ÙŠ ÙŠØªØ±Ø§ÙƒÙ… Ø¥Ù† ØªØ¬Ø§Ù‡Ù„Øª Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø±Ù‡Ø§Ù‚.",
    "ØµØ¯Ø§Ø¹ Ù…ØªÙƒØ±Ø± ÙŠÙ‡Ù…Ø³ Ø¨Ø£Ù† Ø§Ù„Ø´Ø§Ø´Ø© Ø³Ø±Ù‚Øª Ù…Ù† Ø¹ÙŠÙ†ÙŠÙƒ Ù†ÙˆØ±Ù‹Ø§ Ø²Ø§Ø¦Ø¯Ù‹Ø§Ø› Ø®ÙÙ‘Ù Ø­Ø¯ØªÙ‡.",
    "Ø¥ÙŠÙ‚Ø§Ø¹ Ù…ØªØ³Ø±Ù‘Ø¹ ÙŠØ±Ù‡Ù‚ Ø§Ù„Ù†ÙØ³Ø› Ø¥Ù† Ø³Ù…Ø¹Øª Ø¯Ù‚Ù‘Ø§Øª Ù‚Ù„Ø¨Ùƒ Ø£Ø³Ø±Ø¹ Ù…Ù† Ø§Ù„Ø¹Ø§Ø¯Ø©ØŒ Ù‡Ø¯Ù‘Ø¦ Ø§Ù„Ø³ÙŠØ±.",
    "Ø¹ÙŠÙˆÙ†Ùƒ ØªØ·Ù„Ø¨ Ø§Ø³ØªØ±Ø§Ø­Ø©ØŒ ÙˆØ¥Ù† Ø£Ù†ÙƒØ±Ù’Øª. ØªØ¬Ø§Ù‡Ù„Ù Ø§Ù„Ù‡Ù…Ø³ Ø§Ù„ÙŠÙˆÙ… ÙŠØµÙŠØ± ØµØ±Ø§Ø®Ù‹Ø§ ØºØ¯Ù‹Ø§."
  ];

  const CAREER_P = [
    "ÙØ±ØµØ© ØªØªØ³Ù„Ù„ Ù…Ù† Ù‡Ø§Ù…Ø´ Ø¨Ø±ÙŠØ¯ÙƒØŒ ØªØ­Ù…Ù„ ØªÙˆÙ‚ÙŠØ¹Ù‹Ø§ ØµØºÙŠØ±Ù‹Ø§ ÙˆØªØ£Ø«ÙŠØ±Ù‹Ø§ ÙƒØ¨ÙŠØ±Ù‹Ø§.",
    "Ø£Ù†Øª Ø¹Ù„Ù‰ Ø¹ØªØ¨Ø© Ø§Ù†Ø¹Ø·Ø§ÙØ© Ù…Ù‡Ù†ÙŠØ©Ø› Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø°ÙŠ Ø¸Ù†Ù†ØªÙ‡ Ù…ØºÙ„Ù‚Ù‹Ø§ ÙŠØªØ­Ø±Ùƒ ÙØ¬Ø£Ø©.",
    "Ø£Ø«Ø± Ù‡Ø§Ø¯Ø¦ Ù„Ø¹Ù…Ù„Ùƒ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙŠØ¸Ù‡Ø± Ø§Ù„Ø¢Ù†: Ø¥Ø´Ø§Ø¯Ø©ØŒ ØªØ±Ø´ÙŠØ­ØŒ Ø£Ùˆ Ø§Ù‚ØªØ±Ø§Ø­ Ù…ÙØ§Ø¬Ø¦.",
    "Ø¨ÙˆØµÙ„Ø© Ø§Ù„Ù…Ø§Ù„ ØªÙ…ÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø¨Ø¹Ø¯ ØªØ°Ø¨Ø°Ø¨ØŒ ÙˆØ¥Ø´Ø§Ø±Ø© Ø±Ø¨Ø­ Ø®Ø§ÙØªØ© ØªÙˆÙ…Ø¶."
  ];
  const CAREER_W = [
    "ØªØ­Ø°ÙŠØ± Ù…Ù† Ø¨Ù†Ø¯Ù Ù…Ø®ÙÙŠÙ‘ ÙÙŠ Ø§ØªÙØ§Ù‚ Ù…ÙØºØ±ÙØ› Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ Ù‚Ø¯ ÙŠÙ‚Ù„Ø¨ Ø§Ù„Ù…ÙŠØ²Ø§Ù†.",
    "Ø¶Ø¬ÙŠØ¬ Ø§Ù„Ø³ÙˆÙ‚ ÙŠÙˆÙ‡Ù…Ùƒ Ø¨Ø°Ù‡Ø¨Ù Ø³Ø±ÙŠØ¹Ø› Ø§Ù„Ù„Ù…Ø¹Ø§Ù† Ù„ÙŠØ³ Ø¯Ø§Ø¦Ù…Ù‹Ø§ Ø«Ø±Ø§Ø¡Ù‹.",
    "Ø­Ø±ÙƒØ© Ù…ØªØ¹Ø¬Ù„Ø© Ù‚Ø¯ ØªÙÙ„Øª Ù…Ù†Ùƒ ÙØ±ØµØ© ÙƒØ§Ù†Øª ØªØ­ØªØ§Ø¬ ØµØ¨Ø± Ø³Ø§Ø¹Ø© Ø¥Ø¶Ø§ÙÙŠØ©.",
    "Ù†Ø§ÙØ°Ø© Ø¥Ù†ÙØ§Ù‚ Ø·Ø§Ø¦Ø´ ØªÙÙØªØ­ Ù„Ø«ÙˆØ§Ù†ÙØ› Ø¥Ù† Ù…Ø±Ø±ØªÙ Ù…Ù†Ù‡Ø§ØŒ ÙŠØªØ£Ø®Ø± Ø§Ù„ØªØ¹Ø§ÙÙŠ."
  ];

  const GENERAL_P = [
    "Ø®Ø¨Ø±ÙŒ ÙŠÙØ³Ø±Ù‘ÙÙƒ ÙŠØµÙ„ Ù…Ù† Ø¬Ù‡Ø© Ø¨Ø¹ÙŠØ¯Ø©ØŒ ÙƒØ£Ù†Ù‡ Ù‡Ø¯ÙŠØ© Ø£ÙØ±Ø³Ù„Øª Ù‚Ø¨Ù„ Ø²Ù…Ù† ÙˆÙˆØµÙ„Øª Ø§Ù„Ø¢Ù†.",
    "Ø¹Ù„Ø§Ù…Ø§Øª Ø·Ø±ÙŠÙ‚ Ø¬Ø¯ÙŠØ¯Ø© ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø£ÙÙ‚Ø› Ù…Ø³Ø§Ø±ÙŒ Ù„Ù… ØªÙÙƒØ± Ø¨Ù‡ ÙŠØ¨Ø¯Ø£ Ø¨Ø¥Ø´Ø§Ø±Ø© ØµØºÙŠØ±Ø©.",
    "Ø§Ù„Ø¨ÙŠØª ÙŠØ³ØªØ±Ø¯ Ø³ÙƒÙŠÙ†ØªÙ‡ØŒ ÙˆØªÙØ§ØµÙŠÙ„ ÙŠÙˆÙ…Ùƒ ØªÙØµÙÙ‘Ù‰Ø› ØªØ´Ø¹Ø± Ø£Ù† Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø£Ø®Ù.",
    "ÙˆØ¬Ù‡ Ù‚Ø¯ÙŠÙ… ÙŠØ²ÙˆØ±Ùƒ ÙÙŠ Ø§Ù„Ø­Ù„Ù… Ù‚Ø¨Ù„ Ø£Ù† ØªÙ‚Ø§Ø¨Ù„Ù‡ ÙŠÙ‚Ø¸Ø©Ù‹Ø› Ø§Ù„Ù…ØµØ§Ø¯ÙØ§Øª ØªÙØ­Ø³Ù† Ø§Ù„ØªÙˆÙ‚ÙŠØª."
  ];
  const GENERAL_W = [
    "ØªØ°Ø¨Ø°Ø¨ Ù‚ØµÙŠØ± ÙÙŠ Ù…Ø­ÙŠØ·Ùƒ ÙŠØ®ØªØ¨Ø± Ø«Ø¨Ø§ØªÙƒØ› Ø¥Ù† Ø§Ù†Ø´ØºÙ„Øª Ø¨Ø§Ù„Ø¶Ø¬ÙŠØ¬ØŒ Ø¶Ø§Ø¹Øª Ø§Ù„Ø¥Ø´Ø§Ø±Ø©.",
    "Ù…Ø¹Ù„ÙˆÙ…Ø© Ù…Ø¨ØªÙˆØ±Ø© Ù‚Ø¯ ØªÙ‚ÙˆØ¯Ùƒ Ù„Ø§ØªØ¬Ø§Ù‡ Ø®Ø§Ø·Ø¦Ø› Ø¬Ø²Ø¡ Ù…ÙÙ‚ÙˆØ¯ ÙŠÙØºÙÙŠÙ‘Ø± Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©.",
    "Ø¸Ù„Ø§Ù„ ØºÙŠØ±Ø© Ø£Ùˆ ØªÙ†Ø§ÙØ³ ØªØ¸Ù‡Ø± ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ù‚Ø±ÙŠØ¨Ø©Ø› Ù„Ø§ ØªÙ…Ù†Ø­Ù‡Ø§ Ø£ÙƒØ«Ø± Ù…Ù† Ø­Ø¬Ù…Ù‡Ø§.",
    "Ø³Ø­Ø§Ø¨Ø© Ø·Ø§Ø±Ø¦Ø© ØªÙ…Ø± Ø³Ø±ÙŠØ¹Ù‹Ø§ØŒ Ù„ÙƒÙ†Ù‡Ø§ ØªÙØ¹Ù„Ù‘Ù…Ùƒ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø³Ù‚Ù Ø§Ù„ÙˆØ§Ø·Ø¦ ÙÙŠ Ø§Ù„Ø¨ÙŠØª."
  ];

  // ÙˆÙ…Ø¶Ø§Øª Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© (Ø·Ø§Ø¨Ø¹ Ù†Ø¨ÙˆØ¦ÙŠ Ø¹Ø§Ù…)
  const OMENS = [
    "ÙˆÙ…Ø¶Ø© Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©: Ø§Ù‡ØªØ²Ø§Ø²Ø§Øª Ø¹Ù„Ù‰ Ù…Ø³Ø§ÙØ© Ù‚Ø±ÙŠØ¨Ø© Ø«Ù… Ø³ÙƒÙˆÙ†ØŒ ÙˆØ¨Ø¹Ø¯ Ø§Ù„Ø³ÙƒÙˆÙ† ØªØ¨Ø¯Ù‘Ù„ ÙÙŠ Ø§Ù„ÙˆØ¬ÙˆÙ‡.",
    "ÙˆÙ…Ø¶Ø© Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©: Ø¨Ø§Ø¨ ÙŠÙØªØ­ Ù…Ø±ØªÙŠÙ†Ø› Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ø§Ù…ØªØ­Ø§Ù† ÙˆØ§Ù„Ø«Ø§Ù†ÙŠØ© Ù„Ù„ÙØ±Ø¬.",
    "ÙˆÙ…Ø¶Ø© Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©: Ø±Ø³Ø§Ù„Ø© Ù‚ØµÙŠØ±Ø© ØªØºÙŠÙ‘Ø± Ø§ØªØ¬Ø§Ù‡ Ø£Ø³Ø¨ÙˆØ¹Ùƒ ÙƒØ£Ù†Ù‡Ø§ Ø¥Ø´Ø§Ø±Ø© Ù…Ù† Ø¨Ø¹ÙŠØ¯.",
    "ÙˆÙ…Ø¶Ø© Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©: Ù„Ù‚Ø§Ø¡ Ø¹Ø§Ø¨Ø± ÙŠØ­Ù…Ù„ Ø£Ø«Ø±Ù‹Ø§ Ø£Ø·ÙˆÙ„ Ù…Ù† Ø²Ù…Ù†Ù‡Ø› Ù„Ø§ ØªØ³ØªÙ‡ÙÙ† Ø¨Ù‡."
  ];

  // ========= Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© ÙˆØ­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª =========
  const $ = sel => document.querySelector(sel);
  const step1 = $("#step1"), stepLoading = $("#stepLoading"), stepTopics = $("#stepTopics"), stepResult = $("#stepResult");
  const userEcho = $("#userEcho"), resultText = $("#resultText"), omenEl = $("#omen");
  const startBtn = $("#startBtn"), shuffleDemo = $("#shuffleDemo");
  const againBtn = $("#againBtn"), topicsBtn = $("#topicsBtn"), restartBtn = $("#restartBtn");
  const clearBtn = $("#clearBtn");
  const yearEl = $("#year"); yearEl.textContent = new Date().getFullYear();

  function saveForm(){
    const data = {
      age: $("#age").value || "",
      gender: $("#gender").value || "",
      status: $("#status").value || "",
      birthdate: $("#birthdate").value || ""
    };
    localStorage.setItem("istibsar_form", JSON.stringify(data));
  }
  function loadForm(){
    try{
      const data = JSON.parse(localStorage.getItem("istibsar_form")||"{}");
      if(data.age) $("#age").value = data.age;
      if(data.gender) $("#gender").value = data.gender;
      if(data.status) $("#status").value = data.status;
      if(data.birthdate) $("#birthdate").value = data.birthdate;
    }catch(e){}
  }
  function clearForm(){
    localStorage.removeItem("istibsar_form");
    $("#age").value = ""; $("#gender").value=""; $("#status").value=""; $("#birthdate").value="";
  }
  ["age","gender","status","birthdate"].forEach(id=>{
    document.getElementById(id).addEventListener("input", saveForm);
    document.getElementById(id).addEventListener("change", saveForm);
  });
  clearBtn.addEventListener("click", ()=>{ clearForm(); alert("ØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­."); });

  // Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙƒØ±Ø§Ø± + Ø§Ø®ØªÙ„Ø§Ù Ø¯Ø§Ø¦Ù…
  function seeded(seed){ let x = seed ^ Date.now(); return function(){ x ^= x<<13; x ^= x>>>17; x ^= x<<5; return ((x>>>0)/4294967296); } }
  function strHash(s){ let h=2166136261>>>0; for(let i=0;i<s.length;i++){ h^=s.charCodeAt(i); h=Math.imul(h,16777619);} return h>>>0; }
  function pick(rand, arr){ return arr[Math.floor(rand()*arr.length)] }

  let currentTopic = "general";
  let currentRand = seeded(123);

  function formSeed(){
    const age = $("#age").value || "";
    const gender = $("#gender").value || "";
    const status = $("#status").value || "";
    const birth = $("#birthdate").value || "";
    const key = `${age}|${gender}|${status}|${birth}`;
    return key ? strHash(key) : Math.floor(Math.random()*1e9);
  }

  function echoUser(){
    const a = $("#age").value ? `Ø¹Ù…Ø± ${$("#age").value}` : "Ø¹Ù…Ø± ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
    const g = $("#gender").value || "Ø¬Ù†Ø³ ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
    const s = $("#status").value || "Ø­Ø§Ù„Ø© ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©";
    const b = $("#birthdate").value || "Ù…ÙŠÙ„Ø§Ø¯ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
    userEcho.textContent = `${g} â€¢ ${s} â€¢ ${a} â€¢ ${b}`;
  }

  function show(el){ el.classList.remove("hidden") }
  function hide(el){ el.classList.add("hidden") }

  function startFlow(){
    hide(step1); show(stepLoading);
    setTimeout(()=>{ hide(stepLoading); show(stepTopics); }, 1200);
  }

  function buildBlock(title, items){
    return `<h3>${title}</h3><ul>${items.map(i=>`<li>${i}</li>`).join("")}</ul>`;
  }

  function buildReport(topic){
    const bank = {
      love:   {pos:LOVE_P,   warn:LOVE_W,   title:"Ø§Ù„Ø­Ø¨"},
      health: {pos:HEALTH_P, warn:HEALTH_W, title:"Ø§Ù„ØµØ­Ø©"},
      career: {pos:CAREER_P, warn:CAREER_W, title:"Ø§Ù„Ù…Ù‡Ù†Ø©/Ø§Ù„Ø«Ø±ÙˆØ©"},
      general:{pos:GENERAL_P,warn:GENERAL_W,title:"Ø¹Ø§Ù…"}
    }[topic];

    const intro = `<p><strong>${bank.title}:</strong> Ø£Ù†Øª Ø¯Ø§Ø®Ù„ Ù…Ø³Ø§Ø± ØªØªÙƒØ§Ø«Ø± ÙÙŠÙ‡ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª. Ù…Ø§ ÙŠØ¸Ù‡Ø± Ø§Ù„Ø¢Ù† Ù„ÙŠØ³ Ø­ÙƒÙ…Ù‹Ø§ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ù„ Ù…Ù„Ø§Ù…Ø­ Ù‚Ø±ÙŠØ¨Ø©.</p>`;
    // Ø§Ø®ØªÙŠØ§Ø± ÙÙ‚Ø±ØªÙŠÙ† ØªÙˆÙ‚Ø¹Ø§Øª ÙˆÙÙ‚Ø±ØªÙŠÙ† ØªØ­Ø°ÙŠØ±
    const r = seeded(Math.floor(currentRand()*1e9));
    const ps = [...bank.pos].sort(()=>r()-0.5).slice(0,2);
    const ws = [...bank.warn].sort(()=>r()-0.5).slice(0,2);

    const positives = buildBlock("ØªÙˆÙ‚Ø¹Ø§Øª", ps);
    const warnings  = buildBlock("ØªØ­Ø°ÙŠØ±Ø§Øª", ws);

    return `${intro}${positives}${warnings}`;
  }

  function genReading(topic){
    const html = buildReport(topic);
    resultText.innerHTML = html;
    omenEl.textContent = pick(currentRand, OMENS);
  }

  // Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
  document.getElementById("startBtn").addEventListener("click", ()=>{
    currentRand = seeded(formSeed()); saveForm(); startFlow();
  });
  document.getElementById("shuffleDemo").addEventListener("click", ()=>{
    currentRand = seeded(Math.floor(Math.random()*1e9)); startFlow();
  });

  document.querySelectorAll(".topic").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      currentTopic = btn.dataset.topic;
      hide(stepTopics); show(stepResult);
      echoUser(); genReading(currentTopic);
    });
  });

  document.getElementById("againBtn").addEventListener("click", ()=>{
    currentRand = seeded(formSeed()); genReading(currentTopic);
  });
  document.getElementById("topicsBtn").addEventListener("click", ()=>{
    hide(stepResult); show(stepTopics);
  });
  document.getElementById("restartBtn").addEventListener("click", ()=>{
    hide(stepResult); hide(stepTopics); show(step1); window.scrollTo({top:0, behavior:"smooth"});
  });

  // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©
  loadForm();
</script>
</body>
</html>
