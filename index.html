<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>دليل الصلاة الشامل | تعلم الصلاة ومواقيتها وفق المذهب الجعفري</title>
  <meta name="description" content="دليلك الشامل لتعلم الصلاة وأحكامها (الطهارة، الوضوء، التيمم) مع مواقيت الصلاة الدقيقة لمنطقتك، وفق فتاوى السيد السيستاني (دام ظله)." />
  <meta name="keywords" content="مواقيت الصلاة, تعليم الصلاة, كيفية الصلاة, المذهب الجعفري, السيد السيستاني, أحكام الصلاة, التيمم, الطهارة, الوضوء, قضاء الصلاة, فقه, شيعة" />
  <meta name="author" content="فاضل الريس" />
  <link rel="canonical" href="https://your-domain.com/salah-guide.html" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <meta name="theme-color" content="#003366" />

  <!-- أمن أقوى (بدون inline-js/styles خارج وسم <style>) -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self';
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com;
    img-src 'self' https: data:;
    font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
    connect-src 'self' https://api.aladhan.com;
    frame-ancestors 'none';
    base-uri 'self';
    form-action 'none'">

  <meta http-equiv="X-Content-Type-Options" content="nosniff" />
  <meta http-equiv="X-Frame-Options" content="DENY" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <!-- OG -->
  <meta property="og:title" content="دليل الصلاة الشامل | تعلم الصلاة ومواقيتها وفق المذهب الجعفري" />
  <meta property="og:description" content="دليل مبسط لتعلم الصلاة وأحكامها مع مواقيت الصلاة اليومية الدقيقة لمنطقتك." />
  <meta property="og:image" content="https://images.unsplash.com/photo-1584335319462-a3c6a3885165?q=80&w=2070&auto=format&fit=crop" />
  <meta property="og:url" content="https://your-domain.com/salah-guide.html" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ar_AR" />

  <!-- Structured Data: Article + FAQ + Breadcrumb -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Article",
    "mainEntityOfPage":{"@type":"WebPage","@id":"https://your-domain.com/salah-guide.html"},
    "headline":"دليل الصلاة الشامل: تعلم الصلاة ومواقيتها وفق المذهب الجعفري",
    "image":"https://images.unsplash.com/photo-1584335319462-a3c6a3885165?q=80&w=2070&auto=format&fit=crop",
    "author":{"@type":"Person","name":"فاضل الريس"},
    "publisher":{"@type":"Organization","name":"دليل الصلاة الجعفرية"}
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {"@type":"Question","name":"ما هو التيمم ومتى يُشرَع؟",
       "acceptedAnswer":{"@type":"Answer","text":"التيمم طهارة ترابية بديلة عن الماء عند تعذره أو ضرره أو المشقة."}},
      {"@type":"Question","name":"كيفيّة التيمم المختصرة؟",
       "acceptedAnswer":{"@type":"Answer","text":"ضرب الكفين على التراب الطاهر، مسح الجبهة والجبينين، ثم ظاهر الكفّين تباعًا."}},
      {"@type":"Question","name":"ما أوقات الفرائض اليومية بإيجاز؟",
       "acceptedAnswer":{"@type":"Answer","text":"الصبح: الفجر إلى الشروق. الظهر والعصر: من الزوال إلى المغرب. المغرب والعشاء: من المغرب إلى منتصف الليل للمختار."}}
    ]
  }
  </script>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"الرئيسية","item":"https://your-domain.com/"},
      {"@type":"ListItem","position":2,"name":"دليل الصلاة الشامل","item":"https://your-domain.com/salah-guide.html"}
    ]
  }
  </script>

  <!-- Fonts / Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

  <style>
    :root{--primary:#003366;--secondary:#5A7D7C;--bg:#fff;--light:#F7F7FB;--text:#333;--muted:#6b7280;--border:#e5e7eb}
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;font-family:'Tajawal',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--text);line-height:1.9;font-size:clamp(16px,1.2vw,18px)}
    .container{max-width:1100px;margin:auto;padding:0 20px}
    h1,h2,h3{color:var(--primary);margin:0 0 16px}
    h2{font-size:clamp(1.8rem,4.5vw,2.4rem);text-align:center;margin-bottom:32px}
    section{padding:clamp(48px,6vw,80px) 0}

    header.sticky{position:sticky;top:0;z-index:50;background:#fffcc;backdrop-filter:blur(8px);box-shadow:0 2px 10px rgba(0,0,0,.05)}
    .bar{display:flex;gap:14px;align-items:center;justify-content:space-between;padding:12px 0}
    .logo{font-weight:800;color:var(--primary);text-decoration:none;white-space:nowrap}
    nav{display:flex;gap:14px;overflow:auto}
    nav a{color:var(--primary);text-decoration:none;font-weight:600;white-space:nowrap}
    nav a:hover{color:var(--secondary)}

    .hero{padding:48px 0;background:
      linear-gradient(to top,rgba(255,255,255,.9),rgba(255,255,255,.6)),
      url('https://images.unsplash.com/photo-1584335319462-a3c6a3885165?q=80&w=2070&auto=format&fit=crop') center/cover no-repeat}
    .hero .grid{display:grid;grid-template-columns:1fr;gap:20px;justify-items:center}

    /* رأس الودجت: اليوم/التاريخ/المدينة والعدّ التنازلي */
    .date-strip{width:100%;max-width:900px;background:#fff;border:1px solid var(--border);border-radius:12px;padding:10px 14px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;box-shadow:0 6px 20px rgba(0,0,0,.06)}
    .date-strip .item{display:flex;gap:8px;align-items:center;color:var(--muted);font-weight:600}
    .countdown{color:var(--primary);font-weight:800}

    /* ودجت المواقيت */
    .widget{background:rgba(255,255,255,.88);border:1px solid var(--border);border-radius:18px;backdrop-filter:blur(10px);box-shadow:0 12px 30px rgba(0,0,0,.08);padding:18px;max-width:420px;width:100%}
    .widget h3{text-align:center;margin-bottom:10px}
    .pt-list{list-style:none;margin:0;padding:0}
    .pt-row{display:flex;justify-content:space-between;align-items:center;padding:12px 6px;border-bottom:1px dashed var(--border)}
    .pt-row:last-child{border-bottom:0}
    .pt-name{font-weight:600}
    .pt-time{font-weight:800;color:var(--primary);direction:ltr}
    .pt-note{font-size:.9rem;color:var(--muted);margin-top:6px}

    /* أقسام المحتوى — ضمان عدم الاقتطاع */
    .content .container{max-width:950px}
    .content p,.content ul,.content ol{margin:0 0 14px;text-wrap:pretty}
    .content ul{list-style:disc;padding-inline-start:22px}
    .content ol{list-style:decimal;padding-inline-start:22px}
    .alt{background:var(--light)}

    .quote{background:#eef6f6;border-inline-start:5px solid var(--secondary);padding:16px;border-radius:8px;color:#444}

    footer{background:var(--primary);color:#fff;text-align:center;padding:28px 16px}
    .top{position:fixed;bottom:22px;left:22px;width:44px;height:44px;border-radius:50%;background:var(--primary);color:#fff;display:grid;place-items:center;text-decoration:none;opacity:.85;transform:translateY(20px);transition:.2s;z-index:40}
    .top.hide{opacity:0;pointer-events:none;transform:translateY(20px)}
    @media (min-width:900px){.hero .grid{grid-template-columns:1.2fr .8fr}}
  </style>
</head>
<body>

<header class="sticky">
  <div class="container bar">
    <a class="logo" href="#">دليل الصلاة <span style="color:#5A7D7C">الجعفرية</span></a>
    <nav aria-label="روابط أساسية">
      <a href="#preliminaries">مقدمات الصلاة</a>
      <a href="#how">كيفية الصلاة</a>
      <a href="#times">أوقات الصلاة</a>
      <a href="#rulings">أحكام الصلاة</a>
      <a href="#missed">قضاء الفوائت</a>
    </nav>
  </div>
</header>

<main>
  <!-- بطل الصفحة + التاريخ والعدّ التنازلي + ودجت -->
  <section class="hero">
    <div class="container grid">
      <!-- شريط التاريخ/المدينة/العدّ -->
      <div class="date-strip" id="dateStrip" aria-live="polite">
        <div class="item"><i class="fa-solid fa-calendar-day"></i><span id="dayName">—</span></div>
        <div class="item"><i class="fa-regular fa-calendar"></i><span id="gregDate">—</span></div>
        <div class="item"><i class="fa-regular fa-moon"></i><span id="hijriDate">—</span></div>
        <div class="item"><i class="fa-solid fa-location-dot"></i><span id="cityName">—</span></div>
        <div class="item countdown"><i class="fa-regular fa-bell"></i>
          <span id="countdownLabel">المتبقي على الأذان:</span>
          <span id="countdown">—:—:—</span>
        </div>
      </div>

      <!-- ودجت المواقيت -->
      <div class="widget" id="ptWidget">
        <h3>مواقيت اليوم</h3>
        <ul class="pt-list" id="ptList"></ul>
        <div class="pt-note" id="ptNote">جاري تحديد الموقع لجلب المواقيت…</div>
      </div>
    </div>
  </section>

  <!-- المحتوى -->
  <section id="preliminaries" class="content">
    <div class="container">
      <h2>مقدمات الصلاة</h2>
      <p>قبل الشروع في الصلاة، يجب تحصيل شروطها: الطهارة من الحدث والخبث، استقبال القبلة، ستر العورة، وتهيئة المكان واللباس.</p>

      <h3>الطهارة (وضوء/غُسل)</h3>
      <ul>
        <li><strong>الوضوء:</strong> غسل الوجه واليدين ومسح مقدم الرأس والقدمين.</li>
        <li><strong>الغُسل:</strong> يجب في موارد كالجَنابة ويُجزئ عن الوضوء.</li>
      </ul>

      <h3>التيمم (تفصيلاً)</h3>
      <p><strong>متى يُشرَع؟</strong> عند فقدان الماء، أو تعذّر الوصول إليه، أو خوف الضرر باستعماله، أو المشقة الشديدة.</p>
      <p><strong>ما يُتَيَمَّم عليه:</strong> التراب الطاهر، الرمل، الحصى، الحجر، الجصّ أو النورة قبل الإحراق، وما شاكل. يُشترط الطهارة.</p>
      <ol>
        <li>النية قربةً إلى الله تعالى.</li>
        <li>ضرب باطني الكفين معًا على ما يصح التيمم به.</li>
        <li>مسح الجبهة والجبينين من منبت الشعر إلى أعلى الأنف والحاجبين بالكفين.</li>
        <li>مسح ظاهر الكف اليمنى بباطن اليسرى، ثم ظاهر اليسرى بباطن اليمنى.</li>
      </ol>
      <p><strong>النواقض:</strong> كل ما ينقض الوضوء، وزوال العذر مع وجود ماء كافٍ قبل خروج الوقت لمن كان عدِمَه.</p>

      <div class="quote">قال النبي ﷺ: «لا صلاة إلا بطهور».</div>

      <h3>القبلة ولباس المصلّي</h3>
      <p>يجب التوجّه إلى الكعبة، وأن يكون اللباس طاهرًا ومباحًا…</p>
    </div>
  </section>

  <section id="how" class="content alt">
    <div class="container">
      <h2>كيفية الصلاة</h2>
      <h3>الواجبات بإيجاز</h3>
      <ul>
        <li>النية، تكبيرة الإحرام، القيام، القراءة، الركوع، السجود، التشهد، التسليم، الترتيب والموالاة.</li>
      </ul>
    </div>
  </section>

  <section id="times" class="content">
    <div class="container">
      <h2>أوقات الصلاة</h2>
      <h3>الأوقات الشرعية</h3>
      <ul>
        <li><strong>الصبح:</strong> من الفجر الصادق إلى الشروق.</li>
        <li><strong>الظهر والعصر:</strong> من الزوال إلى المغرب، مع المحافظة على الترتيب.</li>
        <li><strong>المغرب والعشاء:</strong> من المغرب إلى منتصف الليل للمختار.</li>
      </ul>
      <h3>أوقات الفضيلة</h3>
      <ul>
        <li>فضيلة الظهر: من الزوال إلى بلوغ الظل مثله.</li>
        <li>فضيلة العصر: من المِثْل إلى المِثْلَين.</li>
        <li>فضيلة المغرب: إلى ذهاب الشَّفَق.</li>
        <li>فضيلة العشاء: من ذهاب الشفق إلى ثلث الليل.</li>
      </ul>
    </div>
  </section>

  <section id="rulings" class="content alt">
    <div class="container">
      <h2>أحكام الشك والسهو</h2>
      <h3>الشكوك</h3>
      <ul>
        <li>ما يُبطل: الشك في عدد ركعات الصبح والمغرب، أو في الأوليين من الرباعية بلا ظن راجح.</li>
        <li>ما له علاج: الشك بين الثلاث والأربع… يبني على الأربع ثم يأتي بركعة احتياط.</li>
      </ul>
      <h3>السهو</h3>
      <ul>
        <li>سجدتا السهو لمواضع: الكلام سهوًا، التسليم في غير محلّه…</li>
      </ul>
    </div>
  </section>

  <section id="missed" class="content">
    <div class="container">
      <h2>قضاء الصلوات</h2>
      <ul>
        <li>يجوز القضاء في أي وقت.</li>
        <li>قضاء الحضر تامّ، والسفر قصر.</li>
        <li>لا يجب الترتيب إلّا فيما كان مرتبًا في أصله من اليوم الواحد.</li>
      </ul>
    </div>
  </section>
</main>

<footer>
  <div class="container">
    <p>&copy; 2025 دليل الصلاة الجعفرية.</p>
    <p>إعداد ومراجعة: <a href="https://wa.me/97333375858" target="_blank" rel="noopener noreferrer" style="color:#a9cce3;font-weight:700">فاضل الريس</a></p>
  </div>
</footer>

<a href="#top" class="top hide" aria-label="العودة للأعلى"><i class="fa-solid fa-arrow-up"></i></a>

<!-- سكربتات الصفحة (خارجيّة بالنسبة لـ CSP) -->
<script>
/* زر العودة للأعلى */
const topBtn=document.querySelector('.top');
addEventListener('scroll',()=>{ topBtn.classList.toggle('hide', scrollY<400); });

/* عناصر التاريخ */
const dayNameEl=document.getElementById('dayName');
const gregDateEl=document.getElementById('gregDate');
const hijriDateEl=document.getElementById('hijriDate');
const cityEl=document.getElementById('cityName');
const countdownEl=document.getElementById('countdown');
const countdownLabel=document.getElementById('countdownLabel');

const ptList=document.getElementById('ptList');
const ptNote=document.getElementById('ptNote');

function fmt12(hm){ // "HH:MM" -> "hh:mm ص/م"
  const [H,M]=hm.split(':').map(Number);
  const p=H>=12?'م':'ص';
  const h=H%12||12;
  return `${String(h).padStart(2,'0')}:${M.toString().padStart(2,'0')} ${p}`;
}
function parseTimeToDate(t, tzOffsetMinutes){
  // t like "05:32" -> Date today with local TZ, then adjust minutes if API carries +03 in raw string (نزيله مسبقا)
  const now=new Date();
  const [H,M]=t.split(':').map(Number);
  const d=new Date(now.getFullYear(), now.getMonth(), now.getDate(), H, M, 0, 0);
  return d;
}
function arabicDayName(d){
  return new Intl.DateTimeFormat('ar', {weekday:'long'}).format(d);
}
function arabicGregDate(d){
  return new Intl.DateTimeFormat('ar', {year:'numeric',month:'long',day:'numeric'}).format(d);
}
function arabicHijriDate(d){
  // تقويم إسلامي (أم القرى) عبر Intl
  return new Intl.DateTimeFormat('ar-SA-u-ca-islamic', {year:'numeric',month:'long',day:'numeric'}).format(d);
}

/* تحديد المدينة + جلب المواقيت (طريقة جعفري = method=2) */
function fetchPrayerTimes(lat, lon){
  const now=new Date();
  const y=now.getFullYear(), m=now.getMonth()+1, day=now.getDate();
  const url=`https://api.aladhan.com/v1/calendar/${y}/${m}?latitude=${lat}&longitude=${lon}&method=2`;
  ptNote.textContent='جاري جلب المواقيت…';
  fetch(url).then(r=>r.json()).then(json=>{
    if(json.code!==200) throw new Error('API error');
    const today=json.data[day-1];
    const T=today.timings;
    // ننظف الـ (+03:00)
    const clean=(s)=>s.split(' ')[0];

    const rows=[
      ['صلاة الفجر', clean(T.Fajr)],
      ['الشروق', clean(T.Sunrise)],
      ['صلاة الظهر', clean(T.Dhuhr)],
      ['الغروب', clean(T.Sunset)],
      ['صلاة المغرب', clean(T.Maghrib)],
      ['منتصف الليل', clean(T.Midnight)]
    ];
    ptList.innerHTML=rows.map(([n,t])=>`
      <li class="pt-row">
        <span class="pt-name">${n}</span>
        <span class="pt-time">${fmt12(t)}</span>
      </li>`).join('');
    ptNote.textContent='';

    // شريط التاريخ
    const dnow=new Date();
    dayNameEl.textContent=arabicDayName(dnow);
    gregDateEl.textContent=arabicGregDate(dnow);
    hijriDateEl.textContent=arabicHijriDate(dnow);
    // من API: اسم المدينة/الدولة إن أحببت
    const cityStr = (today.meta && today.meta.timezone) ? today.meta.timezone : 'موقعك';
    cityEl.textContent = today.date && today.date.hijri && today.date.hijri.country ? today.date.hijri.country : cityStr;

    // العدّ التنازلي لأقرب أذان (الفجر/الظهر/المغرب)
    const adhanList=[
      {name:'الفجر', time:clean(T.Fajr)},
      {name:'الظهر', time:clean(T.Dhuhr)},
      {name:'المغرب', time:clean(T.Maghrib)}
    ];
    let nextIdx=0;
    function computeNext(){
      const now=new Date();
      let best=null;
      for(const a of adhanList){
        const dt=parseTimeToDate(a.time);
        if(dt>now && (!best || dt<best.dt)) best={...a, dt};
      }
      // إن انتهت أذانات اليوم، نعد للفجر القادم (غدًا)
      if(!best){
        const t=adhanList[0].time.split(':').map(Number);
        const dt=new Date(now); dt.setDate(now.getDate()+1); dt.setHours(t[0],t[1],0,0);
        best={...adhanList[0], dt};
      }
      return best;
    }
    let next=computeNext();
    countdownLabel.textContent=`المتبقي على أذان ${next.name}:`;
    function tick(){
      const now=new Date();
      if(now>=next.dt){ next=computeNext(); countdownLabel.textContent=`المتبقي على أذان ${next.name}:`; }
      const diff=next.dt - now;
      const s=Math.max(0, Math.floor(diff/1000));
      const hh=String(Math.floor(s/3600)).padStart(2,'0');
      const mm=String(Math.floor((s%3600)/60)).padStart(2,'0');
      const ss=String(s%60).padStart(2,'0');
      countdownEl.textContent=`${hh}:${mm}:${ss}`;
      requestAnimationFrame(()=>{ /* نعطي سلاسة */ });
    }
    setInterval(tick, 1000); tick();
  }).catch(()=>{
    ptNote.textContent='تعذر جلب المواقيت. تحقّق من الاتصال أو إذن الموقع.';
  });
}

(function init(){
  const d=new Date();
  dayNameEl.textContent=arabicDayName(d);
  gregDateEl.textContent=arabicGregDate(d);
  hijriDateEl.textContent=arabicHijriDate(d);
  cityEl.textContent='—';

  if('geolocation' in navigator){
    navigator.geolocation.getCurrentPosition(
      pos=>{ cityEl.textContent='جارِ تحديد الموقع…'; fetchPrayerTimes(pos.coords.latitude, pos.coords.longitude); },
      _=>{ ptNote.textContent='يُرجى السماح بالموقع لعرض المواقيت بدقة.'; }
    );
  }else{
    ptNote.textContent='المتصفح لا يدعم تحديد الموقع.';
  }
})();
</script>
</body>
</html>
