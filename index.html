<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7fa;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .last-updated {
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
        .currency-row {
            display: flex;
            align-items: center;
            background: #fff;
            border: 1px solid #007bff;
            border-radius: 8px;
            margin-bottom: 10px;
            padding: 10px;
        }
        .flag {
            width: 30px;
            height: 22.5px;
            border-radius: 50%;
            margin-right: 10px;
        }
        select, input {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 1.2em;
            color: #333;
        }
        .amount {
            text-align: right;
        }
        .rate {
            font-size: 0.8em;
            color: #666;
        }
        #add-currency {
            background: transparent;
            border: none;
            color: #007bff;
            font-size: 1em;
            cursor: pointer;
            margin-bottom: 10px;
        }
        .mid-market {
            text-align: center;
            color: #666;
            font-size: 0.8em;
        }
        .attribution {
            text-align: center;
            font-size: 0.7em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Convert</h1>
        <p class="last-updated">Last updated: <span id="last-updated"></span></p>
        <div id="base-currency" class="currency-row">
            <!-- Populated by JS -->
        </div>
        <div id="target-currencies">
            <!-- Target currencies will be added here -->
        </div>
        <button id="add-currency">+ Add currency</button>
        <p class="mid-market">Mid-market rates <span id="info-icon">i</span></p>
    </div>
    <div class="attribution">
        <a href="https://www.exchangerate-api.com">Rates By Exchange Rate API</a>
    </div>

    <script>
        // List of supported currencies from API
        const currencies = [
            {code: "AED", name: "UAE Dirham"},
            {code: "AFN", name: "Afghan Afghani"},
            {code: "ALL", name: "Albanian Lek"},
            {code: "AMD", name: "Armenian Dram"},
            {code: "ANG", name: "Netherlands Antillian Guilder"},
            {code: "AOA", name: "Angolan Kwanza"},
            {code: "ARS", name: "Argentine Peso"},
            {code: "AUD", name: "Australian Dollar"},
            {code: "AWG", name: "Aruban Florin"},
            {code: "AZN", name: "Azerbaijani Manat"},
            {code: "BAM", name: "Bosnia and Herzegovina Mark"},
            {code: "BBD", name: "Barbados Dollar"},
            {code: "BDT", name: "Bangladeshi Taka"},
            {code: "BGN", name: "Bulgarian Lev"},
            {code: "BHD", name: "Bahraini Dinar"},
            {code: "BIF", name: "Burundian Franc"},
            {code: "BMD", name: "Bermudian Dollar"},
            {code: "BND", name: "Brunei Dollar"},
            {code: "BOB", name: "Bolivian Boliviano"},
            {code: "BRL", name: "Brazilian Real"},
            {code: "BSD", name: "Bahamian Dollar"},
            {code: "BTN", name: "Bhutanese Ngultrum"},
            {code: "BWP", name: "Botswana Pula"},
            {code: "BYN", name: "Belarusian Ruble"},
            {code: "BZD", name: "Belize Dollar"},
            {code: "CAD", name: "Canadian Dollar"},
            {code: "CDF", name: "Congolese Franc"},
            {code: "CHF", name: "Swiss Franc"},
            {code: "CLP", name: "Chilean Peso"},
            {code: "CNY", name: "Chinese Renminbi"},
            {code: "COP", name: "Colombian Peso"},
            {code: "CRC", name: "Costa Rican Colon"},
            {code: "CUP", name: "Cuban Peso"},
            {code: "CVE", name: "Cape Verdean Escudo"},
            {code: "CZK", name: "Czech Koruna"},
            {code: "DJF", name: "Djiboutian Franc"},
            {code: "DKK", name: "Danish Krone"},
            {code: "DOP", name: "Dominican Peso"},
            {code: "DZD", name: "Algerian Dinar"},
            {code: "EGP", name: "Egyptian Pound"},
            {code: "ERN", name: "Eritrean Nakfa"},
            {code: "ETB", name: "Ethiopian Birr"},
            {code: "EUR", name: "Euro"},
            {code: "FJD", name: "Fiji Dollar"},
            {code: "FKP", name: "Falkland Islands Pound"},
            {code: "FOK", name: "Faroese Króna"},
            {code: "GBP", name: "Pound Sterling"},
            {code: "GEL", name: "Georgian Lari"},
            {code: "GGP", name: "Guernsey Pound"},
            {code: "GHS", name: "Ghanaian Cedi"},
            {code: "GIP", name: "Gibraltar Pound"},
            {code: "GMD", name: "Gambian Dalasi"},
            {code: "GNF", name: "Guinean Franc"},
            {code: "GTQ", name: "Guatemalan Quetzal"},
            {code: "GYD", name: "Guyanese Dollar"},
            {code: "HKD", name: "Hong Kong Dollar"},
            {code: "HNL", name: "Honduran Lempira"},
            {code: "HRK", name: "Croatian Kuna"},
            {code: "HTG", name: "Haitian Gourde"},
            {code: "HUF", name: "Hungarian Forint"},
            {code: "IDR", name: "Indonesian Rupiah"},
            {code: "ILS", name: "Israeli New Shekel"},
            {code: "IMP", name: "Manx Pound"},
            {code: "INR", name: "Indian Rupee"},
            {code: "IQD", name: "Iraqi Dinar"},
            {code: "IRR", name: "Iranian Rial"},
            {code: "ISK", name: "Icelandic Króna"},
            {code: "JEP", name: "Jersey Pound"},
            {code: "JMD", name: "Jamaican Dollar"},
            {code: "JOD", name: "Jordanian Dinar"},
            {code: "JPY", name: "Japanese Yen"},
            {code: "KES", name: "Kenyan Shilling"},
            {code: "KGS", name: "Kyrgyzstani Som"},
            {code: "KHR", name: "Cambodian Riel"},
            {code: "KID", name: "Kiribati Dollar"},
            {code: "KMF", name: "Comorian Franc"},
            {code: "KRW", name: "South Korean Won"},
            {code: "KWD", name: "Kuwaiti Dinar"},
            {code: "KYD", name: "Cayman Islands Dollar"},
            {code: "KZT", name: "Kazakhstani Tenge"},
            {code: "LAK", name: "Lao Kip"},
            {code: "LBP", name: "Lebanese Pound"},
            {code: "LKR", name: "Sri Lanka Rupee"},
            {code: "LRD", name: "Liberian Dollar"},
            {code: "LSL", name: "Lesotho Loti"},
            {code: "LYD", name: "Libyan Dinar"},
            {code: "MAD", name: "Moroccan Dirham"},
            {code: "MDL", name: "Moldovan Leu"},
            {code: "MGA", name: "Malagasy Ariary"},
            {code: "MKD", name: "Macedonian Denar"},
            {code: "MMK", name: "Burmese Kyat"},
            {code: "MNT", name: "Mongolian Tögrög"},
            {code: "MOP", name: "Macanese Pataca"},
            {code: "MRU", name: "Mauritanian Ouguiya"},
            {code: "MUR", name: "Mauritian Rupee"},
            {code: "MVR", name: "Maldivian Rufiyaa"},
            {code: "MWK", name: "Malawian Kwacha"},
            {code: "MXN", name: "Mexican Peso"},
            {code: "MYR", name: "Malaysian Ringgit"},
            {code: "MZN", name: "Mozambican Metical"},
            {code: "NAD", name: "Namibian Dollar"},
            {code: "NGN", name: "Nigerian Naira"},
            {code: "NIO", name: "Nicaraguan Córdoba"},
            {code: "NOK", name: "Norwegian Krone"},
            {code: "NPR", name: "Nepalese Rupee"},
            {code: "NZD", name: "New Zealand Dollar"},
            {code: "OMR", name: "Omani Rial"},
            {code: "PAB", name: "Panamanian Balboa"},
            {code: "PEN", name: "Peruvian Sol"},
            {code: "PGK", name: "Papua New Guinean Kina"},
            {code: "PHP", name: "Philippine Peso"},
            {code: "PKR", name: "Pakistani Rupee"},
            {code: "PLN", name: "Polish Złoty"},
            {code: "PYG", name: "Paraguayan Guaraní"},
            {code: "QAR", name: "Qatari Riyal"},
            {code: "RON", name: "Romanian Leu"},
            {code: "RSD", name: "Serbian Dinar"},
            {code: "RUB", name: "Russian Ruble"},
            {code: "RWF", name: "Rwandan Franc"},
            {code: "SAR", name: "Saudi Riyal"},
            {code: "SBD", name: "Solomon Islands Dollar"},
            {code: "SCR", name: "Seychellois Rupee"},
            {code: "SDG", name: "Sudanese Pound"},
            {code: "SEK", name: "Swedish Krona"},
            {code: "SGD", name: "Singapore Dollar"},
            {code: "SHP", name: "Saint Helena Pound"},
            {code: "SLE", name: "Sierra Leonean Leone"},
            {code: "SOS", name: "Somali Shilling"},
            {code: "SRD", name: "Surinamese Dollar"},
            {code: "SSP", name: "South Sudanese Pound"},
            {code: "STN", name: "São Tomé and Príncipe Dobra"},
            {code: "SYP", name: "Syrian Pound"},
            {code: "SZL", name: "Eswatini Lilangeni"},
            {code: "THB", name: "Thai Baht"},
            {code: "TJS", name: "Tajikistani Somoni"},
            {code: "TMT", name: "Turkmenistan Manat"},
            {code: "TND", name: "Tunisian Dinar"},
            {code: "TOP", name: "Tongan Paʻanga"},
            {code: "TRY", name: "Turkish Lira"},
            {code: "TTD", name: "Trinidad and Tobago Dollar"},
            {code: "TVD", name: "Tuvaluan Dollar"},
            {code: "TWD", name: "New Taiwan Dollar"},
            {code: "TZS", name: "Tanzanian Shilling"},
            {code: "UAH", name: "Ukrainian Hryvnia"},
            {code: "UGX", name: "Ugandan Shilling"},
            {code: "USD", name: "United States Dollar"},
            {code: "UYU", name: "Uruguayan Peso"},
            {code: "UZS", name: "Uzbekistani So'm"},
            {code: "VES", name: "Venezuelan Bolívar Soberano"},
            {code: "VND", name: "Vietnamese Đồng"},
            {code: "VUV", name: "Vanuatu Vatu"},
            {code: "WST", name: "Samoan Tālā"},
            {code: "XAF", name: "Central African CFA Franc"},
            {code: "XCD", name: "East Caribbean Dollar"},
            {code: "XDR", name: "Special Drawing Rights"},
            {code: "XOF", name: "West African CFA franc"},
            {code: "XPF", name: "CFP Franc"},
            {code: "YER", name: "Yemeni Rial"},
            {code: "ZAR", name: "South African Rand"},
            {code: "ZMW", name: "Zambian Kwacha"},
            {code: "ZWL", name: "Zimbabwean Dollar"}
        ];

        // Map from currency code to country code for flags (partial, based on common associations)
        const currencyToCountry = {
            "AED": "ae",
            "AFN": "af",
            "ALL": "al",
            "AMD": "am",
            "ANG": "cw",
            "AOA": "ao",
            "ARS": "ar",
            "AUD": "au",
            "AWG": "aw",
            "AZN": "az",
            "BAM": "ba",
            "BBD": "bb",
            "BDT": "bd",
            "BGN": "bg",
            "BHD": "bh",
            "BIF": "bi",
            "BMD": "bm",
            "BND": "bn",
            "BOB": "bo",
            "BRL": "br",
            "BSD": "bs",
            "BTN": "bt",
            "BWP": "bw",
            "BYN": "by",
            "BZD": "bz",
            "CAD": "ca",
            "CDF": "cd",
            "CHF": "ch",
            "CLP": "cl",
            "CNY": "cn",
            "COP": "co",
            "CRC": "cr",
            "CUP": "cu",
            "CVE": "cv",
            "CZK": "cz",
            "DJF": "dj",
            "DKK": "dk",
            "DOP": "do",
            "DZD": "dz",
            "EGP": "eg",
            "ERN": "er",
            "ETB": "et",
            "EUR": "eu",
            "FJD": "fj",
            "FKP": "fk",
            "GBP": "gb",
            "GEL": "ge",
            "GHS": "gh",
            "GIP": "gi",
            "GMD": "gm",
            "GNF": "gn",
            "GTQ": "gt",
            "GYD": "gy",
            "HKD": "hk",
            "HNL": "hn",
            "HRK": "hr",
            "HTG": "ht",
            "HUF": "hu",
            "IDR": "id",
            "ILS": "il",
            "INR": "in",
            "IQD": "iq",
            "IRR": "ir",
            "ISK": "is",
            "JMD": "jm",
            "JOD": "jo",
            "JPY": "jp",
            "KES": "ke",
            "KGS": "kg",
            "KHR": "kh",
            "KMF": "km",
            "KRW": "kr",
            "KWD": "kw",
            "KYD": "ky",
            "KZT": "kz",
            "LAK": "la",
            "LBP": "lb",
            "LKR": "lk",
            "LRD": "lr",
            "LSL": "ls",
            "LYD": "ly",
            "MAD": "ma",
            "MDL": "md",
            "MGA": "mg",
            "MKD": "mk",
            "MMK": "mm",
            "MNT": "mn",
            "MOP": "mo",
            "MRU": "mr",
            "MUR": "mu",
            "MVR": "mv",
            "MWK": "mw",
            "MXN": "mx",
            "MYR": "my",
            "MZN": "mz",
            "NAD": "na",
            "NGN": "ng",
            "NIO": "ni",
            "NOK": "no",
            "NPR": "np",
            "NZD": "nz",
            "OMR": "om",
            "PAB": "pa",
            "PEN": "pe",
            "PGK": "pg",
            "PHP": "ph",
            "PKR": "pk",
            "PLN": "pl",
            "PYG": "py",
            "QAR": "qa",
            "RON": "ro",
            "RSD": "rs",
            "RUB": "ru",
            "RWF": "rw",
            "SAR": "sa",
            "SBD": "sb",
            "SCR": "sc",
            "SDG": "sd",
            "SEK": "se",
            "SGD": "sg",
            "SHP": "sh",
            "SLE": "sl",
            "SOS": "so",
            "SRD": "sr",
            "SSP": "ss",
            "STN": "st",
            "SYP": "sy",
            "SZL": "sz",
            "THB": "th",
            "TJS": "tj",
            "TMT": "tm",
            "TND": "tn",
            "TOP": "to",
            "TRY": "tr",
            "TTD": "tt",
            "TWD": "tw",
            "TZS": "tz",
            "UAH": "ua",
            "UGX": "ug",
            "USD": "us",
            "UYU": "uy",
            "UZS": "uz",
            "VES": "ve",
            "VND": "vn",
            "VUV": "vu",
            "WST": "ws",
            "XAF": "cm",  // Cameroon as example
            "XCD": "ag",  // Antigua and Barbuda as example
            "XDR": "un",  // No flag, use placeholder
            "XOF": "bj",  // Benin as example
            "XPF": "pf",  // French Polynesia
            "YER": "ye",
            "ZAR": "za",
            "ZMW": "zm",
            "ZWL": "zw"
        };

        let baseCurrency = 'EUR';
        let amount = 1;
        let rates = {};
        let targetCurrencies = ['USD', 'BHD'];  // Initial targets like in screenshot

        async function fetchRates(base) {
            try {
                const response = await fetch(`https://open.er-api.com/v6/latest/${base}`);
                const data = await response.json();
                if (data.result === 'success') {
                    rates = data.rates;
                    document.getElementById('last-updated').innerText = new Date(data.time_last_update_utc).toLocaleString();
                    updateConversions();
                } else {
                    alert('Error fetching rates');
                }
            } catch (error) {
                alert('Network error');
            }
        }

        function getSymbol(code) {
            // Simple symbols, can expand
            const symbols = {
                'EUR': '€',
                'USD': '$',
                'BHD': 'BD',
                'GBP': '£',
                'JPY': '¥',
                // Add more as needed
            };
            return symbols[code] || code;
        }

        function populateSelect(select, selectedCode) {
            currencies.forEach(curr => {
                const option = document.createElement('option');
                option.value = curr.code;
                option.innerText = `${curr.code} - ${curr.name}`;
                if (curr.code === selectedCode) option.selected = true;
                select.appendChild(option);
            });
        }

        function createCurrencyRow(code, isBase = false) {
            const div = document.createElement('div');
            div.className = 'currency-row';
            const country = currencyToCountry[code] || 'un';
            const flagUrl = `https://flagcdn.com/w40/${country}.png`;
            div.innerHTML = `
                <img src="${flagUrl}" alt="${code} flag" class="flag">
                <select ${isBase ? 'id="base-select"' : ''}></select>
                <span class="amount">${getSymbol(code)} <input type="number" ${isBase ? 'id="amount-input" value="' + amount + '"' : 'disabled'}></span>
                <div class="rate"></div>
            `;
            const select = div.querySelector('select');
            populateSelect(select, code);
            if (!isBase) {
                select.onchange = () => {
                    const newCode = select.value;
                    div.parentNode.replaceChild(createCurrencyRow(newCode), div);
                    targetCurrencies = targetCurrencies.map(c => c === code ? newCode : c);
                    updateConversions();
                };
            } else {
                select.onchange = () => {
                    baseCurrency = select.value;
                    fetchRates(baseCurrency);
                };
                const input = div.querySelector('input');
                input.oninput = () => {
                    amount = parseFloat(input.value) || 1;
                    updateConversions();
                };
            }
            return div;
        }

        function updateConversions() {
            targetCurrencies.forEach((target, index) => {
                const row = document.getElementById('target-currencies').children[index];
                const converted = (amount * rates[target]).toFixed(2);
                row.querySelector('input').value = converted;
                row.querySelector('.rate').innerText = `1 ${baseCurrency} = ${rates[target].toFixed(4)} ${target}`;
            });
        }

        function init() {
            // Base
            document.getElementById('base-currency').appendChild(createCurrencyRow(baseCurrency, true));

            // Targets
            const targetsDiv = document.getElementById('target-currencies');
            targetCurrencies.forEach(code => {
                targetsDiv.appendChild(createCurrencyRow(code));
            });

            // Add button
            document.getElementById('add-currency').onclick = () => {
                const newCode = 'USD';  // Default new
                targetCurrencies.push(newCode);
                targetsDiv.appendChild(createCurrencyRow(newCode));
            };

            fetchRates(baseCurrency);
        }

        init();
    </script>
</body>
</html>
