<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>المِسْبَحة</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@500;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --navy1:#0a1931; 
  --navy2:#102542;
  --gold:#d4af37;
  --white:#fff;
}
body{
  margin:0; height:100%;
  font-family:"Cairo",sans-serif;
  background:linear-gradient(160deg,var(--navy1),var(--navy2));
  display:grid; place-items:center; color:var(--white);
}
.screen{width:min(440px,95vw);height:calc(100vh - 28px);
  border-radius:28px;overflow:hidden;position:relative;
  box-shadow:0 25px 60px rgba(0,0,0,.4);
  background:linear-gradient(180deg,var(--navy1),var(--navy2));
}
.topbar{display:flex;justify-content:space-between;align-items:center;padding:14px 18px}
.title{font-weight:900;font-size:22px;color:var(--gold)}
.icon-btn{width:42px;height:42px;border-radius:50%;border:2px solid var(--gold);background:rgba(255,255,255,.08);display:grid;place-items:center;cursor:pointer}
.tabs{display:flex;gap:12px;justify-content:center;padding:12px}
.tab{flex:1;text-align:center;padding:12px;border-radius:14px;border:2px solid rgba(212,175,55,.4);background:rgba(255,255,255,.08);cursor:pointer;font-weight:800;color:#d9e0ff}
.tab.active{background:linear-gradient(160deg,rgba(212,175,55,.25),rgba(255,255,255,.08));color:#fff;border-color:var(--gold)}
.phrase{text-align:center;font-size:40px;font-weight:900;margin:12px 0}
.counter{width:82%;margin:12px auto;display:grid;grid-template-columns:1fr 1fr;background:rgba(255,255,255,.08);border:2px solid rgba(212,175,55,.4);border-radius:14px}
.counter div{text-align:center;padding:14px;font-size:30px;font-weight:800}
.counter div+div{border-right:2px solid rgba(212,175,55,.35)}
.ring-wrap{width:82%;aspect-ratio:1/1;margin:16px auto;position:relative}
.ring{--p:0;position:absolute;inset:0;border-radius:50%;
  background:radial-gradient(closest-side,transparent 70%,rgba(212,175,55,.18) 71% 73%,transparent 74%),
             conic-gradient(var(--gold) calc(var(--p)*1turn),rgba(255,255,255,.2) 0);
  display:grid;place-items:center;padding:18px}
.press{width:72%;height:72%;display:grid;place-items:center;background:#fff;
  border:2px solid var(--gold);border-radius:28px;font-weight:900;font-size:36px;color:var(--navy1);cursor:pointer}
.footer{position:absolute;bottom:12px;inset-inline:0;text-align:center;color:#eee;font-weight:700}
.footer b{color:var(--gold)}
</style>
</head>
<body>
<div class="screen">
  <div class="topbar">
    <button class="icon-btn" id="btn-reset">⟳</button>
    <div class="title">المسبحة</div>
    <button class="icon-btn" id="btn-next">→</button>
  </div>
  <div class="tabs">
    <button id="tabZ" class="tab active">تسبيح الزهراء</button>
    <button id="tabO" class="tab">التسبيح المفتوح</button>
  </div>
  <div class="phrase" id="phrase">الله أكبر</div>
  <div class="counter"><div id="leftNum">34</div><div id="rightNum">0</div></div>
  <div class="ring-wrap">
    <div class="ring" id="ring" style="--p:0">
      <button class="press" id="press">إضغط</button>
    </div>
  </div>
  <div class="footer">برمجة وتطوير : <b>فاضل الريس</b></div>
</div>

<script>
const SEQ=[{text:"الله أكبر",max:34},{text:"الحمد لله",max:33},{text:"سبحان الله",max:33}];
let mode=localStorage.getItem('mode')||'zahra';
let zh=JSON.parse(localStorage.getItem('zh')||'{"step":0,"count":0}');
let op=JSON.parse(localStorage.getItem('op')||'{"text":"سبحان الله","count":0,"target":0}');
const phrase=document.getElementById('phrase'),left=document.getElementById('leftNum'),right=document.getElementById('rightNum'),ring=document.getElementById('ring'),press=document.getElementById('press');
const tabZ=document.getElementById('tabZ'),tabO=document.getElementById('tabO');
function vibrate(ms){try{navigator.vibrate(ms);}catch{}}
function render(){
  if(mode==='zahra'){const cur=SEQ[zh.step]||{text:'تم التسبيح',max:1};phrase.textContent=cur.text;left.textContent=cur.max;right.textContent=zh.count;ring.style.setProperty('--p',zh.count/cur.max);}
  else {phrase.textContent=op.text;left.textContent=op.target>0?op.target:'∞';right.textContent=op.count;ring.style.setProperty('--p',op.target?op.count/op.target:0);}
}
function tick(){
  if(mode==='zahra'){
    const cur=SEQ[zh.step];
    if(!cur){zh={step:0,count:0};}
    else{
      zh.count++;
      if(zh.count>=cur.max){
        zh.step++; zh.count=0;
        vibrate([100,50,100]); // يهتز عند الانتهاء من المرحلة
      }
    }
    if(zh.step>=SEQ.length){
      phrase.textContent="تم التسبيح ✔";
      left.textContent="0";right.textContent="0";ring.style.setProperty("--p",1);
      vibrate([200,100,200]); // يهتز عند انتهاء كل التسبيح
    }
    localStorage.setItem('zh',JSON.stringify(zh));
  }else{
    op.count++;
    if(op.target>0 && op.count>=op.target){
      vibrate([200,100,200]); // يهتز عند بلوغ الهدف
    }
    localStorage.setItem('op',JSON.stringify(op));
  }
  render();
}
press.onclick=tick;
document.getElementById('btn-next').onclick=()=>{mode=mode==='zahra'?'open':'zahra';localStorage.setItem('mode',mode);tabZ.classList.toggle('active',mode==='zahra');tabO.classList.toggle('active',mode==='open');render();}
document.getElementById('btn-reset').onclick=()=>{zh={step:0,count:0};op={text:'سبحان الله',count:0,target:0};localStorage.setItem('zh',JSON.stringify(zh));localStorage.setItem('op',JSON.stringify(op));render();}
tabZ.onclick=()=>{mode='zahra';localStorage.setItem('mode',mode);tabZ.classList.add('active');tabO.classList.remove('active');render();}
tabO.onclick=()=>{mode='open';localStorage.setItem('mode',mode);tabO.classList.add('active');tabZ.classList.remove('active');render();}
render();
</script>
</body>
</html>
