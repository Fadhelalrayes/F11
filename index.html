<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø³ÙŠØ±Ø© â€” Ù‚Ø§Ù„Ø¨ Ø¬Ø§Ù†Ø¨ÙŠ Ø°Ù‡Ø¨ÙŠ/Ø¯Ø§ÙƒÙ† (Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†)</title>
<style>
  :root{
    --bg:#ffffff; --fg:#0f172a; --muted:#475569;
    --accent:#C7A046; --accent-2:#EAD9A2;
    --side:#111827; --side-text:#e5e7eb; --border:#e5e7eb;
    --radius:14px; --shadow:0 8px 28px rgba(15,23,42,.08);
  }
  html,body{background:var(--bg);color:var(--fg);font-family:"Cairo","Noto Naskh Arabic",system-ui,Arial;line-height:1.55}
  *{box-sizing:border-box}
  h1,h2,h3{margin:0}
  .wrap{max-width:1100px;margin:20px auto;padding:0 14px}
  .step{position:sticky;top:0;z-index:5;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);padding:10px 12px;margin-bottom:14px}
  .card{background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);margin-bottom:12px}
  .card-h{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
  .card-b{padding:14px 16px}
  .toggle{border:1px solid var(--border);background:#fff;border-radius:10px;width:34px;height:34px;font-weight:800;cursor:pointer}
  .row{display:grid;gap:10px}
  .two{grid-template-columns:1fr}
  @media(min-width:640px){.two{grid-template-columns:1fr 1fr}}

  label{font-size:13px;color:var(--muted);font-weight:700}
  input[type="text"],input[type="email"],input[type="url"],textarea,select{
    width:100%;border:1px solid var(--border);border-radius:10px;padding:10px 12px;outline:none;background:#fff
  }
  textarea{min-height:90px;resize:vertical}
  input:focus,textarea:focus,select:focus{border-color:var(--accent)}

  /* +973 fixed phone */
  .phone{display:flex;align-items:center;border:1px solid var(--border);border-radius:10px;overflow:hidden}
  .phone .pre{background:#fafaf9;color:#7a5a16;border-inline-end:1px solid var(--border);padding:10px 12px;font-weight:800}
  .phone input{border:none;flex:1;padding:10px 12px;outline:none}
  .hint{font-size:12px;color:var(--muted)}

  /* ===== CV TEMPLATE (matches screenshot) ===== */
  .cv{display:grid;grid-template-columns:320px 1fr;min-height:500px;border:1px solid var(--border);border-radius:12px;overflow:hidden}
  .cv .side{background:var(--side);color:var(--side-text);padding:24px}
  .avatar{width:140px;height:140px;border-radius:999px;overflow:hidden;border:6px solid var(--accent);box-shadow:var(--shadow);background:#222;margin:0 auto}
  .avatar img{width:100%;height:100%;object-fit:cover}
  .side .name{color:#fff;text-align:center;margin-top:16px}
  .side .name h1{font-size:26px;font-weight:900}
  .side .name p{margin-top:4px;color:#cbd5e1}
  .side .sec{margin-top:22px}
  .tag{display:inline-flex;align-items:center;gap:8px;color:#fff;font-weight:800}
  .tag:before{content:"";display:inline-block;width:18px;height:18px;border-radius:50%;background:var(--accent)}
  .side hr{border:none;border-top:1px solid rgba(255,255,255,.08);margin:10px 0}
  .contact p{margin:6px 0}
  .skill{display:flex;align-items:center;gap:10px;margin:8px 0}
  .skill span{min-width:90px}
  .bar{flex:1;height:8px;background:#1f2937;border-radius:99px;overflow:hidden;border:1px solid rgba(255,255,255,.08)}
  .bar i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#d9b96b)}
  .side ul{margin:8px 0 0 18px}
  .side li{margin:4px 0}

  .cv .main{background:#fff;padding:26px}
  .block{margin-bottom:22px}
  .block h2{display:flex;align-items:center;gap:8px;font-size:18px}
  .block h2:before{content:"";display:inline-block;width:28px;height:28px;border-radius:50%;background:var(--accent);opacity:.9}
  .underline{height:3px;background:var(--accent-2);width:80px;margin:8px 0 10px;border-radius:99px}
  .job{margin-bottom:12px}
  .job h3{font-size:16px}
  .meta{color:#64748b;font-size:13px;margin:2px 0 6px}
  .main ul{margin:6px 0 0 18px} .main li{margin:4px 0}

  /* Bottom bar */
  .bottom{position:sticky;bottom:0;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);margin:14px 0;padding:10px 12px;display:flex;gap:8px;justify-content:center;align-items:center}
  .btn{border:1px solid var(--accent);background:var(--accent);color:#fff;padding:9px 12px;border-radius:10px;cursor:pointer;font-weight:800}
  .btn.ghost{background:#fff;color:var(--accent)}
  .btn[disabled]{opacity:.5;cursor:not-allowed}
  .hide{display:none}

  /* Print */
  @page{size:A4;margin:16mm}
  @media print{.no-print{display:none!important}.cv{border:none}}
</style>
</head>
<body>
<div class="wrap">

  <div class="step no-print"><strong>Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø«Ù… Ù†Ø²Ù‘Ù„ Ø§Ù„Ø³ÙŠØ±Ø© â€” Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ.</strong></div>

  <!-- ===== FORM (Ù…Ø®ØªØµØ± + Ù‚ÙˆØ§Ø¦Ù…) ===== -->
  <section class="card no-print">
    <div class="card-h"><h2>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2><button class="toggle" aria-expanded="true">+</button></div>
    <div class="card-b" id="formWrap">
      <div class="row two">
        <div><label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ *</label><input id="fullName" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù„ÙŠ Ø­Ø³Ù† Ù…Ø­Ù…Ø¯" required></div>
        <div><label>Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù *</label><input id="title" type="text" placeholder="Ù…Ø«Ø§Ù„: Ù…ØµÙ…Ù… Ø¬Ø±Ø§ÙÙŠÙƒ" required></div>

        <div><label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label><input id="email" type="email" placeholder="name@example.com" required></div>
        <div>
          <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†) *</label>
          <div class="phone"><span class="pre">+973</span><input id="phoneDigits" type="text" inputmode="numeric" maxlength="8" placeholder="Ø£Ø¯Ø®Ù„ 8 Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·"></div>
          <div class="hint">Ø§Ù„Ø¨Ø§Ø¯Ø¦Ø© Ø«Ø§Ø¨ØªØ© â€” Ø§ÙƒØªØ¨ Ø§Ù„Ø«Ù…Ø§Ù†ÙŠØ© Ø£Ø±Ù‚Ø§Ù….</div>
        </div>

        <div><label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© / Ø§Ù„Ø¯ÙˆÙ„Ø© *</label><input id="location" type="text" value="Ø§Ù„Ù…Ù†Ø§Ù…Ø©ØŒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†" required></div>
        <div><label>Ø±Ø§Ø¨Ø· Ù…ÙˆÙ‚Ø¹/Ø¨ÙˆØ±ØªÙÙˆÙ„ÙŠÙˆ</label><input id="website" type="url" placeholder="your-portfolio.com"></div>

        <div>
          <label>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¹Ù„Ù…ÙŠ *</label>
          <select id="eduLevel" required>
            <option value="">Ø§Ø®ØªØ±â€¦</option>
            <option>Ø¯Ø¨Ù„ÙˆÙ…</option><option>Ø¨ÙƒØ§Ù„ÙˆØ±ÙŠÙˆØ³</option><option>Ù…Ø§Ø¬Ø³ØªÙŠØ±</option><option>Ø¯ÙƒØªÙˆØ±Ø§Ù‡</option>
          </select>
        </div>
        <div>
          <label>Ø§Ù„Ø¬Ù†Ø³ÙŠØ© *</label>
          <select id="nationality" required>
            <option value="">Ø§Ø®ØªØ±â€¦</option>
            <option>Ø¨Ø­Ø±ÙŠÙ†ÙŠØ©</option><option>Ø³Ø¹ÙˆØ¯ÙŠØ©</option><option>Ø¥Ù…Ø§Ø±Ø§ØªÙŠØ©</option><option>ÙƒÙˆÙŠØªÙŠØ©</option><option>Ø¹ÙÙ…Ø§Ù†ÙŠØ©</option>
            <option>Ù…ØµØ±ÙŠØ©</option><option>Ø£Ø±Ø¯Ù†ÙŠØ©</option><option>Ø³ÙˆØ±ÙŠØ©</option><option>Ù„Ø¨Ù†Ø§Ù†ÙŠØ©</option><option>ÙÙ„Ø³Ø·ÙŠÙ†ÙŠØ©</option>
            <option>Ù‡Ù†Ø¯ÙŠØ©</option><option>Ø¨Ø§ÙƒØ³ØªØ§Ù†ÙŠØ©</option><option>Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´ÙŠØ©</option><option>ÙÙ„Ø¨ÙŠÙ†ÙŠØ©</option>
            <option>Ø£Ø®Ø±Ù‰</option>
          </select>
        </div>

        <div>
          <label>Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø±Ø®ØµØ© Ù‚ÙŠØ§Ø¯Ø©ØŸ *</label>
          <select id="hasLicense" required><option value="">Ø§Ø®ØªØ±â€¦</option><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select>
        </div>
        <div>
          <label>Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ù…ÙˆØ§ØµÙ„Ø§ØªØŸ *</label>
          <select id="hasTransport" required><option value="">Ø§Ø®ØªØ±â€¦</option><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select>
        </div>
      </div>

      <div class="row two" style="margin-top:6px">
        <div>
          <label>Ø§Ù„ØªØ®ØµØµ *</label>
          <select id="majorList" required>
            <option value="">Ø§Ø®ØªØ±â€¦</option>
            <option>ØªØµÙ…ÙŠÙ… Ø¬Ø±Ø§ÙÙŠÙƒ</option><option>Ù‡Ù†Ø¯Ø³Ø© Ø¨Ø±Ù…Ø¬ÙŠØ§Øª</option><option>Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³Ø¨</option>
            <option>Ù…Ø­Ø§Ø³Ø¨Ø©</option><option>Ø¥Ø¯Ø§Ø±Ø© Ø£Ø¹Ù…Ø§Ù„</option><option value="other">Ø£Ø®Ø±Ù‰ (Ø§ÙƒØªØ¨Ù‡Ø§)</option>
          </select>
        </div>
        <div id="majorCustomBox" class="hide"><label>Ø§ÙƒØªØ¨ Ø§Ù„ØªØ®ØµØµ</label><input id="majorCustom" type="text" placeholder="Ù…Ø«Ø§Ù„: ØªØµÙ…ÙŠÙ… ÙˆØ§Ø¬Ù‡Ø§Øª UI"></div>
      </div>

      <div style="margin-top:6px">
        <label>Ø§Ù„Ù„ØºØ§Øª (Ø¶Ø¹ âœ”ï¸)</label>
        <div class="chipline" id="langChecks">
          <label class="chip"><input type="checkbox" value="Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"> Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</label>
          <label class="chip"><input type="checkbox" value="Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©"> Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</label>
          <label class="chip"><input type="checkbox" value="Ø§Ù„Ù‡Ù†Ø¯ÙŠØ©"> Ø§Ù„Ù‡Ù†Ø¯ÙŠØ©</label>
          <label class="chip"><input type="checkbox" value="Ø§Ù„Ø£ÙˆØ±Ø¯Ùˆ"> Ø§Ù„Ø£ÙˆØ±Ø¯Ùˆ</label>
          <label class="chip"><input type="checkbox" value="Ø£Ø®Ø±Ù‰"> Ø£Ø®Ø±Ù‰</label>
        </div>
      </div>

      <div class="row two" style="margin-top:6px">
        <div>
          <label>Ø§Ù„Ù…Ø¤Ø³Ø³Ø© (Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†)</label>
          <select id="bhInstitution">
            <option value="">Ø§Ø®ØªØ±â€¦</option>
            <option>Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option><option>Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø®Ù„ÙŠØ¬ Ø§Ù„Ø¹Ø±Ø¨ÙŠ</option>
            <option>Ø¨ÙˆÙ„ÙŠØªÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option><option>RCSI Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option><option>BIBF</option>
            <option value="abroad">Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
          </select>
        </div>
        <div><label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ®Ø±Ø¬</label><input id="gradDate" type="text" placeholder="YYYY-MM"></div>
      </div>

      <div id="abroadBox" class="row two hide">
        <div>
          <label>Ø§Ù„Ø¯ÙˆÙ„Ø©</label>
          <select id="country">
            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©â€¦</option>
            <option>Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option><option>Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option><option>Ø§Ù„ÙƒÙˆÙŠØª</option><option>Ø¹ÙÙ…Ø§Ù†</option><option>Ù‚Ø·Ø±</option>
            <option>Ù…ØµØ±</option><option>Ø§Ù„Ø£Ø±Ø¯Ù†</option><option>Ø§Ù„Ù‡Ù†Ø¯</option><option>Ø¨Ø§ÙƒØ³ØªØ§Ù†</option>
            <option>Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©</option><option>Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option><option>Ø£Ù„Ù…Ø§Ù†ÙŠØ§</option><option>ØªØ±ÙƒÙŠØ§</option>
            <option>Ø£Ø®Ø±Ù‰</option>
          </select>
        </div>
        <div><label>Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©</label><input id="uniName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©"></div>
        <div><label>Ø§Ù„ØªØ®ØµØµ</label><input id="uniMajor" type="text" placeholder="Ø§Ù„ØªØ®ØµØµ"></div>
      </div>

      <div style="margin-top:6px">
        <label>Ù…Ù„Ù Ø´Ø®ØµÙŠ (3â€“4 Ø¬Ù…Ù„)</label>
        <textarea id="summary" maxlength="450" placeholder="Ù†Ø¨Ø°Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…Ø®ØªØµØ±Ø©â€¦"></textarea>
        <div class="hint"><span id="sumCount">0</span> / 450</div>
      </div>

      <div style="margin-top:6px">
        <label>Ø®Ø¨Ø±ØªØ§Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) â€” Ù„ÙƒÙ„ ÙˆØ¸ÙŠÙØ© Ø¹Ù†ÙˆØ§Ù† ÙˆØ´Ø±ÙƒØ© ÙˆÙ†Ù‚Ø·ØªØ§Ù†</label>
        <div class="row two">
          <div><input id="job1_role" type="text" placeholder="Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ #1"></div>
          <div><input id="job1_meta" type="text" placeholder="Ø§Ù„Ø´Ø±ÙƒØ© | Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© | Ø§Ù„Ù…Ø¯Ø©"></div>
          <div><input id="job1_b1" type="text" placeholder="Ø¥Ù†Ø¬Ø§Ø² 1"></div>
          <div><input id="job1_b2" type="text" placeholder="Ø¥Ù†Ø¬Ø§Ø² 2"></div>
        </div>
        <div class="row two" style="margin-top:8px">
          <div><input id="job2_role" type="text" placeholder="Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ #2"></div>
          <div><input id="job2_meta" type="text" placeholder="Ø§Ù„Ø´Ø±ÙƒØ© | Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© | Ø§Ù„Ù…Ø¯Ø©"></div>
          <div><input id="job2_b1" type="text" placeholder="Ø¥Ù†Ø¬Ø§Ø² 1"></div>
          <div><input id="job2_b2" type="text" placeholder="Ø¥Ù†Ø¬Ø§Ø² 2"></div>
        </div>
      </div>

      <div style="margin-top:6px">
        <label>Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª (Ø§ÙƒØªØ¨ Ù†Ø³Ø¨Ø© Ù„ÙƒÙ„ Ù…Ù‡Ø§Ø±Ø© 0â€“100)</label>
        <div class="row two">
          <div><input id="sk1" type="text" placeholder="Photoshop: 90"></div>
          <div><input id="sk2" type="text" placeholder="Illustrator: 80"></div>
          <div><input id="sk3" type="text" placeholder="Web Design: 70"></div>
        </div>
      </div>

      <div style="margin-top:6px">
        <label>Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª (Ø³Ø·ÙˆØ± Ù‚ØµÙŠØ±Ø©)</label>
        <textarea id="interests" placeholder="ÙÙ† Ø¨Ø³ÙŠØ·\nØªØµÙˆÙŠØ± Ø­Ø¶Ø±ÙŠ\nØªØ±ÙƒÙŠØ¨Ø§Øª ÙÙ†ÙŠØ©"></textarea>
      </div>

      <div style="margin-top:6px">
        <label>Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
        <input id="photoUrl" type="url" placeholder="https://example.com/me.jpg">
      </div>
    </div>
  </section>

  <!-- ===== PREVIEW (Template) ===== -->
  <section class="card">
    <div class="card-b">
      <article id="cv" class="cv">
        <!-- Sidebar -->
        <aside class="side">
          <div class="avatar" id="v_avatar"><img alt="" src="" onerror="this.style.display='none'"></div>
          <div class="name">
            <h1 id="v_name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</h1>
            <p id="v_title">Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù</p>
          </div>

          <div class="sec contact">
            <div class="tag">Ø§Ù„ØªÙˆØ§ØµÙ„</div><hr>
            <p id="v_email">email@example.com</p>
            <p id="v_phone">+973 3xxxxxxx</p>
            <p id="v_site">website.com</p>
            <p id="v_loc">Ø§Ù„Ù…Ù†Ø§Ù…Ø©ØŒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</p>
          </div>

          <div class="sec">
            <div class="tag">Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª</div><hr id="skills_hr">
            <div id="v_skills">
              <!-- skill rows -->
            </div>
          </div>

          <div class="sec">
            <div class="tag">Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª</div><hr>
            <ul id="v_interests"></ul>
          </div>
        </aside>

        <!-- Main -->
        <section class="main">
          <div class="block" id="b_profile">
            <h2>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
            <div class="underline"></div>
            <p id="v_summary">Ø§ÙƒØªØ¨ Ù†Ø¨Ø°Ø© Ù…Ø®ØªØµØ±Ø© Ù‡Ù†Ø§â€¦</p>
          </div>

          <div class="block" id="b_exp">
            <h2>Ø§Ù„Ø®Ø¨Ø±Ø©</h2>
            <div class="underline"></div>
            <div id="v_exp"></div>
          </div>

          <div class="block" id="b_edu">
            <h2>Ø§Ù„ØªØ¹Ù„ÙŠÙ…</h2>
            <div class="underline"></div>
            <div id="v_edu"></div>
          </div>

          <div class="block" id="b_port">
            <h2>Ø£Ø¹Ù…Ø§Ù„ / Portfolio</h2>
            <div class="underline"></div>
            <ul id="v_langs"></ul>
          </div>
        </section>
      </article>
    </div>
  </section>

  <!-- Bottom download bar -->
  <div class="bottom no-print">
    <span id="readyMsg" class="hint">Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©â€¦</span>
    <button class="btn" id="btnPdf" disabled>ğŸ–¨ï¸ PDF</button>
    <button class="btn ghost" id="btnDoc" disabled>â¬‡ï¸ Word</button>
  </div>

</div>

<script>
(()=>{
  const $=(s,r=document)=>r.querySelector(s), $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
  const F={
    name:$('#fullName'), title:$('#title'), email:$('#email'),
    phone:$('#phoneDigits'), loc:$('#location'), site:$('#website'),
    sum:$('#summary'), sumCount:$('#sumCount'),
    eduLevel:$('#eduLevel'), nationality:$('#nationality'),
    hasLic:$('#hasLicense'), hasTrans:$('#hasTransport'),
    majorList:$('#majorList'), majorCustom:$('#majorCustom'), majorBox:$('#majorCustomBox'),
    bhInst:$('#bhInstitution'), gradDate:$('#gradDate'),
    abroadBox:$('#abroadBox'), country:$('#country'), uniName:$('#uniName'), uniMajor:$('#uniMajor'),
    job1:{role:$('#job1_role'), meta:$('#job1_meta'), b1:$('#job1_b1'), b2:$('#job1_b2')},
    job2:{role:$('#job2_role'), meta:$('#job2_meta'), b1:$('#job2_b1'), b2:$('#job2_b2')},
    sk1:$('#sk1'), sk2:$('#sk2'), sk3:$('#sk3'),
    interests:$('#interests'), photo:$('#photoUrl'),
  };

  function sanitize(s){return (s||'').toString().replace(/\s+/g,' ').trim();}
  function bhPhone(){ const d=(F.phone.value||'').replace(/\D/g,'').slice(0,8); F.phone.value=d; return d?`+973 ${d.slice(0,3)}${d.slice(3,6)}${d.slice(6)}`:''; }

  // Toggles for selects
  F.majorList.addEventListener('change',()=>{ F.majorBox.classList.toggle('hide', F.majorList.value!=='other'); renderEdu(); });
  F.bhInst.addEventListener('change',()=>{ F.abroadBox.classList.toggle('hide', F.bhInst.value!=='abroad'); renderEdu(); });

  // Update preview header/sidebar
  function updateAll(){
    // avatar
    const url=sanitize(F.photo.value);
    const img=$('#v_avatar img');
    if(url){ img.src=url; img.style.display='block'; } else { img.removeAttribute('src'); img.style.display='none'; }

    $('#v_name').textContent = sanitize(F.name.value) || 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„';
    $('#v_title').textContent = sanitize(F.title.value) || 'Ø§Ù„Ù…Ø³Ù…Ù‘Ù‰ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù';
    $('#v_email').textContent = sanitize(F.email.value) || 'email@example.com';
    $('#v_phone').textContent = bhPhone() || '+973 3xxxxxxx';
    $('#v_site').textContent = sanitize(F.site.value || '');
    $('#v_loc').textContent = sanitize(F.loc.value || 'Ø§Ù„Ù…Ù†Ø§Ù…Ø©ØŒ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†');

    // summary
    F.sumCount.textContent = F.sum.value.length;
    $('#v_summary').textContent = sanitize(F.sum.value) || 'Ø§ÙƒØªØ¨ Ù†Ø¨Ø°Ø© Ù…Ø®ØªØµØ±Ø© Ù‡Ù†Ø§â€¦';

    // skills
    renderSkills();

    // interests
    const ul=$('#v_interests'); ul.innerHTML='';
    (F.interests.value||'').split(/\n+/).map(s=>sanitize(s)).filter(Boolean).forEach(t=>{
      const li=document.createElement('li'); li.textContent=t; ul.appendChild(li);
    });

    // experience
    renderExp();

    // edu
    renderEdu();

    // languages -> show in Portfolio block as Ù†Ù‚Ø§Ø· (Ø£Ùˆ ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„Ø§Ø­Ù‚Ù‹Ø§)
    renderLangs();

    checkReady();
  }

  // Languages from checkboxes
  function renderLangs(){
    const list=$('#v_langs'); list.innerHTML='';
    $$('#langChecks input:checked').forEach(cb=>{
      const li=document.createElement('li'); li.textContent=cb.value; list.appendChild(li);
    });
  }

  // Skills parsing "Name: percent"
  function parseSkill(line){
    const m=String(line).split(':'); if(m.length<2) return null;
    const name=sanitize(m[0]); const p=Math.max(0,Math.min(100, parseInt(m[1],10)||0));
    return {name, p};
  }
  function renderSkills(){
    const box=$('#v_skills'); box.innerHTML='';
    const items=[F.sk1.value,F.sk2.value,F.sk3.value].map(parseSkill).filter(Boolean);
    if(items.length===0){ $('#skills_hr').style.display='none'; return; }
    $('#skills_hr').style.display='block';
    items.forEach(it=>{
      const row=document.createElement('div'); row.className='skill';
      row.innerHTML=`<span>${it.name}</span><div class="bar"><i style="width:${it.p}%"></i></div>`;
      box.appendChild(row);
    });
  }

  function renderExp(){
    const box=$('#v_exp'); box.innerHTML='';
    [F.job1,F.job2].forEach(J=>{
      const role=sanitize(J.role.value), meta=sanitize(J.meta.value), b1=sanitize(J.b1.value), b2=sanitize(J.b2.value);
      if(!(role||meta||b1||b2)) return;
      const w=document.createElement('div'); w.className='job';
      w.innerHTML=`<h3>${role||''}</h3><div class="meta">${meta||''}</div>`;
      const ul=document.createElement('ul'); [b1,b2].filter(Boolean).forEach(t=>{const li=document.createElement('li'); li.textContent=t; ul.appendChild(li);});
      w.appendChild(ul); box.appendChild(w);
    });
    $('#b_exp').style.display = box.children.length? 'block':'none';
  }

  function currentMajor(){ return F.majorList.value==='other'? sanitize(F.majorCustom.value) : F.majorList.value; }

  function renderEdu(){
    const box=$('#v_edu'); box.innerHTML='';
    let title='', meta='';
    if(F.bhInst.value && F.bhInst.value!=='abroad'){
      title = `${F.eduLevel.value||''} â€” ${currentMajor()||''}`;
      meta  = `${F.bhInst.value}${F.gradDate.value?(' Â· '+F.gradDate.value):''}`;
    } else if(F.bhInst.value==='abroad'){
      title = `${F.eduLevel.value||''} â€” ${sanitize(F.uniMajor.value)||currentMajor()||''}`;
      const uni = sanitize(F.uniName.value);
      const cnt = F.country.value||'';
      meta = [uni,cnt,F.gradDate.value].filter(Boolean).join(' Â· ');
    }
    if(title||meta){
      const d=document.createElement('div');
      d.innerHTML=`<h3>${title}</h3><div class="meta">${meta}</div>`;
      box.appendChild(d);
      $('#b_edu').style.display='block';
    }else{
      $('#b_edu').style.display='none';
    }
  }

  // Ready check
  const btnPdf=$('#btnPdf'), btnDoc=$('#btnDoc'), readyMsg=$('#readyMsg');
  function isReady(){
    const ok = sanitize(F.name.value) && sanitize(F.title.value) && sanitize(F.email.value) &&
               (F.phone.value||'').replace(/\D/g,'').length===8 && sanitize(F.loc.value) &&
               F.eduLevel.value && F.nationality.value && F.hasLic.value && F.hasTrans.value &&
               (F.majorList.value && (F.majorList.value!=='other' || sanitize(F.majorCustom.value)));
    return !!ok;
  }
  function checkReady(){
    const r=isReady(); [btnPdf,btnDoc].forEach(b=>b.disabled=!r);
    readyMsg.textContent = r ? 'Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ†Ø²ÙŠÙ„ Ø¨Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ.' : 'Ø£ÙƒÙ…Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©â€¦';
  }

  // Events
  ['input','change'].forEach(ev=>{
    [
      F.name,F.title,F.email,F.phone,F.loc,F.site,F.sum,F.eduLevel,F.nationality,
      F.hasLic,F.hasTrans,F.majorList,F.majorCustom,F.bhInst,F.gradDate,F.country,F.uniName,F.uniMajor,
      F.job1.role,F.job1.meta,F.job1.b1,F.job1.b2,
      F.job2.role,F.job2.meta,F.job2.b1,F.job2.b2,
      F.sk1,F.sk2,F.sk3,F.interests,F.photo
    ].forEach(el=>el.addEventListener(ev, updateAll));
  });
  $$('#langChecks input').forEach(cb=>cb.addEventListener('change', updateAll));

  // Bottom actions
  btnPdf.addEventListener('click', ()=>{ if(isReady()) window.print(); });
  btnDoc.addEventListener('click', ()=>{
    if(!isReady()) return;
    const cv=$('#cv').cloneNode(true);
    const styles=`<style>
      body{font-family:"Cairo","Noto Naskh Arabic",Arial;direction:rtl}
      .cv{display:grid;grid-template-columns:320px 1fr}
      .cv .side{background:#111827;color:#e5e7eb;padding:24px}
      .cv .main{padding:26px}
      .bar i{display:block;height:8px;background:linear-gradient(90deg,#C7A046,#d9b96b)}
      .underline{height:3px;background:#EAD9A2;width:80px;margin:8px 0 10px;border-radius:99px}
      .meta{color:#64748b;font-size:13px}
      ul{margin:6px 0 0 18px} li{margin:4px 0}
    </style>`;
    const html=`<!DOCTYPE html><html><head><meta charset="utf-8"><title>CV</title>${styles}</head><body>${cv.outerHTML}</body></html>`;
    const blob=new Blob([html],{type:'application/msword'});
    const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='CV-Template.doc'; a.click();
    setTimeout(()=>URL.revokeObjectURL(url),200);
  });

  // Initial
  updateAll();
})();
</script>
</body>
</html>
