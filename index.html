<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>الأيام الصالحة والمكروهة للزواج (هجري/ميلادي)</title>
<style>
  :root{
    --bg:#0d0d0f;
    --card:#17171b;
    --gold1:#f2c268;
    --gold2:#bf8e2c;
    --text:#eee;
    --muted:#b8b8be;
    --ok:#1e7f34;
    --bad:#b83a3a;
    --chip:#222229;
    --ring:#2b2b33;
    --radius:18px;
    --shadow: 0 10px 28px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.04);
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:radial-gradient(1200px 600px at 50% -50%, #1b1b21 0%, var(--bg) 50%);
    font-family: "Tajawal", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
  }

  .wrap{max-width:960px; margin:24px auto; padding:16px}
  .hero{
    background: linear-gradient(135deg, #1b1b20, #0f0f12);
    border-radius: 28px; padding:20px; box-shadow: var(--shadow); position:relative; overflow:hidden;
  }
  .hero .title{
    display:flex; align-items:center; gap:12px; margin-bottom:8px;
    font-weight:800; font-size:26px; letter-spacing:.3px;
  }
  .coin{
    width:52px; height:52px; border-radius:50%;
    background:radial-gradient(circle at 35% 30%, #fff6d9, #ffd87a 40%, #bf8e2c 70%, #8a6221 100%);
    box-shadow:0 6px 12px rgba(0,0,0,.35), inset 0 2px 4px rgba(255,255,255,.2);
    flex:0 0 52px;
  }
  .subtitle{color:var(--muted); font-size:14px}

  .controls{
    display:flex; flex-wrap:wrap; gap:12px; margin-top:16px
  }
  .btn{
    background: linear-gradient(180deg, #2c2c33, #1b1b21);
    border:1px solid var(--ring);
    padding:10px 14px; border-radius:14px; color:#fff; cursor:pointer; font-weight:700;
    box-shadow: var(--shadow); transition:.15s transform ease;
  }
  .btn:hover{ transform: translateY(-2px) }
  .btn.gold{
    background: linear-gradient(180deg, var(--gold1), var(--gold2));
    color:#090a0f; border-color:#8c6a24;
  }
  .input{
    background:#121217; border:1px solid var(--ring); color:#fff;
    padding:10px 12px; border-radius:14px; outline:none; box-shadow: var(--shadow)
  }

  .legend{
    display:flex; gap:10px; flex-wrap:wrap; margin:18px 0 8px
  }
  .chip{
    display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px;
    background: var(--chip); border:1px solid var(--ring); color:#fff; font-weight:700; font-size:13px
  }
  .dot{width:10px; height:10px; border-radius:50%}
  .dot.ok{background:var(--ok)}
  .dot.bad{background:var(--bad)}
  .dot.neutral{background:#666}

  .cal{
    margin-top:14px; background:var(--card); border-radius:var(--radius); box-shadow: var(--shadow); overflow:hidden
  }
  table{width:100%; border-collapse:collapse}
  thead th{
    background: linear-gradient(180deg, #1f1f25, #17171b); color:#d9d9de; font-weight:800; font-size:13px;
    padding:12px 10px; border-bottom:1px solid #202028; text-align:center
  }
  tbody td{
    padding:12px 10px; border-bottom:1px dashed #23232c; text-align:center; vertical-align:middle
  }
  tbody tr:hover{background:#141419}
  .badge{
    display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px;
    font-weight:800; font-size:12px; border:1px solid #0003;
  }
  .badge.ok{ background:rgba(30,127,52,.18); color:#c8f7c5; border-color:rgba(30,127,52,.35) }
  .badge.bad{ background:rgba(184,58,58,.18); color:#ffd1d1; border-color:rgba(184,58,58,.35) }
  .badge.neutral{ background:rgba(150,150,160,.15); color:#ddd }

  .monthbar{
    display:flex; justify-content:space-between; align-items:center; gap:10px; padding:12px 14px;
    border-bottom:1px solid #202028; background: linear-gradient(180deg, #1f1f25, #17171b)
  }
  .monthbar h2{margin:0; font-size:18px}
  .monthbar small{display:block; color:var(--muted); font-weight:600}

  .footer{
    margin-top:14px; color:#9a9aa2; font-size:12px; text-align:center
  }
  @media (max-width:680px){
    thead th:nth-child(2), tbody td:nth-child(2){display:none} /* إخفاء اليوم الميلادي في الشاشات الصغيرة */
  }
</style>
</head>
<body>
  <div class="wrap">
    <section class="hero">
      <div class="title">
        <div class="coin"></div>
        <div>
          الأيام الصالحة والمكروهة للزواج
          <div class="subtitle">تقويم هجري/ميلادي مع تمييز الأيام وفق القواعد التي تحددها</div>
        </div>
      </div>

      <div class="controls">
        <button class="btn" id="prevMonth">◀ الشهر السابق</button>
        <button class="btn" id="nextMonth">الشهر التالي ▶</button>
        <button class="btn gold" id="goToday">اذهب إلى اليوم</button>
        <input class="input" type="month" id="pickMonth" aria-label="اختر شهرًا" />
        <input class="input" type="date" id="pickDate" aria-label="اذهب إلى تاريخ" />
      </div>

      <div class="legend">
        <span class="chip"><span class="dot ok"></span> صالح للزواج</span>
        <span class="chip"><span class="dot bad"></span> مكروه</span>
        <span class="chip"><span class="dot neutral"></span> عادي</span>
      </div>
    </section>

    <section class="cal" id="calendar">
      <!-- يُنشأ بالـ JS -->
    </section>

    <p class="footer">لأفضل دقّة هجريًا نستخدم تقويم <strong>Umm al-Qura</strong> المدعوم في المتصفحات عبر
      <code>Intl.DateTimeFormat</code>. قد تختلف بداية الشهر في بعض البلدان بيوم ±1.</p>
  </div>

<script>
/* === أدوات التاريخ (هجري/ميلادي) === */
const hasUmmAlQura = Intl && Intl.DateTimeFormat
  ? Intl.DateTimeFormat.supportedLocalesOf(["ar-SA-u-ca-islamic-umalqura"]).length > 0
  : false;

function toHijriParts(date){
  // نستخدم formatToParts للحصول على (يوم/شهر/سنة) هجريين
  const fmt = new Intl.DateTimeFormat('ar-SA-u-ca-' + (hasUmmAlQura ? 'islamic-umalqura' : 'islamic'), {
    day:'numeric', month:'numeric', year:'numeric'
  });
  const parts = fmt.formatToParts(date).reduce((acc,p)=>{
    if(p.type==='day') acc.d = parseInt(p.value,10);
    if(p.type==='month') acc.m = parseInt(p.value,10);
    if(p.type==='year') acc.y = parseInt(p.value,10);
    return acc;
  }, {d:0,m:0,y:0});
  return parts;
}
function hijriLabel(date){
  const p = toHijriParts(date);
  const mNames = ["محرم","صفر","ربيع الأول","ربيع الآخر","جمادى الأولى","جمادى الآخرة","رجب","شعبان","رمضان","شوال","ذو القعدة","ذو الحجة"];
  return `${p.d} ${mNames[p.m-1]} ${p.y}هـ`;
}
function gregLabel(date){
  return new Intl.DateTimeFormat('ar', {weekday:'long', day:'2-digit', month:'long', year:'numeric'}).format(date);
}
function weekdayShort(date){
  return new Intl.DateTimeFormat('ar', {weekday:'short'}).format(date);
}

/* === القواعد: الأيام الصالحة/المكروهة ===
   عدّل هذا الكائن فقط بما يتوافق مع قائمتك المعتمدة.
   يدعم:
   1) daysByHijriNumber: أرقام الأيام القمرية (1..30) تُطبّق على كل الشهور.
   2) weekdays: بالأرقام: السبت=6, الأحد=0, الإثنين=1, ... الجمعة=5 وفق JS.
   3) perMonth: ضبط شهور هجريّة معيّنة لو احتجت تخصيصًا أدق.
*/
const marriageRules = {
  daysByHijriNumber: {
    // أمثلة افتراضية شائعة (رجاءً عدّلها بحسب مصادرك):
    13: 'bad', 15: 'bad', 25: 'bad',    // أمثلة لأيام مكروهة
    1: 'ok', 3: 'ok', 17: 'ok', 27: 'ok' // أمثلة لأيام صالحة
  },
  weekdays: {
    4: 'ok',  // الخميس (0=الأحد ... 6=السبت) → في JS: الجمعة=5، الخميس=4
    5: 'ok'   // الجمعة
  },
  perMonth: {
    // مثال: تخصيص لشهر معيّن (رمضان=9 مثلاً)
    // 9: { 14:'bad', 21:'ok' }
  }
};
// نصوص الحالة
const statusText = { ok: 'صالح للزواج', bad: 'مكروه', neutral:'عادي' };
const statusIcon = { ok: '💍', bad: '⚠️', neutral:'•' };

/* ترجيح القواعد إذا تعددت */
function resolveStatus(gDate){
  const h = toHijriParts(gDate);
  const weekday = gDate.getDay(); // 0=الأحد ... 6=السبت
  let status = 'neutral';

  // 1) حسب اليوم الهجري الخاص بالشهر
  if (marriageRules.perMonth[h.m] && marriageRules.perMonth[h.m][h.d]) {
    status = marriageRules.perMonth[h.m][h.d];
  }
  // 2) عام حسب رقم اليوم القمري
  if (marriageRules.daysByHijriNumber[h.d]) {
    status = marriageRules.daysByHijriNumber[h.d];
  }
  // 3) حسب يوم الأسبوع
  if (marriageRules.weekdays[weekday]) {
    // إن أردت أن تكون أيام الأسبوع "تقترح" فقط لا "تغلب"، غيّر السطر التالي:
    status = marriageRules.weekdays[weekday] || status;
  }
  return status;
}

/* === بناء الجدول للشهر الميلادي المحدد === */
const calEl = document.getElementById('calendar');
let current = new Date(); // اليوم

function monthRange(date){
  const y = date.getFullYear();
  const m = date.getMonth();
  const start = new Date(y, m, 1);
  const end = new Date(y, m+1, 0);
  return {start, end};
}
function renderCalendar(date){
  const {start, end} = monthRange(date);
  const monthTitle = new Intl.DateTimeFormat('ar', {month:'long', year:'numeric'}).format(start);
  // أجزاء أول يوم
  const firstDow = start.getDay(); // 0=الأحد
  const days = end.getDate();

  // رأس الجدول + شريط الشهر
  let html = `
    <div class="monthbar">
      <div>
        <h2>${monthTitle}</h2>
        <small>من ${gregLabel(start)} حتى ${gregLabel(end)}</small>
      </div>
      <div>
        <small> مطابق هجريًا لتقويم ${hasUmmAlQura ? 'أم القرى' : 'إسلامي تقريبي'}</small>
      </div>
    </div>
    <table>
      <thead>
        <tr>
          <th>اليوم</th>
          <th>الميلادي</th>
          <th>الهجري</th>
          <th>الحالة</th>
        </tr>
      </thead>
      <tbody>
  `;

  for (let d=1; d<=days; d++){
    const g = new Date(start.getFullYear(), start.getMonth(), d);
    const hijri = toHijriParts(g);
    const status = resolveStatus(g);
    const rowBadge = `<span class="badge ${status}">
        <span>${statusIcon[status]}</span><span>${statusText[status]}</span>
      </span>`;

    html += `
      <tr ${isSameDate(g,new Date()) ? 'style="outline:2px solid #3a3a45"' : ''}>
        <td>${weekdayShort(g)}</td>
        <td>${new Intl.DateTimeFormat('ar', {day:'2-digit', month:'2-digit', year:'numeric'}).format(g)}</td>
        <td>${hijri.d.toString().padStart(2,'0')}/${hijri.m.toString().padStart(2,'0')} – ${hijriLabel(g)}</td>
        <td>${rowBadge}</td>
      </tr>`;
  }
  html += `</tbody></table>`;
  calEl.innerHTML = html;

  // عيّن قيمة أدوات الاختيار
  document.getElementById('pickMonth').value = `${start.getFullYear()}-${String(start.getMonth()+1).padStart(2,'0')}`;
}

function isSameDate(a,b){
  return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate();
}

/* === التنقّل === */
document.getElementById('prevMonth').onclick = ()=>{
  current = new Date(current.getFullYear(), current.getMonth()-1, 1);
  renderCalendar(current);
};
document.getElementById('nextMonth').onclick = ()=>{
  current = new Date(current.getFullYear(), current.getMonth()+1, 1);
  renderCalendar(current);
};
document.getElementById('goToday').onclick = ()=>{
  current = new Date();
  renderCalendar(current);
  // تمرير الشاشة للجدول:
  calEl.scrollIntoView({behavior:'smooth', block:'start'});
};
document.getElementById('pickMonth').onchange = (e)=>{
  const [y,m] = e.target.value.split('-').map(Number);
  current = new Date(y, m-1, 1);
  renderCalendar(current);
};
document.getElementById('pickDate').onchange = (e)=>{
  const d = new Date(e.target.value);
  if(!isNaN(+d)){
    current = new Date(d.getFullYear(), d.getMonth(), 1);
    renderCalendar(current);
    // إبراز اليوم المختار بالتمرير:
    setTimeout(()=>{
      const rows = calEl.querySelectorAll('tbody tr');
      rows[d.getDate()-1]?.scrollIntoView({behavior:'smooth', block:'center'});
    }, 50);
  }
};

/* بداية التشغيل */
renderCalendar(current);

/* ====== تذكير مهم ======
   القيم الافتراضية أعلاه (خميس/جمعة صالح – 13/15/25 مكروه – 1/3/17/27 صالح)
   هي أمثلة فقط. رجاءً عدّل كائن marriageRules لتطابق قائمتك الموثّقة:
   - لإضافة يوم هجري مكروه دائمًا: marriageRules.daysByHijriNumber[27] = 'bad'
   - لتخصيص شهر هجري بعينه: (رمضان=9) marriageRules.perMonth[9] = { 14:'bad', 21:'ok' }
   - لإزالة قاعدة: احذف المفتاح أو اجعله 'neutral'.
*/
</script>
</body>
</html>
