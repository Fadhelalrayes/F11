<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>الليالي المباركة للعقد والزواج 1447 هـ</title>
<meta name="description" content="مربع واحد بسيط لفحص ثلاث ليالٍ (الليلة السابقة، المختارة، التالية) ومعرفة هل هي مباركة أو صالحة أو مكروهة للعقد والزواج لعام 1447 هـ.">
<style>
  :root{
    --bg:#0e1327; --card:#141b34; --txt:#f7f9fc; --muted:#9aa6c1;
    --ok:#22c55e; --good:#60a5fa; --bad:#ef4444; --accent:#06b6d4;
    --line:rgba(255,255,255,.08); --radius:18px; --shadow:0 10px 24px rgba(0,0,0,.28);
  }
  *{box-sizing:border-box} body{margin:0;background:linear-gradient(180deg,var(--bg),#0a0f22);color:var(--txt);font-family:system-ui,"Noto Kufi Arabic","Noto Sans Arabic","Segoe UI",Tahoma,Arial}
  .wrap{max-width:860px;margin:auto;padding:18px}
  header{display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,var(--card),#0e1630);border:1px solid var(--line);border-radius:var(--radius);padding:14px 16px;box-shadow:var(--shadow)}
  h1{margin:0;font-size:clamp(18px,3.5vw,28px)}
  .badge{font-size:12px;color:var(--muted);border:1px solid var(--line);padding:.2rem .6rem;border-radius:999px;margin-inline-start:8px}
  .card{background:linear-gradient(180deg,var(--card),#0c132a);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;margin-top:14px}
  .controls{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px}
  label{font-size:13px;color:var(--muted)}
  input[type="date"],select,button{background:#0b1430;border:1px solid var(--line);color:var(--txt);padding:10px 12px;border-radius:12px;font-size:14px}
  input[type="date"]{direction:ltr}
  button{cursor:pointer;background:linear-gradient(135deg,var(--accent),#0a97b5);border:none;transition:.2s}
  button:hover{transform:translateY(-1px)}
  .three{display:grid;grid-template-columns:1fr;gap:12px;margin-top:14px}
  @media(min-width:680px){.three{grid-template-columns:repeat(3,1fr)}}
  .tile{border:1px solid var(--line);border-radius:16px;padding:14px;background:#0b1227}
  .tile h3{margin:0 0 6px 0;font-size:15px;color:#dbeafe}
  .row{display:flex;align-items:center;gap:10px}
  .icon{font-size:26px;line-height:1}
  .status{font-weight:700;padding:.25rem .6rem;border-radius:999px;border:1px solid var(--line);font-size:13px}
  .ok{background:rgba(34,197,94,.15);color:#bbf7d0;border-color:rgba(34,197,94,.35)}
  .good{background:rgba(96,165,250,.15);color:#dbeafe;border-color:rgba(96,165,250,.35)}
  .bad{background:rgba(239,68,68,.15);color:#fecaca;border-color:rgba(239,68,68,.35)}
  .muted{color:var(--muted);font-size:12px;margin-top:6px}
  .hr{height:1px;background:var(--line);margin:12px 0}
  footer{margin-top:18px;text-align:center;color:#e5e7eb;background:linear-gradient(90deg,#0c1025,#10173a);border-radius:var(--radius);padding:14px;border:1px solid var(--line)}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>الليالي الصالحة للعقد والزواج<span class="badge">1447 هـ (2025/2026 م)</span></h1>
    </header>

    <!-- بطاقة واحدة فقط -->
    <section class="card" aria-label="مربع فحص ثلاث ليالٍ">
      <div class="controls">
        <div>
          <label for="date">التاريخ الميلادي</label><br>
          <input type="date" id="date">
        </div>
        <div>
          <label for="madhhab">طريقة التقويم / المذهب</label><br>
          <select id="madhhab">
            <option value="table1447" selected>افتراضي (حسب جدول 1447 هـ المزوّد)</option>
          </select>
        </div>
        <div style="align-self:end">
          <button id="check">افحص الليلة</button>
        </div>
      </div>

      <div class="hr"></div>

      <div class="three" id="tiles">
        <!-- الليلة السابقة -->
        <div class="tile">
          <h3>الليلة السابقة</h3>
          <div class="row">
            <div class="icon" id="iconPrev">🕯️</div>
            <div>
              <div id="statusPrev" class="status">—</div>
              <div class="muted" id="hijriPrev">هجري: —</div>
              <div class="muted" id="gregPrev">ميلادي: —</div>
            </div>
          </div>
        </div>
        <!-- الليلة المختارة -->
        <div class="tile">
          <h3>الليلة المختارة</h3>
          <div class="row">
            <div class="icon" id="iconNow">🌙</div>
            <div>
              <div id="statusNow" class="status">—</div>
              <div class="muted" id="hijriNow">هجري: —</div>
              <div class="muted" id="gregNow">ميلادي: —</div>
            </div>
          </div>
        </div>
        <!-- الليلة التالية -->
        <div class="tile">
          <h3>الليلة التالية</h3>
          <div class="row">
            <div class="icon" id="iconNext">✨</div>
            <div>
              <div id="statusNext" class="status">—</div>
              <div class="muted" id="hijriNext">هجري: —</div>
              <div class="muted" id="gregNext">ميلادي: —</div>
            </div>
          </div>
        </div>
      </div>

      <p class="muted" style="margin-top:10px">
        ملاحظة: الليلة تُحسب من الغروب إلى الغروب. نعتمد تقويم أم القرى عبر المتصفح لتحويل الهجري،
        ثم نقارن تاريخ <strong>1447 هـ</strong> مع الجدول المزوّد. ثبوت الهلال قد يغيّر النتيجة محليًا.
      </p>
    </section>

    <footer>برمجة وتطوير : <strong>فاضل الريس</strong></footer>
  </div>

<script>
/* ===== بيانات 1447 هـ (كما زوّدتني) ===== */
const months1447 = [
  {key:'ربيع الأول', blessed:[1,2,6,7,12,18,19,20,23,27,28,30], good:[9,11,14,15,22], disliked:[3,4,5,8,10,13,16,17,21,24,25,26,29]},
  {key:'ربيع الثاني', blessed:[2,4,6,7,12,17,19,20,23,27,28,30], good:[9,10,11,14], disliked:[1,3,5,8,13,15,16,18,21,22,24,25,26,29]},
  {key:'جمادى الأولى', blessed:[1,2,4,7,12,17,19,23,28], good:[8,9,10,11,14,15,22], disliked:[3,5,6,13,16,18,20,21,24,25,26,27,29]},
  {key:'جمادى الثانية', blessed:[1,2,4,6,7,17,18,20,23,27,28,30], good:[8,9,10,11,14,15,22], disliked:[3,5,12,13,16,19,21,24,25,26,29]},
  {key:'رجب', blessed:[1,2,4,6,7,18,19,20,23,27,28,30], good:[8,9,11,14,22], disliked:[3,5,10,12,13,15,16,17,21,24,25,26,29]},
  {key:'شعبان', blessed:[2,4,6,7,12,17,18,19,20,27,28], good:[9,10,11,14,23], disliked:[1,3,5,8,13,15,16,21,22,24,25,26,29]},
  {key:'رمضان', blessed:[1,2,4,6,17,18,27,30], good:[9,10,11,12,15,22,23], disliked:[3,5,7,8,13,14,16,19,20,21,24,25,26,28,29]},
  {key:'شوال', blessed:[1,4,6,7,17,18,20,23,27,28], good:[8,9,10,11,14,15,22], disliked:[2,3,5,12,13,16,19,21,24,25,26,29]},
  {key:'ذو القعدة', blessed:[1,2,6,7,12,17,19,20,23,27,28], good:[8,9,10,14,15], disliked:[3,4,5,11,13,16,18,21,22,24,25,26,29]},
  {key:'ذو الحجة', blessed:[1,2,4,6,12,18,19,20,23,27,28,30], good:[9,11,14,15,22], disliked:[3,5,7,8,10,13,16,17,21,24,25,26,29]}
];

const hijriMonthMap = {
  'ربيع الأول':'ربيع الأول','ربيع الاوّل':'ربيع الأول','ربيع الآخر':'ربيع الثاني','ربيع الثاني':'ربيع الثاني',
  'جمادى الأولى':'جمادى الأولى','جمادى الأولى':'جمادى الأولى','جمادى الآخرة':'جمادى الثانية','جمادى الثانية':'جمادى الثانية',
  'رجب':'رجب','شعبان':'شعبان','رمضان':'رمضان','شوّال':'شوال','شوال':'شوال','ذو القعدة':'ذو القعدة','ذو الحجّة':'ذو الحجة','ذو الحجة':'ذو الحجة'
};

function fmtGreg(d){ return new Intl.DateTimeFormat('ar-EG',{dateStyle:'full'}).format(d); }
function fmtHijri(d){
  try{
    const f = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura',{day:'numeric',month:'long',year:'numeric'});
    const parts=f.formatToParts(d);
    return {
      day:Number(parts.find(p=>p.type==='day').value),
      monthName:parts.find(p=>p.type==='month').value,
      year:Number(parts.find(p=>p.type==='year').value)
    };
  }catch(_){ return {day:NaN,monthName:'',year:NaN}; }
}

function classify(hYear,hMonthName,hDay){
  if(hYear!==1447) return {cls:'', label:'خارج 1447 هـ', icon:'🗓️'};
  const norm=hijriMonthMap[hMonthName]||hMonthName;
  const m=months1447.find(x=>x.key===norm);
  if(!m) return {cls:'', label:'شهر غير مسجّل', icon:'❔'};
  if(m.blessed.includes(hDay)) return {cls:'ok', label:'مباركة', icon:'✅'};
  if(m.good.includes(hDay))    return {cls:'good', label:'صالحة', icon:'🟦'};
  if(m.disliked.includes(hDay))return {cls:'bad', label:'مكروهة', icon:'⛔'};
  return {cls:'', label:'غير مُصنّفة', icon:'•'};
}

/* حساب “الليلة” ببساطة: من 18:00 إلى 18:00 */
function nightMoment(baseDate){ const d=new Date(baseDate); d.setHours(23,0,0,0); return d; }
function addDays(d, n){ const x=new Date(d); x.setDate(x.getDate()+n); return x; }

/* تحديث مربّع الثلاث ليال */
function renderTriple(anchorDate){
  // anchorDate هو تاريخ ميلادي يختاره المستخدم (في منتصف اليوم)
  const base = new Date(anchorDate+"T12:00:00");
  const prevNight = nightMoment(addDays(base,-1));
  const currNight = nightMoment(base);
  const nextNight = nightMoment(addDays(base,1));
  const slots = [
    {h:fmtHijri(prevNight), gText:fmtGreg(prevNight), id:'Prev'},
    {h:fmtHijri(currNight), gText:fmtGreg(currNight), id:'Now'},
    {h:fmtHijri(nextNight), gText:fmtGreg(nextNight), id:'Next'}
  ];
  slots.forEach(s=>{
    const c=classify(s.h.year,s.h.monthName,s.h.day);
    document.getElementById('status'+s.id).className = 'status ' + (c.cls||'');
    document.getElementById('status'+s.id).textContent = c.label;
    document.getElementById('icon'+s.id).textContent = c.icon;
    document.getElementById('hijri'+s.id).textContent = isNaN(s.h.year) ? 'هجري: غير مدعوم' : `هجري: ${s.h.day} ${s.h.monthName} ${s.h.year} هـ`;
    document.getElementById('greg'+s.id).textContent = `ميلادي: ${s.gText}`;
  });
}

document.getElementById('check').addEventListener('click', ()=>{
  const v = document.getElementById('date').value;
  if(!v){ alert('يرجى اختيار تاريخ ميلادي.'); return; }
  // حالياً خيار المذهب واحد (الجدول المزوّد)، أضفته لتوسعة لاحقة بدون تغيير التصميم
  renderTriple(v);
});

// تهيئة مبدئية على تاريخ اليوم
(function init(){
  const today = new Date(); const y=today.getFullYear(), m=String(today.getMonth()+1).padStart(2,'0'), d=String(today.getDate()).padStart(2,'0');
  document.getElementById('date').value = `${y}-${m}-${d}`;
  renderTriple(`${y}-${m}-${d}`);
})();
</script>
</body>
</html>
