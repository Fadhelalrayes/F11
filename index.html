<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ± â€” Ø´Ø¨ÙŠÙ‡ Ø§Ù„ÙˆÙˆØ±Ø¯</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: "Tajawal", sans-serif; background:#fafafa; color:#333; }
    header { background:#fff; border-bottom:1px solid #eee; }
    canvas { background:#fff; border:1px solid #ddd; border-radius:10px; }
    .btn { padding:0.4rem 0.6rem; border-radius:6px; border:1px solid #ccc; background:#fff; cursor:pointer; }
    .btn:hover { background:#f3f4f6; }
    .toolbar { display:flex; gap:0.5rem; flex-wrap:wrap; align-items:center; background:#fff; border:1px solid #ddd; border-radius:8px; padding:0.5rem; }
    .tool-input { border:1px solid #ddd; border-radius:6px; padding:0.3rem 0.5rem; }
    .icon { width:20px; height:20px; display:inline-block; text-align:center; }
  </style>
</head>
<body>
  <header class="p-3 text-center">
    <h1 class="text-lg font-bold">Ø£Ø¯Ø§Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±</h1>
    <p class="text-sm text-gray-500">Ø¨Ø£Ø¯ÙˆØ§Øª Ø´Ø¨ÙŠÙ‡Ø© Ø¨Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ÙˆÙˆØ±Ø¯</p>
  </header>  <main class="max-w-5xl mx-auto p-4 grid gap-4 md:grid-cols-2">
    <!-- Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© -->
    <section class="bg-white p-3 rounded-2xl border border-gray-200">
      <canvas id="stage" width="640" height="400" class="w-full"></canvas>
      <p class="text-xs text-gray-500 mt-2">Ø§Ø³Ø­Ø¨ Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù†ØµØŒ ÙƒØ¨Ù‘Ø± Ø¨Ø§Ù„Ù„Ù…Ø³/Ø§Ù„Ø¹Ø¬Ù„Ø©</p>
    </section><!-- Ø§Ù„Ø£Ø¯ÙˆØ§Øª -->
<section class="space-y-3">
  <div class="bg-white p-3 rounded-2xl border border-gray-200 space-y-2">
    <label class="text-sm">ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø©</label>
    <input id="imageInput" type="file" accept="image/*" class="tool-input w-full" />
  </div>

  <div class="bg-white p-3 rounded-2xl border border-gray-200 space-y-2">
    <label class="text-sm">Ø§Ù„Ù†Øµ</label>
    <input id="textInput" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ù‡Ù†Ø§" class="tool-input w-full" />

    <!-- Ø´Ø±ÙŠØ· Ø£Ø¯ÙˆØ§Øª Ø´Ø¨ÙŠÙ‡ Ø¨Ø§Ù„ÙˆÙˆØ±Ø¯ -->
    <div class="toolbar">
      <select id="fontFamily" class="tool-input">
        <option value="Tajawal">Tajawal</option>
        <option value="Arial">Arial</option>
        <option value="Georgia">Georgia</option>
      </select>

      <input id="fontSize" type="number" value="32" min="10" max="120" class="tool-input w-20" />

      <input id="fontColor" type="color" value="#000000" class="w-8 h-8 border rounded" />

      <button id="bold" class="btn"><b>B</b></button>
      <button id="italic" class="btn"><i>I</i></button>
      <button id="shadow" class="btn">Ø¸Ù„</button>

      <button data-align="left" class="btn">ğŸ¡¸</button>
      <button data-align="center" class="btn">â˜°</button>
      <button data-align="right" class="btn">ğŸ¡º</button>
    </div>

    <button id="addText" class="btn bg-indigo-600 text-white w-full">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Øµ</button>
  </div>

  <div class="flex gap-2">
    <button id="downloadPNG" class="btn bg-indigo-600 text-white flex-1">ØªÙ†Ø²ÙŠÙ„ PNG</button>
    <button id="downloadJPG" class="btn flex-1">ØªÙ†Ø²ÙŠÙ„ JPG</button>
  </div>
</section>

  </main>  <script>
    const $ = (s)=>document.querySelector(s);
    const canvas=$('#stage'), ctx=canvas.getContext('2d');
    let image=null, texts=[];

    const ui={ imageInput:$('#imageInput'), textInput:$('#textInput'), addText:$('#addText'), fontFamily:$('#fontFamily'), fontSize:$('#fontSize'), fontColor:$('#fontColor'), bold:$('#bold'), italic:$('#italic'), shadow:$('#shadow'), alignBtns:document.querySelectorAll('[data-align]'), downloadPNG:$('#downloadPNG'), downloadJPG:$('#downloadJPG') };

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      if(image){ ctx.drawImage(image,0,0,canvas.width,canvas.height); }
      texts.forEach(t=>{
        ctx.font=`${t.italic?'italic':''} ${t.bold?'700':'400'} ${t.size}px ${t.family}`;
        ctx.fillStyle=t.color; ctx.textAlign=t.align; ctx.textBaseline='middle';
        if(t.shadow){ ctx.shadowColor='rgba(0,0,0,.3)'; ctx.shadowBlur=4; } else { ctx.shadowColor='transparent'; }
        ctx.fillText(t.text,t.x,t.y);
      });
    }

    ui.imageInput.addEventListener('change',e=>{const f=e.target.files[0];if(!f)return;const img=new Image();img.onload=()=>{image=img;draw();};img.src=URL.createObjectURL(f);});

    ui.addText.addEventListener('click',()=>{if(!ui.textInput.value.trim())return; texts.push({ text:ui.textInput.value, x:canvas.width/2, y:canvas.height/2, family:ui.fontFamily.value, size:+ui.fontSize.value, color:ui.fontColor.value, bold:ui.bold.classList.contains('active'), italic:ui.italic.classList.contains('active'), shadow:ui.shadow.classList.contains('active'), align:'center' }); draw();});

    ui.fontFamily.addEventListener('input',()=>{updateSel({family:ui.fontFamily.value});});
    ui.fontSize.addEventListener('input',()=>{updateSel({size:+ui.fontSize.value});});
    ui.fontColor.addEventListener('input',()=>{updateSel({color:ui.fontColor.value});});

    ;['bold','italic','shadow'].forEach(id=>{ui[id].addEventListener('click',()=>{ui[id].classList.toggle('active'); updateSel({[id]:ui[id].classList.contains('active')});});});

    ui.alignBtns.forEach(btn=> btn.addEventListener('click',()=> updateSel({align:btn.dataset.align})));

    function updateSel(props){ if(texts.length===0) return; Object.assign(texts[texts.length-1],props); draw(); }

    function download(type){ if(!image){alert('Ø­Ù…Ù‘Ù„ ØµÙˆØ±Ø© Ø£ÙˆÙ„Ø§Ù‹');return;} const out=document.createElement('canvas'); const octx=out.getContext('2d'); out.width=image.naturalWidth; out.height=image.naturalHeight; octx.drawImage(image,0,0,out.width,out.height); texts.forEach(t=>{const ratio=image.naturalWidth/canvas.width; octx.font=`${t.italic?'italic':''} ${t.bold?'700':'400'} ${t.size*ratio}px ${t.family}`; octx.fillStyle=t.color; octx.textAlign=t.align; octx.textBaseline='middle'; if(t.shadow){octx.shadowColor='rgba(0,0,0,.3)';octx.shadowBlur=4*ratio;} else {octx.shadowColor='transparent';} octx.fillText(t.text,t.x*ratio,t.y*ratio);}); const mime=type==='png'?'image/png':'image/jpeg'; const a=document.createElement('a'); a.download=`output.${type}`; a.href=out.toDataURL(mime); a.click(); }
    ui.downloadPNG.addEventListener('click',()=>download('png'));
    ui.downloadJPG.addEventListener('click',()=>download('jpg'));

    // Ø³Ø­Ø¨ Ø§Ù„Ù†Øµ Ø§Ù„Ø£Ø®ÙŠØ±
    let dragging=false; canvas.addEventListener('mousedown',e=>{if(texts.length===0)return; dragging=true;}); canvas.addEventListener('mousemove',e=>{if(!dragging||texts.length===0)return;const r=canvas.getBoundingClientRect(); const t=texts[texts.length-1]; t.x=(e.clientX-r.left)*(canvas.width/r.width); t.y=(e.clientY-r.top)*(canvas.height/r.height); draw();}); window.addEventListener('mouseup',()=>dragging=false);
  </script></body>
</html>
