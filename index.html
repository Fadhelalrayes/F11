<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>الأيام الصالحة – 1447هـ</title>
<style>
  :root{
    --bg:#fffdf8; --ink:#191714; --muted:#7b746c; --line:#ece2cf;
    --gold:#caa74c; --gold-ink:#5a4916; --good:#0a8a61; --bad:#c33b3b;
    --radius:14px; --h:42px;
  }
  *,*::before,*::after{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);
       font-family:"Noto Naskh Arabic","Amiri","Scheherazade New",system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
  .wrap{max-width:760px;margin-inline:auto;padding:14px}

  /* رأس بسيط وخفيف */
  header{display:flex;justify-content:center;margin-bottom:10px}
  .title{padding:10px 16px;border:1px solid var(--line);border-radius:16px}
  .title h1{margin:0;font-size:1.08rem;letter-spacing:.2px}

  /* بطاقة اليوم – بلا ظلال */
  .card{border:1px solid var(--line);border-radius:var(--radius);background:#fff}
  .pad{padding:12px}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .tile{border:1px solid var(--line);border-radius:10px;padding:10px}
  .tile h3{margin:0 0 6px;color:var(--muted);font-size:.88rem}
  .tile p{margin:0;font-weight:800}

  /* أزرار احترافية خفيفة */
  .controls{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;align-items:center;margin-top:8px}
  .btn{height:var(--h);border-radius:12px;border:1px solid var(--gold);background:#fff;color:var(--gold-ink);cursor:pointer}
  .btn:focus-visible{outline:2px solid var(--gold);outline-offset:2px}
  .btn:active{transform:translateY(1px)}
  .btn-solid{background:var(--gold);color:#fff;border-color:var(--gold)}
  .datebox{height:var(--h);border:1px solid var(--line);border-radius:12px;background:#fff;padding-inline:8px;display:flex;align-items:center}
  .datebox input{appearance:none;-webkit-appearance:none;border:0;background:transparent;outline:0;width:100%;height:calc(var(--h) - 10px)}

  /* شارة حالة اليوم */
  .badges{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
  .badge{border:1px solid var(--line);border-radius:999px;padding:4px 10px;font-weight:800;background:#fff}
  .b{color:#5a4916;border-color:#e9dcae;background:#fff8dc}
  .g{color:#07563e;border-color:#cce8dd;background:#eef9f4}
  .d{color:#7a1a1a;border-color:#ffd5d5;background:#ffeeee}

  .note{margin-top:6px;color:#3c3833}

  /* تخطيط الجدول العمودي الخفيف */
  .section{display:grid;grid-template-columns:1fr auto;gap:10px;margin-top:10px}
  .vnav{display:flex;flex-direction:column;gap:8px}
  .vnav .btn{width:128px}

  .tbl{border:1px solid var(--line);border-radius:12px;background:#fff;overflow:auto}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid var(--line);text-align:center}
  thead th{color:#5b544c;font-weight:800;background:#fff}
  tbody tr{cursor:pointer}
  tbody tr:hover{background:#fffaf0}
  tbody tr.sel{outline:2px solid #e7d8ae}
  .tag{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:3px 10px;font-weight:800}
  .tag.b{background:#fff8dc;border-color:#ecdca6;color:#5a4916}
  .tag.g{background:#eef9f4;border-color:#cce8dd;color:#07563e}
  .tag.d{background:#ffeeee;border-color:#ffd5d5;color:#7a1a1a}

  footer{margin:14px 0 6px;text-align:center;color:#7a746c}
  .sig{display:inline-flex;gap:6px;border:1px solid var(--line);border-radius:999px;padding:6px 12px;background:#fff}
  @media (max-width:640px){
    .grid2{grid-template-columns:1fr}
    .controls{grid-template-columns:1fr 1fr}
    .section{grid-template-columns:1fr}
    .vnav{flex-direction:row}
  }
</style>
</head>
<body>
<div class="wrap">
  <header><div class="title"><h1>الأيام الصالحة للعقد والزواج – 1447هـ</h1></div></header>

  <!-- بطاقة اليوم -->
  <section class="card pad">
    <div class="grid2">
      <div class="tile"><h3>التاريخ الهجري</h3><p id="hijriStr">-</p></div>
      <div class="tile"><h3>التاريخ الميلادي</h3><p id="gregStr">-</p></div>
      <div class="tile"><h3>اليوم</h3><p id="weekday">-</p></div>
      <div class="tile"><h3>الساعة الآن</h3><p id="clock">--:--:--</p></div>
    </div>

    <!-- 4 عناصر بالعرض -->
    <div class="controls">
      <button class="btn btn-solid" id="goToday" type="button">اليوم</button>
      <button class="btn" id="prevDay" type="button">السابق</button>
      <button class="btn" id="nextDay" type="button">التالي</button>
      <label class="datebox"><input id="datePicker" type="date"></label>
    </div>

    <div class="badges">
      <span class="badge b">مباركة</span>
      <span class="badge g">صالحة</span>
      <span class="badge d">مكروهة</span>
    </div>

    <div class="note" id="rulingText">اختر تاريخًا لعرض الحكم.</div>
    <div class="note" id="notesText"></div>
  </section>

  <!-- جدول عمودي خفيف -->
  <section class="section">
    <div>
      <div style="font-weight:900;margin:8px 0" id="monthTitle">الشهر 1447هـ</div>
      <div class="tbl">
        <table>
          <thead>
            <tr><th>هـ</th><th>الحكم</th><th>ملاحظات</th></tr>
          </thead>
          <tbody id="monthRows"></tbody>
        </table>
      </div>
    </div>
    <div class="vnav">
      <button class="btn" id="prevMonth" type="button">الشهر السابق</button>
      <button class="btn" id="nextMonth" type="button">الشهر التالي</button>
    </div>
  </section>

  <footer><div class="sig">إعداد وبرمجة: <strong>فاضل الريس</strong></div></footer>
</div>

<script>
  /* ========== تهيئة خفيفة جدًا ========== */
  const TZ='Asia/Bahrain';

  // مُهيئات Intl مُخزّنة (لا تُنشأ في كل مرة)
  const fmtClock   = new Intl.DateTimeFormat('ar',{timeZone:TZ,hour:'2-digit',minute:'2-digit',second:'2-digit'});
  const fmtWk      = new Intl.DateTimeFormat('ar',{timeZone:TZ,weekday:'long'});
  const fmtGreg    = new Intl.DateTimeFormat('ar',{timeZone:TZ,day:'numeric',month:'long',year:'numeric'});
  const fmtH_y     = new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{timeZone:TZ,year:'numeric'});
  const fmtH_m     = new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{timeZone:TZ,month:'numeric'});
  const fmtH_d     = new Intl.DateTimeFormat('en-u-ca-islamic-umalqura',{timeZone:TZ,day:'numeric'});
  const fmtH_mName = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-umalqura',{timeZone:TZ,month:'long'});

  function nowBH(){
    const f=new Intl.DateTimeFormat('en-CA',{timeZone:TZ,year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false});
    const p=Object.fromEntries(f.formatToParts(new Date()).map(x=>[x.type,x.value]));
    return new Date(`${p.year}-${p.month}-${p.day}T${p.hour}:${p.minute}:${p.second}`);
  }
  function H(d){
    const y=+fmtH_y.format(d), m=+fmtH_m.format(d), day=+fmtH_d.format(d);
    const mn=fmtH_mName.format(d), wk=fmtWk.format(d);
    return {y,m,d:day,monthName:mn,weekday:wk,str:`${day} ${mn} ${y}هـ`};
  }
  function G(d){ return {str:fmtGreg.format(d),weekday:fmtWk.format(d)}; }

  // بيانات 1447هـ (مختصرة)
  const months={3:{name:'ربيع الأول',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مكروهة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'مكروهة',9:'صالحة',10:'مكروهة',11:'صالحة',12:'مباركة',13:'مكروهة',14:'صالحة',15:'صالحة',16:'مكروهة',17:'مكروهة',18:'مباركة',19:'مباركة',20:'مباركة',21:'مكروهة',22:'صالحة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة',30:'مباركة'},notes:{8:'استشهاد الإمام العسكري (ع)'}},
  4:{name:'ربيع الثاني',days:{1:'مكروهة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'مكروهة',9:'صالحة',10:'صالحة',11:'صالحة',12:'مباركة',13:'مكروهة',14:'صالحة',15:'مكروهة',16:'مكروهة',17:'مباركة',18:'مكروهة',19:'مباركة',20:'مباركة',21:'مكروهة',22:'مكروهة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة',30:'مباركة'},notes:{13:'استشهاد السيدة فاطمة الزهراء (ع)'}},
  5:{name:'جمادى الأولى',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مكروهة',7:'مباركة',8:'صالحة',9:'صالحة',10:'صالحة',11:'صالحة',12:'مباركة',13:'مكروهة',14:'صالحة',15:'صالحة',16:'مكروهة',17:'مباركة',18:'مكروهة',19:'مباركة',20:'مكروهة',21:'مكروهة',22:'صالحة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مكروهة',28:'مباركة',29:'مكروهة'},notes:{13:'استشهاد السيدة فاطمة الزهراء (ع)'}},
  6:{name:'جمادى الثاني',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'صالحة',9:'صالحة',10:'صالحة',11:'صالحة',12:'مكروهة',13:'مكروهة',14:'صالحة',15:'صالحة',16:'مكروهة',17:'مباركة',18:'مكروهة',19:'مباركة',20:'مكروهة',21:'مكروهة',22:'صالحة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة',30:'مباركة'},notes:{3:'استشهاد السيدة فاطمة الزهراء (ع) – الرواية الثانية',13:'وفاة السيدة أم البنين (ع)'}},
  7:{name:'رجب',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'صالحة',9:'صالحة',10:'مكروهة',11:'صالحة',12:'مكروهة',13:'مكروهة',14:'صالحة',15:'مكروهة',16:'مكروهة',17:'مكروهة',18:'مباركة',19:'مباركة',20:'مباركة',21:'مكروهة',22:'صالحة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة',30:'مباركة'},notes:{3:'استشهاد الإمام علي الهادي (ع)',12:'بداية 2026م',15:'وفاة السيدة زينب (ع)',25:'استشهاد الإمام موسى الكاظم (ع)'}},
  8:{name:'شعبان',days:{1:'مكروهة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'مكروهة',9:'صالحة',10:'صالحة',11:'صالحة',12:'مباركة',13:'مكروهة',14:'صالحة',15:'مكروهة',16:'مكروهة',17:'مباركة',18:'مباركة',19:'مباركة',20:'مباركة',21:'مكروهة',22:'مكروهة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة'}},
  9:{name:'رمضان',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مكروهة',8:'مكروهة',9:'صالحة',10:'صالحة',11:'صالحة',12:'صالحة',13:'مكروهة',14:'مكروهة',15:'صالحة',16:'مكروهة',17:'مباركة',18:'مباركة',19:'مكروهة',20:'مكروهة',21:'مكروهة',22:'صالحة',23:'صالحة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مكروهة',29:'مكروهة',30:'مباركة'},notes:{8:'وفاة السيدة خديجة (ع)',19:'ضربة الإمام علي (ع)',20:'مرض الإمام علي (ع)',21:'استشهاد الإمام علي (ع)'}},
  10:{name:'شوال',days:{1:'مباركة',2:'مكروهة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'صالحة',9:'صالحة',10:'صالحة',11:'صالحة',12:'مكروهة',13:'مكروهة',14:'صالحة',15:'صالحة',16:'مكروهة',17:'مباركة',18:'مباركة',19:'مكروهة',20:'مباركة',21:'مكروهة',22:'مكروهة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة'},notes:{25:'استشهاد الإمام جعفر الصادق (ع)'}},
  11:{name:'ذو القعدة',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مكروهة',5:'مكروهة',6:'مباركة',7:'مباركة',8:'صالحة',9:'صالحة',10:'صالحة',11:'مكروهة',12:'مباركة',13:'مكروهة',14:'صالحة',15:'صالحة',16:'مكروهة',17:'مباركة',18:'مكروهة',19:'مباركة',20:'مباركة',21:'مكروهة',22:'مكروهة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة'},notes:{29:'استشهاد الإمام محمد الجواد (ع)'}},
  12:{name:'ذو الحجة',days:{1:'مباركة',2:'مباركة',3:'مكروهة',4:'مباركة',5:'مكروهة',6:'مباركة',7:'مكروهة',8:'مكروهة',9:'صالحة',10:'مكروهة',11:'صالحة',12:'مباركة',13:'مكروهة',14:'صالحة',15:'صالحة',16:'مكروهة',17:'مكروهة',18:'مباركة',19:'مباركة',20:'مباركة',21:'مكروهة',22:'صالحة',23:'مباركة',24:'مكروهة',25:'مكروهة',26:'مكروهة',27:'مباركة',28:'مباركة',29:'مكروهة',30:'مباركة'},notes:{7:'استشهاد الإمام محمد الباقر (ع)',8:'استشهاد مسلم بن عقيل (ع)'}}
  };

  const $=id=>document.getElementById(id);
  const S={date:nowBH(),hijri:null,view:null};

  function tick(){ $('clock').textContent = fmtClock.format(nowBH()); }

  function updateHero(){
    const d=S.date, h=H(d), g=G(d);
    S.hijri=h;
    $('hijriStr').textContent=h.str;
    $('gregStr').textContent=g.str;
    $('weekday').textContent=h.weekday;

    const mData=months[h.m], rule=mData?.days?.[h.d];
    $('rulingText').textContent=`حكم اليوم: ${rule||'غير محدد'}`;
    $('notesText').textContent=mData?.notes?.[h.d] ? `ملاحظة: ${mData.notes[h.d]}` : '';

    // اضبط المنظور الشهري وحقول التاريخ
    const gd=new Date(S.date); $('datePicker').valueAsDate=new Date(gd.getFullYear(),gd.getMonth(),gd.getDate());
    S.view={y:h.y,m:h.m};
    renderMonthTable();
  }

  // يبني جدول الشهر (هـ/الحكم/ملاحظات فقط) – بلا حسابات إضافية
  function renderMonthTable(){
    const y=S.view.y, m=S.view.m, mData=months[m];
    $('monthTitle').textContent = `${mData?.name||'الشهر'} ${y}هـ`;
    const body=$('monthRows'); body.innerHTML='';
    for(let d=1; d<=30; d++){
      const r=mData?.days?.[d]; if(!r) continue;
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${d}</td><td>${tag(r)}</td><td>${mData?.notes?.[d]||''}</td>`;
      tr.addEventListener('click',()=>jumpTo(y,m,d,tr));
      body.appendChild(tr);
    }
  }
  const tag = r => `<span class="tag ${r==='مباركة'?'b':r==='صالحة'?'g':'d'}">${r}</span>`;

  // بحث سريع عن التاريخ الميلادي الموافق (يُستخدم فقط عند الضغط أو التنقل)
  function approxGregForHijri(y,m,d){
    const base=nowBH();
    for(let k=-210;k<=210;k++){
      const t=new Date(base); t.setDate(t.getDate()+k);
      const h=H(t); if(h.y===y && h.m===m && h.d===d) return t;
    }
    return base;
  }
  function jumpTo(y,m,d,tr){
    S.date = approxGregForHijri(y,m,d);
    updateHero();
    document.querySelectorAll('#monthRows tr').forEach(x=>x.classList.remove('sel'));
    tr?.classList.add('sel');
    window.scrollTo({top:0,behavior:'smooth'});
  }

  function init(){
    tick(); setInterval(tick,1000);
    updateHero();

    $('goToday').addEventListener('click',()=>{S.date=nowBH(); updateHero();});
    $('prevDay').addEventListener('click',()=>{S.date.setDate(S.date.getDate()-1); updateHero();});
    $('nextDay').addEventListener('click',()=>{S.date.setDate(S.date.getDate()+1); updateHero();});
    $('datePicker').addEventListener('change',e=>{
      if(!e.target.value) return;
      const [yy,mm,dd]=e.target.value.split('-').map(Number);
      S.date=new Date(yy,mm-1,dd,12,0,0);
      updateHero();
    });
    $('prevMonth').addEventListener('click',()=>{
      const h=S.hijri; let mm=h.m-1, yy=h.y; if(mm<1){mm=12;yy--;}
      S.view={y:yy,m:mm}; jumpTo(yy,mm,1);
    });
    $('nextMonth').addEventListener('click',()=>{
      const h=S.hijri; let mm=h.m+1, yy=h.y; if(mm>12){mm=1;yy++;}
      S.view={y:yy,m:mm}; jumpTo(yy,mm(=1)); /* سيقفز لأوّل يوم */
    });
  }
  document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>
