<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حِكمة في طلب العلم - الإصدار النهائي</title>
    <meta name="description" content="مقال بتصميم صفحة كتاب احترافية، مع دعم كامل للغة العربية في ملف PDF لضمان نص واضح وسليم.">

    <!-- Google Fonts for screen display -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Noto+Kufi+Arabic:wght@600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <!-- ** THE DEFINITIVE SOLUTION LIBRARIES ** -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- The key library for fixing Arabic text rendering -->
    <script src="https://unpkg.com/arabic-persian-reshaper@0.0.2/arabic-persian-reshaper.js"></script>


    <style>
        :root {
            --page-bg: #ffffff;
            --text-color: #212529;
            --header-color: #8c1515;
            --border-color: #dee2e6;
            --body-bg: #e9ecef;
            --font-body: 'Amiri', serif;
            --font-heading: 'Noto Kufi Arabic', sans-serif;
        }

        body {
            font-family: var(--font-body);
            color: var(--text-color);
            background-color: var(--body-bg);
            margin: 0;
            padding: 3rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .page-container {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm 25mm;
            background-color: var(--page-bg);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border: 1px solid #ccc;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        
        .page-content { flex-grow: 1; }

        .page-header, .page-footer {
            width: 100%; text-align: center; font-size: 14px; color: #888; font-family: sans-serif;
        }
        .page-header { border-bottom: 1px solid var(--border-color); padding-bottom: 10px; margin-bottom: 20mm; }
        .page-footer { border-top: 1px solid var(--border-color); padding-top: 10px; margin-top: auto; }

        h1 {
            font-family: var(--font-heading); font-size: 2.6rem; font-weight: 700; color: var(--header-color);
            text-align: center; margin: 0 0 1.5rem 0;
        }

        p { font-size: 1.2rem; line-height: 2.4; text-align: justify; margin: 0 0 1.5rem 0; }
        p.first-paragraph { text-indent: 3rem; }
        strong { font-weight: 700; }

        .quote {
            font-style: italic; font-size: 1.25rem; color: #495057; margin: 2rem 3rem;
            padding-right: 1.5rem; border-right: 4px solid #c9b79c;
        }
        
        .ornament { text-align: center; font-size: 1.5rem; color: #c9b79c; margin: 2rem 0; }

        .download-button-wrapper { text-align: center; margin-top: 2.5rem; }
        .download-button {
            font-family: var(--font-heading); background-color: var(--header-color); color: white;
            border: none; padding: 15px 35px; font-size: 1.1rem; font-weight: 600;
            border-radius: 5px; cursor: pointer; transition: all 0.3s ease;
        }
        .download-button:hover:not(:disabled) { background-color: #a93226; transform: translateY(-2px); }
        .download-button:disabled { background-color: #aaa; cursor: not-allowed; }
        .download-button i { margin-left: 10px; }

        @media (max-width: 820px) {
            body { padding: 1rem; }
            .page-container { width: 100%; min-height: 0; height: auto; padding: 2rem; }
            h1 { font-size: 2.2rem; }
            p { font-size: 1.1rem; line-height: 2.2; }
            .quote { margin: 1.5rem 1rem; }
        }
    </style>
</head>
<body>

    <div class="page-container" id="content-to-print">
        <header class="page-header">
            مقال في آداب طلب العلم
        </header>
        <main class="page-content">
            <h1>حِكمةٌ في طَلبِ العِلم</h1>
            <p class="first-paragraph">
                يُحكى أنّ الشيخ مرتضى الأنصاري (1281هـ)، الذي تُعتبر مدرسته الأصوليّة هي المهيمنة إلى اليوم على آليّات الاجتهاد الشرعي عند الإماميّة، حضر في درس الفقه عند الشيخ محمد حسن النجفي (1266هـ)، صاحب الموسوعة الفقهيّة الشهيرة "جواهر الكلام"، ويبدو أنّ حضوره هذا كان لأوّل مرّة أو ربما رآه بعض الطلاب لأوّل مرّة حاضراً مجلس درس المحقّق النجفي، فجاء إليه بعضهم وسأله عن درسه وتحصيله العلمي، فأجابهم.
            </p>
            <p>
                ومن ضمن الكلام والحوار العلمي الذي جرى بينهم أنّه قال لهم: هذه المسألة مبنيّة على <strong>نظريّة الحكومة</strong> في أصول الفقه. وهي نظريّة تعنى بتنظيم بعض العلاقات بين النصوص والأدلّة، وتشتهر نسبتها إلى الشيخ الأنصاريّ، وإن كان هناك من يرى أنّ لها حضوراً في الدراسات القانونية المعاصرة.
            </p>
            <div class="quote">
                على أيّة حال، لم يفهم أولئك الطلاب معنى كلمة الحكومة، إذ بدت جديدة بالنسبة إليهم، فسألوه بنوعٍ من الاستخفاف: وما هي الحكومة؟ فقال لهم: تحتاجون أن تحضروا عندي الدرس الأصولي لستّة أشهر، وبعدها تفهمون الأمر.
            </div>
            <div class="ornament">
                ***
            </div>
            <p>
                بصرف النظر عن مدى صحّة النقل، قد تحكي هذه القصّة عن حِكمة لو فسّرناها بطريقة معيّنة، وهي أنّه لا يمكنك فهم المدارس الجديدة، بل والقديمة، عبر المرور العجول عليها، ولا الحكم عليها بعيونك من خلال نظرة واحدة أو مقطع واحد أو فكرة هنا أو هنا.
            </p>
            <p>
                هذا يعني أنّه لكي نفهم الآخر وبخاصّة لو كان يقدّم مشروعاً مختلفاً عن المألوف، مثل مشروع الأنصاري والملا صدرا وكانط، أن نعيش معه لفترةٍ كافية، اعتبرَها الأنصاري ستة أشهر، فندخل داخل منظومته الفكريّة ونتعايش مع طريقة تفكيره، ثم بعد ذلك تبدأ رحلة النقاش والحوار. أمّا العجلة، وبخاصّة في عصر التسطيح الذي تُتحفنا به وسائل التواصل الاجتماعي، فإنّ تقدّماً علميّاً لن يكون مرجوّاً أبداً، والأملُ بالله لا ينقطع.
            </p>
        </main>
        <footer class="page-footer">
            1
        </footer>
    </div>
    
    <div class="download-button-wrapper">
        <button id="download-btn" class="download-button">
            تحميل كملف PDF <i class="fas fa-download"></i>
        </button>
    </div>

    <script>
        window.jsPDF = window.jspdf.jsPDF;

        document.getElementById('download-btn').addEventListener('click', function () {
            const downloadButton = this;
            downloadButton.disabled = true;
            downloadButton.innerHTML = 'جاري التحضير... <i class="fas fa-spinner fa-spin"></i>';

            try {
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                pdf.addFont("https://raw.githack.com/sphilee/jsPDF-CustomFonts-support/master/dist/Amiri-Regular.ttf", "Amiri", "normal");
                pdf.setFont("Amiri", "normal");

                const margin = 20;
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const usableWidth = pageWidth - (margin * 2);
                let y = margin;

                function processText(text) {
                    return arabicPersianReshaper.process(text).split('').reverse().join('');
                }

                // --- Header ---
                pdf.setFontSize(10);
                pdf.text(processText("مقال في آداب طلب العلم"), pageWidth / 2, y, { align: 'center' });
                y += 5;
                pdf.setLineWidth(0.2);
                pdf.line(margin, y, pageWidth - margin, y);
                y += 20;

                // --- Title ---
                pdf.setFontSize(24);
                const title = document.querySelector('h1').innerText;
                pdf.text(processText(title), pageWidth / 2, y, { align: 'center' });
                y += 20;

                // --- Body Paragraphs ---
                pdf.setFontSize(12);
                const paragraphs = document.querySelectorAll('.page-content p, .page-content .quote');
                
                paragraphs.forEach(p => {
                    let text = p.innerText;
                    let isQuote = p.classList.contains('quote');
                    
                    const lines = pdf.splitTextToSize(text, usableWidth - (isQuote ? 10 : 0));
                    
                    if (y + (lines.length * 7) > pageHeight - margin) {
                        pdf.addPage();
                        y = margin;
                    }

                    if (isQuote) {
                        pdf.setLineWidth(1);
                        pdf.setDrawColor('#c9b79c');
                        pdf.line(pageWidth - margin - 5, y, pageWidth - margin - 5, y + (lines.length * 7) - 5);
                    }

                    lines.forEach((line, index) => {
                        pdf.text(processText(line), pageWidth - margin - (isQuote ? 10 : 0), y, { align: 'right' });
                        y += 7;
                    });
                    y += 5;
                });

                // --- Footer ---
                pdf.setLineWidth(0.2);
                pdf.setDrawColor('#333333');
                pdf.line(margin, pageHeight - margin + 5, pageWidth - margin, pageHeight - margin + 5);
                pdf.text(processText("1"), pageWidth / 2, pageHeight - margin + 10, { align: 'center' });

                pdf.save('حكمة-في-طلب-العلم.pdf');

            } catch (error) {
                console.error("PDF Generation Failed:", error);
                alert("عذراً، حدث خطأ فادح أثناء إنشاء الملف. يرجى المحاولة مرة أخرى.");
            } finally {
                downloadButton.disabled = false;
                downloadButton.innerHTML = 'تحميل كملف PDF <i class="fas fa-download"></i>';
            }
        });
    </script>

</body>
</html>
